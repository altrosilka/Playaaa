function LastFM(t){var e=t.apiKey||"",n=t.apiSecret||"",o=t.apiUrl||"http://ws.audioscrobbler.com/2.0/",a=t.cache||void 0;this.setApiKey=function(t){e=t},this.setApiSecret=function(t){n=t},this.setApiUrl=function(t){o=t},this.setCache=function(t){a=t};var r=function(t,e,n){if("POST"==n){iframes=document.getElementsByClassName("ifr");var r=document.getElementsByTagName("html")[0];for(i=0;i<iframes.length;i++)r.removeChild(iframes[i]);var s,u=document.createElement("iframe");u.width=1,u.height=1,u.className="ifr",u.style.border="none",u.onload=function(){"undefined"!=typeof e.success&&e.success()},r.appendChild(u),s="undefined"!=typeof u.contentWindow?u.contentWindow.document:"undefined"!=typeof u.contentDocument.document?u.contentDocument.document.document:u.contentDocument.document,s.open(),s.clear(),s.write('<form method="post" action="'+o+'" id="form">');for(var c in t)s.write('<input type="text" name="'+c+'" value="'+t[c]+'">');s.write("</form>"),s.write('<script type="text/javascript">'),s.write('document.getElementById("form").submit();'),s.write("</script>"),s.close()}else{var d="jsonp"+(new Date).getTime(),f=l.getApiSignature(t);if("undefined"!=typeof a&&a.contains(f)&&!a.isExpired(f))return void("undefined"!=typeof e.success&&e.success(a.load(f)));t.callback=d,t.format="json",window[d]=function(n){if("undefined"!=typeof a){var o=a.getExpirationTime(t);o>0&&a.store(f,n,o)}"undefined"!=typeof n.error?"undefined"!=typeof e.error&&e.error(n.error,n.message):"undefined"!=typeof e.success&&e.success(n),window[d]=void 0;try{delete window[d]}catch(i){}p&&p.removeChild(h)};var p=document.getElementsByTagName("head")[0],h=document.createElement("script"),m=[];for(var c in t)m.push(encodeURIComponent(c)+"="+encodeURIComponent(t[c]));h.src=o+"?"+m.join("&").replace(/%20/g,"+"),p.appendChild(h)}},s=function(t,n,o,i){n=n||{},o=o||{},i=i||"GET",n.method=t,n.api_key=e,r(n,o,i)},u=function(t,n,o,i,a){n=n||{},i=i||{},a=a||"GET",n.method=t,n.api_key=e,n.sk=P.lastkey,n.api_sig=l.getApiSignature(n),r(n,i,a)};this.album={addTags:function(t,e,n){"object"==typeof t.tags&&(t.tags=t.tags.join(",")),u("album.addTags",t,e,n,"POST")},getBuylinks:function(t,e){s("album.getBuylinks",t,e)},getInfo:function(t,e){s("album.getInfo",t,e)},getTags:function(t,e,n){u("album.getTags",t,e,n)},removeTag:function(t,e,n){u("album.removeTag",t,e,n,"POST")},search:function(t,e){s("album.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("album.share",t,n)}},this.artist={addTags:function(t,e,n){"object"==typeof t.tags&&(t.tags=t.tags.join(",")),u("artist.addTags",t,e,n,"POST")},getCorrection:function(t,e){s("artist.getCorrection",t,e)},getEvents:function(t,e){s("artist.getEvents",t,e)},getImages:function(t,e){s("artist.getImages",t,e)},getInfo:function(t,e){s("artist.getInfo",t,e)},getPastEvents:function(t,e){s("artist.getPastEvents",t,e)},getPodcast:function(t,e){s("artist.getPodcast",t,e)},getShouts:function(t,e){s("artist.getShouts",t,e)},getSimilar:function(t,e){s("artist.getSimilar",t,e)},getTags:function(t,e,n){u("artist.getTags",t,e,n)},getTopAlbums:function(t,e){s("artist.getTopAlbums",t,e)},getTopFans:function(t,e){s("artist.getTopFans",t,e)},getTopTags:function(t,e){s("artist.getTopTags",t,e)},getTopTracks:function(t,e){s("artist.getTopTracks",t,e)},removeTag:function(t,e,n){u("artist.removeTag",t,e,n,"POST")},search:function(t,e){s("artist.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("artist.share",t,e,n,"POST")},shout:function(t,e,n){u("artist.shout",t,e,n,"POST")}},this.auth={getMobileSession:function(t,e){t={username:t.username,authToken:hex_md5(t.username+hex_md5(t.password))},u("auth.getMobileSession",t,null,e)},getSession:function(t,e){u("auth.getSession",t,null,e)},getToken:function(t){u("auth.getToken",null,null,t)},getWebSession:function(t){var e=o;o="http://ext.last.fm/2.0/",u("auth.getWebSession",null,null,t),o=e}},this.chart={getHypedArtists:function(t,e){s("chart.getHypedArtists",t,e)},getHypedTracks:function(t,e,n){s("chart.getHypedTracks",t,n)},getLovedTracks:function(t,e,n){s("chart.getLovedTracks",t,n)},getTopArtists:function(t,e){s("chart.getTopArtists",t,e)},getTopTags:function(t,e,n){s("chart.getTopTags",t,n)},getTopTracks:function(t,e,n){s("chart.getTopTracks",t,n)}},this.event={attend:function(t,e,n){u("event.attend",t,e,n,"POST")},getAttendees:function(t,e,n){s("event.getAttendees",t,n)},getInfo:function(t,e){s("event.getInfo",t,e)},getShouts:function(t,e){s("event.getShouts",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("event.share",t,e,n,"POST")},shout:function(t,e,n){u("event.shout",t,e,n,"POST")}},this.geo={getEvents:function(t,e){s("geo.getEvents",t,e)},getMetroArtistChart:function(t,e){s("geo.getMetroArtistChart",t,e)},getMetroHypeArtistChart:function(t,e){s("geo.getMetroHypeArtistChart",t,e)},getMetroHypeTrackChart:function(t,e){s("geo.getMetroHypeTrackChart",t,e)},getMetroTrackChart:function(t,e){s("geo.getMetroTrackChart",t,e)},getMetroUniqueArtistChart:function(t,e){s("geo.getMetroUniqueArtistChart",t,e)},getMetroUniqueTrackChart:function(t,e){s("geo.getMetroUniqueTrackChart",t,e)},getMetroWeeklyChartlist:function(t,e){s("geo.getMetroWeeklyChartlist",t,e)},getMetros:function(t,e){s("geo.getMetros",t,e)},getTopArtists:function(t,e){s("geo.getTopArtists",t,e)},getTopTracks:function(t,e){s("geo.getTopTracks",t,e)}},this.group={getHype:function(t,e){s("group.getHype",t,e)},getMembers:function(t,e){s("group.getMembers",t,e)},getWeeklyAlbumChart:function(t,e){s("group.getWeeklyAlbumChart",t,e)},getWeeklyArtistChart:function(t,e){s("group.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("group.getWeeklyChartList",t,e)},getWeeklyTrackChart:function(t,e){s("group.getWeeklyTrackChart",t,e)}},this.library={addAlbum:function(t,e,n){u("library.addAlbum",t,e,n,"POST")},addArtist:function(t,e,n){u("library.addArtist",t,e,n,"POST")},addTrack:function(t,e,n){u("library.addTrack",t,e,n,"POST")},getAlbums:function(t,e){s("library.getAlbums",t,e)},getArtists:function(t,e){s("library.getArtists",t,e)},getTracks:function(t,e){s("library.getTracks",t,e)}},this.playlist={addTrack:function(t,e,n){u("playlist.addTrack",t,e,n,"POST")},create:function(t,e,n){u("playlist.create",t,e,n,"POST")},fetch:function(t,e){s("playlist.fetch",t,e)}},this.radio={getPlaylist:function(t,e,n){u("radio.getPlaylist",t,e,n)},search:function(t,e,n){u("radio.search",t,e,n)},tune:function(t,e,n){u("radio.tune",t,e,n)}},this.tag={getInfo:function(t,e){s("tag.getInfo",t,e)},getSimilar:function(t,e){s("tag.getSimilar",t,e)},getTopAlbums:function(t,e){s("tag.getTopAlbums",t,e)},getTopArtists:function(t,e){s("tag.getTopArtists",t,e)},getTopTags:function(t){s("tag.getTopTags",null,t)},getTopTracks:function(t,e){s("tag.getTopTracks",t,e)},getWeeklyArtistChart:function(t,e){s("tag.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("tag.getWeeklyChartList",t,e)},search:function(t,e){s("tag.search",t,e)}},this.tasteometer={compare:function(t,e){s("tasteometer.compare",t,e)},compareGroup:function(t,e){s("tasteometer.compareGroup",t,e)}},this.track={addTags:function(t,e,n){u("track.addTags",t,e,n,"POST")},ban:function(t,e,n){u("track.ban",t,e,n,"POST")},getBuylinks:function(t,e){s("track.getBuylinks",t,e)},getCorrection:function(t,e){s("track.getCorrection",t,e)},getFingerprintMetadata:function(t,e){s("track.getFingerprintMetadata",t,e)},getInfo:function(t,e){s("track.getInfo",t,e)},getShouts:function(t,e){s("track.getShouts",t,e)},getSimilar:function(t,e){s("track.getSimilar",t,e)},getTags:function(t,e,n){u("track.getTags",t,e,n)},getTopFans:function(t,e){s("track.getTopFans",t,e)},getTopTags:function(t,e){s("track.getTopTags",t,e)},love:function(t,e,n){u("track.love",t,e,n,"POST")},removeTag:function(t,e,n){u("track.removeTag",t,e,n,"POST")},scrobble:function(t,e,n){if(-1!=t.constructor.toString().indexOf("Array")){var o={};for(i in t)for(j in t[i])o[j+"["+i+"]"]=t[i][j];t=o}u("track.scrobble",t,e,n,"POST")},search:function(t,e){s("track.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("track.share",t,e,n,"POST")},unban:function(t,e,n){u("track.unban",t,e,n,"POST")},unlove:function(t,e,n){u("track.unlove",t,e,n,"POST")},updateNowPlaying:function(t,e,n){u("track.updateNowPlaying",t,e,n,"POST")}},this.user={getArtistTracks:function(t,e){s("user.getArtistTracks",t,e)},getBannedTracks:function(t,e){s("user.getBannedTracks",t,e)},getEvents:function(t,e){s("user.getEvents",t,e)},getFriends:function(t,e){s("user.getFriends",t,e)},getInfo:function(t,e){s("user.getInfo",t,e)},getLovedTracks:function(t,e){s("user.getLovedTracks",t,e)},getNeighbours:function(t,e){s("user.getNeighbours",t,e)},getNewReleases:function(t,e){s("user.getNewReleases",t,e)},getPastEvents:function(t,e){s("user.getPastEvents",t,e)},getPersonalTracks:function(t,e){s("user.getPersonalTracks",t,e)},getPlaylists:function(t,e){s("user.getPlaylists",t,e)},getRecentStations:function(t,e,n){u("user.getRecentStations",t,e,n)},getRecentTracks:function(t,e){s("user.getRecentTracks",t,e)},getRecommendedArtists:function(t,e,n){u("user.getRecommendedArtists",t,e,n)},getRecommendedEvents:function(t,e,n){u("user.getRecommendedEvents",t,e,n)},getShouts:function(t,e){s("user.getShouts",t,e)},getTopAlbums:function(t,e){s("user.getTopAlbums",t,e)},getTopArtists:function(t,e){s("user.getTopArtists",t,e)},getTopTags:function(t,e){s("user.getTopTags",t,e)},getTopTracks:function(t,e){s("user.getTopTracks",t,e)},getWeeklyAlbumChart:function(t,e){s("user.getWeeklyAlbumChart",t,e)},getWeeklyArtistChart:function(t,e){s("user.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("user.getWeeklyChartList",t,e)},getWeeklyTrackChart:function(t,e){s("user.getWeeklyTrackChart",t,e)},shout:function(t,e,n){u("user.shout",t,e,n,"POST")}},this.venue={getEvents:function(t,e){s("venue.getEvents",t,e)},getPastEvents:function(t,e){s("venue.getPastEvents",t,e)},search:function(t,e){s("venue.search",t,e)}};var l={getApiSignature:function(t){var e=[],o="";for(var i in t)e.push(i);e.sort();for(var a in e){var i=e[a];o+=i+t[i]}return o+=n,hex_md5(o)}}}function hex_md5(t){return rstr2hex(rstr_md5(str2rstr_utf8(t)))}function hex_hmac_md5(t,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(t){return binl2rstr(binl_md5(rstr2binl(t),8*t.length))}function rstr_hmac_md5(t,e){var n=rstr2binl(t);n.length>16&&(n=binl_md5(n,8*t.length));for(var o=Array(16),i=Array(16),a=0;16>a;a++)o[a]=909522486^n[a],i[a]=1549556828^n[a];var r=binl_md5(o.concat(rstr2binl(e)),512+8*e.length);return binl2rstr(binl_md5(i.concat(r),640))}function rstr2hex(t){try{}catch(e){hexcase=0}for(var n,o=hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",a=0;a<t.length;a++)n=t.charCodeAt(a),i+=o.charAt(n>>>4&15)+o.charAt(15&n);return i}function str2rstr_utf8(t){for(var e,n,o="",i=-1;++i<t.length;)e=t.charCodeAt(i),n=i+1<t.length?t.charCodeAt(i+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),i++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o}function rstr2binl(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function binl2rstr(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function binl_md5(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,o=-271733879,i=-1732584194,a=271733878,r=0;r<t.length;r+=16){var s=n,u=o,l=i,c=a;n=md5_ff(n,o,i,a,t[r+0],7,-680876936),a=md5_ff(a,n,o,i,t[r+1],12,-389564586),i=md5_ff(i,a,n,o,t[r+2],17,606105819),o=md5_ff(o,i,a,n,t[r+3],22,-1044525330),n=md5_ff(n,o,i,a,t[r+4],7,-176418897),a=md5_ff(a,n,o,i,t[r+5],12,1200080426),i=md5_ff(i,a,n,o,t[r+6],17,-1473231341),o=md5_ff(o,i,a,n,t[r+7],22,-45705983),n=md5_ff(n,o,i,a,t[r+8],7,1770035416),a=md5_ff(a,n,o,i,t[r+9],12,-1958414417),i=md5_ff(i,a,n,o,t[r+10],17,-42063),o=md5_ff(o,i,a,n,t[r+11],22,-1990404162),n=md5_ff(n,o,i,a,t[r+12],7,1804603682),a=md5_ff(a,n,o,i,t[r+13],12,-40341101),i=md5_ff(i,a,n,o,t[r+14],17,-1502002290),o=md5_ff(o,i,a,n,t[r+15],22,1236535329),n=md5_gg(n,o,i,a,t[r+1],5,-165796510),a=md5_gg(a,n,o,i,t[r+6],9,-1069501632),i=md5_gg(i,a,n,o,t[r+11],14,643717713),o=md5_gg(o,i,a,n,t[r+0],20,-373897302),n=md5_gg(n,o,i,a,t[r+5],5,-701558691),a=md5_gg(a,n,o,i,t[r+10],9,38016083),i=md5_gg(i,a,n,o,t[r+15],14,-660478335),o=md5_gg(o,i,a,n,t[r+4],20,-405537848),n=md5_gg(n,o,i,a,t[r+9],5,568446438),a=md5_gg(a,n,o,i,t[r+14],9,-1019803690),i=md5_gg(i,a,n,o,t[r+3],14,-187363961),o=md5_gg(o,i,a,n,t[r+8],20,1163531501),n=md5_gg(n,o,i,a,t[r+13],5,-1444681467),a=md5_gg(a,n,o,i,t[r+2],9,-51403784),i=md5_gg(i,a,n,o,t[r+7],14,1735328473),o=md5_gg(o,i,a,n,t[r+12],20,-1926607734),n=md5_hh(n,o,i,a,t[r+5],4,-378558),a=md5_hh(a,n,o,i,t[r+8],11,-2022574463),i=md5_hh(i,a,n,o,t[r+11],16,1839030562),o=md5_hh(o,i,a,n,t[r+14],23,-35309556),n=md5_hh(n,o,i,a,t[r+1],4,-1530992060),a=md5_hh(a,n,o,i,t[r+4],11,1272893353),i=md5_hh(i,a,n,o,t[r+7],16,-155497632),o=md5_hh(o,i,a,n,t[r+10],23,-1094730640),n=md5_hh(n,o,i,a,t[r+13],4,681279174),a=md5_hh(a,n,o,i,t[r+0],11,-358537222),i=md5_hh(i,a,n,o,t[r+3],16,-722521979),o=md5_hh(o,i,a,n,t[r+6],23,76029189),n=md5_hh(n,o,i,a,t[r+9],4,-640364487),a=md5_hh(a,n,o,i,t[r+12],11,-421815835),i=md5_hh(i,a,n,o,t[r+15],16,530742520),o=md5_hh(o,i,a,n,t[r+2],23,-995338651),n=md5_ii(n,o,i,a,t[r+0],6,-198630844),a=md5_ii(a,n,o,i,t[r+7],10,1126891415),i=md5_ii(i,a,n,o,t[r+14],15,-1416354905),o=md5_ii(o,i,a,n,t[r+5],21,-57434055),n=md5_ii(n,o,i,a,t[r+12],6,1700485571),a=md5_ii(a,n,o,i,t[r+3],10,-1894986606),i=md5_ii(i,a,n,o,t[r+10],15,-1051523),o=md5_ii(o,i,a,n,t[r+1],21,-2054922799),n=md5_ii(n,o,i,a,t[r+8],6,1873313359),a=md5_ii(a,n,o,i,t[r+15],10,-30611744),i=md5_ii(i,a,n,o,t[r+6],15,-1560198380),o=md5_ii(o,i,a,n,t[r+13],21,1309151649),n=md5_ii(n,o,i,a,t[r+4],6,-145523070),a=md5_ii(a,n,o,i,t[r+11],10,-1120210379),i=md5_ii(i,a,n,o,t[r+2],15,718787259),o=md5_ii(o,i,a,n,t[r+9],21,-343485551),n=safe_add(n,s),o=safe_add(o,u),i=safe_add(i,l),a=safe_add(a,c)}return Array(n,o,i,a)}function md5_cmn(t,e,n,o,i,a){return safe_add(bit_rol(safe_add(safe_add(e,t),safe_add(o,a)),i),n)}function md5_ff(t,e,n,o,i,a,r){return md5_cmn(e&n|~e&o,t,e,i,a,r)}function md5_gg(t,e,n,o,i,a,r){return md5_cmn(e&o|n&~o,t,e,i,a,r)}function md5_hh(t,e,n,o,i,a,r){return md5_cmn(e^n^o,t,e,i,a,r)}function md5_ii(t,e,n,o,i,a,r){return md5_cmn(n^(e|~o),t,e,i,a,r)}function safe_add(t,e){var n=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(n>>16);return o<<16|65535&n}function bit_rol(t,e){return t<<e|t>>>32-e}var App=angular.module("App",["ngSanitize","ui.router","ui.bootstrap","ngDragDrop","templates"]);App.constant("__domain","http://playaaa.dev.megor.ru").constant("__vkAppId",4468735).constant("__echonest",{key:"JPIQUINIHEVVTYYRU",url:"http://developer.echonest.com/api/v4/"}).constant("__lastfm",{url:"http://ws.audioscrobbler.com/2.0/",keys:{api:"3b716084894fd83886ebe8a20df6bdf0",secret:"abda2711d758f43cbbede5942541f97f"}}).constant("__api",{url:"http://95.85.19.4:8080/",paths:{translationTrackMp3:"/track/translate/",getTrackTranslationData:"/track/getData/",getTopArtists:"/artists/top"}}).constant("localization",{months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]}),angular.module("App").filter("toGIS",function(){return function(t){if(!t)return"";var e="",n="",o=t;return o=Math.round(o),sec=o%60,min=Math.floor(o/60),10>sec&&(e="0"),10>min&&(n="0"),n+min+":"+e+sec}}).filter("formatBitrate",function(){return function(t){var e="";return 128>t&&(e="< 128"),t>=128&&180>t&&(e="128"),t>=180&&240>t&&(e="192"),t>=240&&300>t&&(e="256"),t>=300&&(e="320"),e+" кбит/с"}}),App.config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(t,e,n,o){o.defaults.useXDomain=!0,delete o.defaults.headers.common["X-Requested-With"],o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=utf8",n.html5Mode(!0).hashPrefix("!"),e.otherwise("/discover"),t.state("discover",{url:"/discover/?q",controller:"C_discover as ctr",templateUrl:"templates/views/discover/index.html"}).state("artists",{url:"/artists/",controller:"C_artists as ctr",templateUrl:"templates/views/artists/index.html"}).state("artistpage",{url:"/artists/:artist/",controller:"C_artists.page as ctr",templateUrl:"templates/views/artists/page.html"}).state("artistpage.section",{url:":section/"}).state("flow",{url:"/flow/?artist&tag",controller:"C_flow as ctr",templateUrl:"templates/views/flow/index.html",reloadOnSearch:!1,resovle:{ready:function(){var t=$q.defer();return setTimeout(function(){t.resolve(!0)},500),t.promise}}}).state("playlists",{url:"/playlists/",controller:"C_playlists as ctr",templateUrl:"templates/views/playlists/index.html",reloadOnSearch:!1}).state("share",{url:"/share/:type/:id",controller:"C_share as ctr",templateUrl:"templates/views/share/index.html"}).state("album",{url:"/album/:artist/:albumName",controller:"C_album as ctr",templateUrl:"templates/views/album/index.html"}).state("public",{url:"/public/:id/?album_id",controller:"C_public as ctr",templateUrl:"templates/views/public/page.html",reloadOnSearch:!1})}]),App.run(["$rootScope","PS_lastfm","S_sound","PS_vk",function(t,e,n,o){t.$on("$stateChangeStart",function(e,n,o,i){t.status="loading",("flow"===n.name||"share"===n.name)&&(t.isRadio=!0),("flow"===i.name||"share"===i.name)&&(t.isRadio=!1),t.state=n.name}),o.init(),o.intro(),n.init()}]),angular.module("App").controller("C_controlPanel",["$scope","S_sound","S_modals","PS_vk",function(t,e,n,o){function i(t){var e=t.currentTarget,n=e.clientWidth-10,o=t.offsetX-("progressPanel"===t.target.className||"volumePanel"===t.target.className?5:0),i=100*(o/n);return i}function a(t){var n=i(t);u.progress=n,e.setProgress(n)}function r(t){var n=i(t);u.volume=n,e.setVolume(n)}function s(){var t=$(".track.active").closest(".ng-scope"),e=t.closest(".list"),n=e.children();return{tracks:n,length:n.length,index:t.index()}}var u=this;t.playing=!1;var l=!1,c=!1;return t.$on("progressChanged",function(e,n){var o=n.position/n.durationEstimate*100;u.currentTime=n.position/1e3,u.progress=o,t.$$phase||t.$apply()}),t.$on("progressCalculated",function(e,n){u.totalTime=n.durationEstimate/1e3,t.$$phase||t.$apply()}),t.$on("trackError",function(){u.next()}),t.$on("trackFinished",function(){u.next()}),t.$on("playStateChanged",function(e,n){u.playing=n,t.$$phase||t.$apply()}),t.$on("volumeChanged",function(e,n){u.volume=n,t.$$phase||t.$apply()}),t.$on("downloadingTrackState",function(e,n){u.download=100*n,t.$$phase||t.$apply()}),t.$on("trackStarted",function(t,e){u.totalTime=e.duration,u.artist=e.artist,u.title=e.title,u.feat=e.feat,u.progress=0,u.currentTime=0,u.download=0}),u.title="asdsad",u.pause=function(){e.togglePause()},u.share=function(){n.openShareModal(e.getPlayingTrackInfo())},u.love=function(){o.addTrackToAudios(e.getPlayingTrackInfo()).then(function(){})},u.toggleVolume=function(t){t.stopPropagation(),u.muted=e.toggleMute()},u.stopPropagation=function(t){t.stopPropagation()},u.mouseDown=function(t,e){if(1===t.which){switch(e){case"v":l=!0,r(t);break;case"p":}$("body").on("mouseup",function(){l=!1,c=!1})}},u.mouseMove=function(t,e){switch(e){case"v":l&&r(t);break;case"p":}},u.mouseLeave=function(t,e){switch(e){case"v":l=!1;break;case"p":}},u.mouseUp=function(t,e){switch(e){case"v":1===t.which&&(r(t),l=!1);break;case"p":1===t.which&&(a(t),c=!1)}$("body").off("mouseup")},u.play=function(){e.togglePause()},u.next=function(){var e,n=s();setTimeout(function(){e=n.index+1>=n.length?n.tracks.eq(0).find(".track"):n.tracks.eq(n.index+1).find(".track"),e.trigger("click"),t.$$phase||t.$apply()},0)},u.prev=function(){var e,n=s();setTimeout(function(){e=0===n.index?n.tracks.eq(n.length-1).find(".track"):n.tracks.eq(n.index-1).find(".track"),e.trigger("click"),t.$$phase||t.$apply()},0)},u}]),angular.module("App").controller("C_header",["$state","$scope","PS_lastfm",function(t,e,n){var o=this;return o.search=function(e){n.artist.getInfo(e).then(function(n){!n.data.artist||n.data.artist.stats.listeners<100||n.data.artist.name.toLowerCase()!=e.toLowerCase()?t.go("^.discover",{q:e}):t.go("artistpage",{artist:n.data.artist.name})})},e.$on("userLogin",function(){o.visible=!0}),o}]),angular.module("App").controller("C_intro",["$state","$scope","$timeout","PS_vk",function(t,e,n,o){var i=this;return e.$on("userLogin",function(t,o){e.$apply(function(){i.userName=o.name,n(function(){i.hideIntro=!0,n(function(){i.removeIntro=!0},550)},2e3)})}),e.$on("shareScreenTrack",function(){i.hideIntro=!0,n(function(){i.removeIntro=!0},550)}),e.$on("badAuthorization",function(){e.$apply(function(){i.needAuth=!0})}),i.authorize=function(){o.authorize(),i.needAuth=!1},i}]),angular.module("App").controller("C_playlist",[function(){var t=this;return t.onDragStart=function(){t.inDrag=!0},t.onDragStop=function(){t.inDrag=!1},t.currentTrackList=[],t.onOver=function(){console.log(3)},t.onDrop=function(t,e,n,o){console.log(t,e,n,o)},t}]),angular.module("App").directive("albumImage",[function(){return{scope:{info:"="},templateUrl:"templates/directives/albumImage.html"}}]),angular.module("App").directive("lineLoader",[function(){return{scope:{color:"=lineLoader"},templateUrl:"templates/directives/lineLoader.html",link:function(t,e){t.color&&e.addClass(t.color)}}}]),angular.module("App").directive("minutesScaler",[function(){return{scope:{duration:"="},templateUrl:"templates/directives/minutesScaler.html",link:function(t,e){t.$watch("duration",function(t){if(t){e.html("");for(var n=e[0].offsetWidth,o=t/60,i=n/o,a=Math.ceil(o),r=1;a>r;r++)e.append('<div class="scale" style="left:'+r*i+'px"></div>')}})}}}]),angular.module("App").directive("setBgOnLoad",["$timeout",function(t){return{scope:{src:"=setBgOnLoad"},link:function(e,n){e.$watch("src",function(o){if(o){n.removeClass("active");var i=500,a=new Image;a.src=e.src;var r=(new Date).getTime();a.onload=function(){var o=(new Date).getTime();i>o-r?t(function(){n.css({"background-image":"url("+e.src+")"}).addClass("active")},i-(o-r)):n.css({"background-image":"url("+e.src+")"}).addClass("active")}}})}}}]),angular.module("App").directive("thiefBackground",[function(){return{scope:{imageUrl:"=thiefBackground"},link:function(t,e){return}}}]),angular.module("App").directive("track",["S_sound",function(t){return{scope:{info:"="},controller:"CD_track as tctr",templateUrl:"templates/directives/track.html",link:function(e,n){n.on("click",function(){t.createAndPlay(e.info)})}}}]),angular.module("App").service("S_enviroment",[function(){var t={};return t.setTitle=function(t){document.title=t},t}]),angular.module("App").service("S_eventer",["$rootScope",function(t){var e={};return e.sendEvent=function(e,n){t.$broadcast(e,n)},e}]),angular.module("App").service("S_logic",["$rootScope",function(){var t={};return t.findMostLikelyTrack=function(t,e){for(var n,o,i,a=2,r=(e.length,$.trim(t.artist)),s=$.trim(t.title),u=0;a>u&&!i;u++)_.forEach(e,function(t){if(!i)switch(n=$.trim(t.title),o=$.trim(t.artist),u){case 0:n===s&&o===r&&(i=t);break;case 1:n.toLowerCase()===s.toLowerCase()&&o.toLowerCase()===r.toLowerCase()&&(i=t)}});return i||(i=e[0]),i},t}]),angular.module("App").service("S_modals",["$modal",function(t){var e={};return e.openShareModal=function(e){t.open({templateUrl:"templates/modals/shareTrack.html",controller:"Cm_shareTrack as ctr",resolve:{trackInfo:function(){return e}}})},e}]),angular.module("App").service("S_processing",["$rootScope",function(t){var e={};return e.loading=function(){t.status="loading"},e.ready=function(){t.status="ready"},e}]),angular.module("App").service("S_reduce",["$rootScope",function(){var t={};return t.normalizeTopArtists=function(t){return _.map(t,function(t){return{name:t.name,listeners:t.listeners,image:t.image[t.image.length-1]["#text"]}})},t.normalizeTopTracks=function(t){return _.reduce(t,function(t,e){return t.push({artist:e.artist.name,title:e.name,duration:e.duration}),t},[])},t.filterTracks=function(e,n){n=angular.extend({bigTitles:!1,withDurations:!0},n||{});for(var o=[],i=e.length,a=0;i>a;a++){var r=e[a],s=t.clearTrashSymbols(r.title);if((!n.withDurations||"undefined"!=typeof r.duration&&n.withDurations)&&(n.bigTitles||!n.bigTitles&&r.title.length<50)){var u=t.extractFeats(s),l=t.extractFeats(t.clearTrashSymbols(r.artist));r.title=u.text,r.feat=u.feat||l.feat,r.artist=l.text,o.push(r)}}return o},t.extractFeats=function(t){var e,n,o,i,a=[/(.*)\sft\s(.*)/i,/(.*)\sft\.\s(.*)/i,/(.*)\sft\.(.*)/i,/(.*)\(ft\.(.*)/i,/(.*)\(ft\s(.*)/i,/(.*)\sfeat\.\s(.*)/i,/(.*)\sfeat\.(.*)/i,/(.*)\sfeat\s(.*)/i,/(.*)\(feat\.\s(.*)\)/i,/(.*)\(feat\.(.*)\)/i,/(.*)\(feat\s(.*)\)/i];return _.forEach(a,function(a){i||(o=a.exec(t),_.isArray(o)&&(i=!0,e=o[1],n=o[2]))}),e||(e=t),{text:e,feat:n}},t.clearTrashSymbols=function(t){var e=["♫","►","=","♥"," ]","★","™","║","●","✖"];t=t.replace(new RegExp("[0-9]+[.]","g"),""),t=t.replace(new RegExp("^[0-9]+[ ]","g"),""),t=t.replace(new RegExp("[(][0-9]+[)]","g"),""),t=t.replace(new RegExp("[(][.]+[)]","g"),""),t=t.replace(new RegExp("www.[0-9^ ]*","g"),""),t=t.replace(new RegExp("club[^ ]*","g"),""),t=t.replace(new RegExp("ё","g"),"е"),t=t.replace(/([^ ]*\.ru)/g,""),t=t.replace(/\[[^]*\]/g,"");for(var n=0;n<e.length;n++)t=t.replace(new RegExp(e[n],"g"),"");return t},t}]),angular.module("App").service("S_sound",["$rootScope","$timeout","S_utils","S_enviroment","S_eventer",function(t,e,n,o,i){var a,r,s,u,l,c={},d={};return c.getVolume=function(){var t=n.getCookie("volume");return""===t&&(t=50),+t},c.init=function(){soundManager.setup({url:"/static/js/libs/sm/swf",allowScriptAccess:"always",flashVersion:9,useHighPerformance:!0,preferFlash:!0,useConsole:!1,onready:function(){},onload:function(){},waitForWindowLoad:!0,ontimeout:function(){}}),soundManager.defaultOptions={autoLoad:!0,autoPlay:!1,from:null,loops:1,multiShot:!0,multiShotEvents:!1,pan:0,volume:u,stream:!0},soundManager.onload=function(){var t=c.getVolume();c.setVolume(t),"function"==typeof c.onload&&c.onload()}},c.checkBitRate=function(t,e,n,o){if(d[t])return void(o.bitrate=d[t]);var i=e.lastIndexOf("?");e=e.slice(0,i);{var a="br"+t;soundManager.createSound({volume:10,id:a,url:e,autoLoad:!0,autoPlay:!1,whileloading:function(){if(this.bytesLoaded>50){var e=this.bytesTotal,i=Math.floor(e/1024*8/n);d[t]=i,o.bitrate=i,setTimeout(function(){o.$$phase||o.$apply()},0),this.playState||soundManager.unload(a),o.error=!1}}})}},c.getSound=function(){return a},c.getSoundId=function(){return r},c.getPlayingTrackInfo=function(){return s},c.toggleMute=function(){return a?(a.toggleMute(),l=!l):void 0},c.setVolume=function(t){t=+t,0>t&&(t=0),t>100&&(t=100),u=t,a&&a.setVolume(t),n.setCookie("volume",t),i.sendEvent("volumeChanged",t)},c.setProgress=function(t){t=+t,0>t&&(t=0),t>100&&(t=100),a&&a.setPosition(a.durationEstimate*t/100),i.sendEvent("progressChanged",a)},c.togglePause=function(){return a?(a.togglePause(),!0):!1},c.pause=function(){a&&a.pause()},c.create=function(t,e){var n=t.aid,o=t.url;return c.stopAll(),a&&3!==a.readyState&&a.unload(),a=soundManager.createSound({id:n,url:o,volume:u,onfinish:function(){"function"==typeof e&&e(),i.sendEvent("trackFinished")},onload:function(){i.sendEvent("progressCalculated",this)},whileplaying:function(){null!=this.duration&&i.sendEvent("progressChanged",this)},whileloading:function(){null!=this.bytesLoaded&&i.sendEvent("downloadingTrackState",this.bytesLoaded/this.bytesTotal)},onplay:function(){i.sendEvent("progressCalculated",!0)},onresume:function(){i.sendEvent("playStateChanged",!0)},onpause:function(){i.sendEvent("playStateChanged",!1)}})},c.stopAll=function(){soundManager.stopAll()},c.getMemory=function(){var t=(soundManager.getMemoryUse()/1024/1024).toFixed(2);return t},c.createAndPlay=function(t,n,a){var u=c.create(t,a);l&&u.mute(),u.play(),s=t,r=t.id,o.setTitle(t.artist+" – "+t.title),e(function(){var e=c.getSound();e.url==t.url&&null===e.bytesLoaded&&("function"==typeof n&&n(),i.sendEvent("trackError"))},8e3),i.sendEvent("trackStarted",t)},c}]),angular.module("App").service("S_utils",[function(){var t={};t.setCookie=function(t,e,n){var o;if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),o="; expires="+i.toGMTString()}else o="";document.cookie=t+"="+e+o+"; path=/"},t.getCookie=function(t){return document.cookie.length>0&&(c_start=document.cookie.indexOf(t+"="),-1!=c_start)?(c_start=c_start+t.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},t.shuffleArray=function(t){for(var e,n,o=t.length;0!==o;)n=Math.floor(Math.random()*o),o-=1,e=t[o],t[o]=t[n],t[n]=e;return t};var e=function(){return document.addEventListener?function(t,n,o){if(t&&t.nodeName||t===window)t.addEventListener(n,o,!1);else if(t&&t.length)for(var i=0;i<t.length;i++)e(t[i],n,o)}:function(t,n,o){if(t&&t.nodeName||t===window)t.attachEvent("on"+n,function(){return o.call(t,window.event)});else if(t&&t.length)for(var i=0;i<t.length;i++)e(t[i],n,o)}}();return t.prepareTextToExecute=function(t){return"string"!=typeof t?t:_.escape(t)},t.getExecuteCode=function(t,e){var n=t.toString(),o=n.slice(n.indexOf("{")+1,n.lastIndexOf("}")),a="";if("object"==typeof e)for(i in e)"object"==typeof e[i]?e[i]=JSON.stringify(e[i]):"string"==typeof e[i]&&(e[i]='"'+e[i]+'"'),a+="var "+i+" = "+e[i]+";";return a+o},t}]),angular.module("App").filter("lastfmDateToLocal",["localization",function(t){return function(e){if(e){var n=moment(e,"DD MMM YYYY HH:mm");return n.format("DD")+" "+t.months[n.month()]+" "+n.format("YYYY")}}}]),angular.module("App").filter("parseVkUrls",[function(){return function(t,e){if(t){var n=/\[club([0-9]*)\|([^\]]*)\]/g,o=/\[id([0-9]*)\|([^\]]*)\]/g,i=e?t.replace(n,"<span>$2</span>"):t.replace(n,'<a class="link" href="/public/$1/">$2</a>');return i=i.replace(o,"<span>$2</span>").replace(/\n/g,"<br />")}}}]),angular.module("App").filter("unEscape",[function(){return function(t){return t?_.unescape(t):void 0}}]),angular.module("App").filter("withoutStatsCleaning",[function(){return function(t){return t?_.reduce(t,function(t,e){return-1===e.imageSrc.indexOf("KeepStatsClean")&&t.push(e),t},[]):void 0}}]);var hexcase=0;!function(t,e){"use strict";function n(n,o){function i(t){return pe.preferFlash&&re&&!pe.ignoreFlash&&pe.flash[t]!==e&&pe.flash[t]}function a(t){return function(e){var n,o=this._s;return n=o&&o._a?t.call(this,e):null}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=o||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20140901",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;
var r,s,u,l,c,d,f,p,h,m,g,_,v,y,b,w,T,k,S,A,O,x,V,C,M,P,K,I,L,E,D,U,H,$,W,F,B,R,N,j,q,X,z,Y,J,G,Q,Z,te,ee,ne,oe,ie,ae,re,se,ue,le,ce,de,fe,pe=this,he=null,me=null,ge=navigator.userAgent,_e=t.location.href.toString(),ve=document,ye=[],be=!1,we=!1,Te=!1,ke=!1,Se=!1,Ae=8,Oe=null,xe=null,Ve=!1,Ce=!1,Me=0,Pe=null,Ke=[],Ie=null,Le=Array.prototype.slice,Ee=!1,De=0,Ue=ge.match(/(ipad|iphone|ipod)/i),He=ge.match(/android/i),$e=ge.match(/msie/i),We=ge.match(/webkit/i),Fe=ge.match(/safari/i)&&!ge.match(/chrome/i),Be=ge.match(/opera/i),Re=ge.match(/(mobile|pre\/|xoom)/i)||Ue||He,Ne=!_e.match(/usehtml5audio/i)&&!_e.match(/sm2\-ignorebadua/i)&&Fe&&!ge.match(/silk/i)&&ge.match(/OS X 10_6_([3-7])/i),je=(t.console!==e&&console.log!==e,ve.hasFocus!==e?ve.hasFocus():null),qe=Fe&&(ve.hasFocus===e||!ve.hasFocus()),Xe=!qe,ze=/(mp3|mp4|mpa|m4a|m4b)/i,Ye=1e3,Je="about:blank",Ge="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",Qe=ve.location?ve.location.protocol.match(/http/i):null,Ze=Qe?"":"http://",tn=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,en=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],nn=new RegExp("\\.("+en.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Qe,F={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==e&&(Be&&opera!==e&&opera.version()<10?new Audio(null):new Audio).canPlayType!==e}catch(t){return!1}}(),this.setup=function(t){var n=!pe.url;return t!==e&&Te&&Ie&&pe.ok()&&(t.flashVersion!==e||t.url!==e||t.html5Test!==e),h(t),t&&(n&&C&&t.url!==e&&pe.beginDelayedInit(),C||t.url===e||"complete"!==ve.readyState||setTimeout(x,1)),pe},this.ok=function(){return Ie?Te&&!ke:pe.useHTML5Audio&&pe.hasHTML5},this.supported=this.ok,this.getMovie=function(e){return s(e)||ve[e]||t[e]},this.createSound=function(t,n){function o(){return a=B(a),pe.sounds[a.id]=new r(a),pe.soundIDs.push(a.id),pe.sounds[a.id]}var i,a,s=null;if(!Te||!pe.ok())return!1;if(n!==e&&(t={id:t,url:n}),a=p(t),a.url=Y(a.url),void 0===a.id&&(a.id=pe.setupOptions.idPrefix+De++),j(a.id,!0))return pe.sounds[a.id];if(Q(a))s=o(),s._setup_html5(a);else{if(pe.html5Only)return o();if(pe.html5.usingFlash&&a.url&&a.url.match(/data\:/i))return o();d>8&&null===a.isMovieStar&&(a.isMovieStar=!!(a.serverURL||(a.type?a.type.match(tn):!1)||a.url&&a.url.match(nn))),a=R(a,i),s=o(),8===d?me._createSound(a.id,a.loops||1,a.usePolicyFile):(me._createSound(a.id,a.url,a.usePeakData,a.useWaveformData,a.useEQData,a.isMovieStar,a.isMovieStar?a.bufferTime:!1,a.loops||1,a.serverURL,a.duration||null,a.autoPlay,!0,a.autoLoad,a.usePolicyFile),a.serverURL||(s.connected=!0,a.onconnect&&a.onconnect.apply(s))),a.serverURL||!a.autoLoad&&!a.autoPlay||s.load(a)}return!a.serverURL&&a.autoPlay&&s.play(),s},this.destroySound=function(t,e){if(!j(t))return!1;var n,o=pe.sounds[t];for(o._iO={},o.stop(),o.unload(),n=0;n<pe.soundIDs.length;n++)if(pe.soundIDs[n]===t){pe.soundIDs.splice(n,1);break}return e||o.destruct(!0),o=null,delete pe.sounds[t],!0},this.load=function(t,e){return j(t)?pe.sounds[t].load(e):!1},this.unload=function(t){return j(t)?pe.sounds[t].unload():!1},this.onPosition=function(t,e,n,o){return j(t)?pe.sounds[t].onposition(e,n,o):!1},this.onposition=this.onPosition,this.clearOnPosition=function(t,e,n){return j(t)?pe.sounds[t].clearOnPosition(e,n):!1},this.play=function(t,e){var n=null,o=e&&!(e instanceof Object);if(!Te||!pe.ok())return!1;if(j(t,o))o&&(e={url:e});else{if(!o)return!1;o&&(e={url:e}),e&&e.url&&(e.id=t,n=pe.createSound(e).play())}return null===n&&(n=pe.sounds[t].play(e)),n},this.start=this.play,this.setPosition=function(t,e){return j(t)?pe.sounds[t].setPosition(e):!1},this.stop=function(t){return j(t)?pe.sounds[t].stop():!1},this.stopAll=function(){var t;for(t in pe.sounds)pe.sounds.hasOwnProperty(t)&&pe.sounds[t].stop()},this.pause=function(t){return j(t)?pe.sounds[t].pause():!1},this.pauseAll=function(){var t;for(t=pe.soundIDs.length-1;t>=0;t--)pe.sounds[pe.soundIDs[t]].pause()},this.resume=function(t){return j(t)?pe.sounds[t].resume():!1},this.resumeAll=function(){var t;for(t=pe.soundIDs.length-1;t>=0;t--)pe.sounds[pe.soundIDs[t]].resume()},this.togglePause=function(t){return j(t)?pe.sounds[t].togglePause():!1},this.setPan=function(t,e){return j(t)?pe.sounds[t].setPan(e):!1},this.setVolume=function(t,e){return j(t)?pe.sounds[t].setVolume(e):!1},this.mute=function(t){var e=0;if(t instanceof String&&(t=null),t)return j(t)?pe.sounds[t].mute():!1;for(e=pe.soundIDs.length-1;e>=0;e--)pe.sounds[pe.soundIDs[e]].mute();return pe.muted=!0,!0},this.muteAll=function(){pe.mute()},this.unmute=function(t){var e;if(t instanceof String&&(t=null),t)return j(t)?pe.sounds[t].unmute():!1;for(e=pe.soundIDs.length-1;e>=0;e--)pe.sounds[pe.soundIDs[e]].unmute();return pe.muted=!1,!0},this.unmuteAll=function(){pe.unmute()},this.toggleMute=function(t){return j(t)?pe.sounds[t].toggleMute():!1},this.getMemoryUse=function(){var t=0;return me&&8!==d&&(t=parseInt(me._getMemoryUse(),10)),t},this.disable=function(n){var o;if(n===e&&(n=!1),ke)return!1;for(ke=!0,o=pe.soundIDs.length-1;o>=0;o--)E(pe.sounds[pe.soundIDs[o]]);return f(n),ie.remove(t,"load",v),!0},this.canPlayMIME=function(t){var e;return pe.hasHTML5&&(e=Z({type:t})),!e&&Ie&&(e=t&&pe.ok()?!!((d>8?t.match(tn):null)||t.match(pe.mimePattern)):null),e},this.canPlayURL=function(t){var e;return pe.hasHTML5&&(e=Z({url:t})),!e&&Ie&&(e=t&&pe.ok()?!!t.match(pe.filePattern):null),e},this.canPlayLink=function(t){return t.type!==e&&t.type&&pe.canPlayMIME(t.type)?!0:pe.canPlayURL(t.href)},this.getSoundById=function(t){if(!t)return null;var e=pe.sounds[t];return e},this.onready=function(e,n){var o="onready",i=!1;if("function"!=typeof e)throw H("needFunction",o);return n||(n=t),g(o,e,n),_(),i=!0,i},this.ontimeout=function(e,n){var o="ontimeout",i=!1;if("function"!=typeof e)throw H("needFunction",o);return n||(n=t),g(o,e,n),_({type:o}),i=!0,i},this._writeDebug=function(){return!0},this._wD=this._writeDebug,this._debug=function(){},this.reboot=function(e,n){var o,i,a;for(o=pe.soundIDs.length-1;o>=0;o--)pe.sounds[pe.soundIDs[o]].destruct();if(me)try{$e&&(xe=me.innerHTML),Oe=me.parentNode.removeChild(me)}catch(r){}if(xe=Oe=Ie=me=null,pe.enabled=C=Te=Ve=Ce=be=we=ke=Ee=pe.swfLoaded=!1,pe.soundIDs=[],pe.sounds={},De=0,e)ye=[];else for(o in ye)if(ye.hasOwnProperty(o))for(i=0,a=ye[o].length;a>i;i++)ye[o][i].fired=!1;return pe.html5={usingFlash:null},pe.flash={},pe.html5Only=!1,pe.ignoreFlash=!1,t.setTimeout(function(){O(),n||pe.beginDelayedInit()},20),pe},this.reset=function(){return pe.reboot(!0,!0)},this.getMoviePercent=function(){return me&&"PercentLoaded"in me?me.PercentLoaded():null},this.beginDelayedInit=function(){Se=!0,x(),setTimeout(function(){return Ce?!1:(P(),A(),Ce=!0,!0)},20),y()},this.destruct=function(){pe.disable(!0)},r=function(t){var n,o,i,a,r,s,u,l,c,f,h=this,m=!1,g=[],_=0,v=null;c={duration:null,time:null},this.id=t.id,this.sID=this.id,this.url=t.url,this.options=p(t),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,f=this.url?!1:!0,this.id3={},this._debug=function(){},this.load=function(t){var n,o=null;if(t!==e?h._iO=p(t,h.options):(t=h.options,h._iO=t,v&&v!==h.url&&(h._iO.url=h.url,h.url=null)),h._iO.url||(h._iO.url=h.url),h._iO.url=Y(h._iO.url),h.instanceOptions=h._iO,n=h._iO,!n.url&&!h.url)return h;if(n.url===h.url&&0!==h.readyState&&2!==h.readyState)return 3===h.readyState&&n.onload&&fe(h,function(){n.onload.apply(h,[!!h.duration])}),h;if(h.loaded=!1,h.readyState=1,h.playState=0,h.id3={},Q(n))o=h._setup_html5(n),o._called_load||(h._html5_canplay=!1,h.url!==n.url&&(h._a.src=n.url,h.setPosition(0)),h._a.autobuffer="auto",h._a.preload="auto",h._a._called_load=!0);else{if(pe.html5Only)return h;if(h._iO.url&&h._iO.url.match(/data\:/i))return h;try{h.isHTML5=!1,h._iO=R(B(n)),h._iO.autoPlay&&(h._iO.position||h._iO.from)&&(h._iO.autoPlay=!1),n=h._iO,8===d?me._load(h.id,n.url,n.stream,n.autoPlay,n.usePolicyFile):me._load(h.id,n.url,!!n.stream,!!n.autoPlay,n.loops||1,!!n.autoLoad,n.usePolicyFile)}catch(i){K({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return h.url=n.url,h},this.unload=function(){return 0!==h.readyState&&(h.isHTML5?(a(),h._a&&(h._a.pause(),v=ee(h._a))):8===d?me._unload(h.id,Je):me._unload(h.id),n()),h},this.destruct=function(t){h.isHTML5?(a(),h._a&&(h._a.pause(),ee(h._a),Ee||i(),h._a._s=null,h._a=null)):(h._iO.onfailure=null,me._destroySound(h.id)),t||pe.destroySound(h.id,!0)},this.play=function(t,n){var o,i,a,u,c,g,_=!0,v=null;if(n=n===e?!0:n,t||(t={}),h.url&&(h._iO.url=h.url),h._iO=p(h._iO,h.options),h._iO=p(t,h._iO),h._iO.url=Y(h._iO.url),h.instanceOptions=h._iO,!h.isHTML5&&h._iO.serverURL&&!h.connected)return h.getAutoPlay()||h.setAutoPlay(!0),h;if(Q(h._iO)&&(h._setup_html5(h._iO),r()),1!==h.playState||h.paused||(o=h._iO.multiShot,o||(h.isHTML5&&h.setPosition(h._iO.position),v=h)),null!==v)return v;if(t.url&&t.url!==h.url&&(h.readyState||h.isHTML5||8!==d||!f?h.load(h._iO):f=!1),h.loaded||(0===h.readyState?(h.isHTML5||pe.html5Only?h.isHTML5?h.load(h._iO):v=h:(h._iO.autoPlay=!0,h.load(h._iO)),h.instanceOptions=h._iO):2===h.readyState&&(v=h)),null!==v)return v;if(!h.isHTML5&&9===d&&h.position>0&&h.position===h.duration&&(t.position=0),h.paused&&h.position>=0&&(!h._iO.serverURL||h.position>0))h.resume();else{if(h._iO=p(t,h._iO),(!h.isHTML5&&null!==h._iO.position&&h._iO.position>0||null!==h._iO.from&&h._iO.from>0||null!==h._iO.to)&&0===h.instanceCount&&0===h.playState&&!h._iO.serverURL){if(a=function(){h._iO=p(t,h._iO),h.play(h._iO)},h.isHTML5&&!h._html5_canplay?(h.load({_oncanplay:a}),v=!1):h.isHTML5||h.loaded||h.readyState&&2===h.readyState||(h.load({onload:a}),v=!1),null!==v)return v;h._iO=l()}(!h.instanceCount||h._iO.multiShotEvents||h.isHTML5&&h._iO.multiShot&&!Ee||!h.isHTML5&&d>8&&!h.getAutoPlay())&&h.instanceCount++,h._iO.onposition&&0===h.playState&&s(h),h.playState=1,h.paused=!1,h.position=h._iO.position===e||isNaN(h._iO.position)?0:h._iO.position,h.isHTML5||(h._iO=R(B(h._iO))),h._iO.onplay&&n&&(h._iO.onplay.apply(h),m=!0),h.setVolume(h._iO.volume,!0),h.setPan(h._iO.pan,!0),h.isHTML5?h.instanceCount<2?(r(),i=h._setup_html5(),h.setPosition(h._iO.position),i.play()):(u=new Audio(h._iO.url),c=function(){ie.remove(u,"ended",c),h._onfinish(h),ee(u),u=null},g=function(){ie.remove(u,"canplay",g);try{u.currentTime=h._iO.position/Ye}catch(t){}u.play()},ie.add(u,"ended",c),void 0!==h._iO.volume&&(u.volume=Math.max(0,Math.min(1,h._iO.volume/100))),h.muted&&(u.muted=!0),h._iO.position?ie.add(u,"canplay",g):u.play()):(_=me._start(h.id,h._iO.loops||1,9===d?h.position:h.position/Ye,h._iO.multiShot||!1),9!==d||_||h._iO.onplayerror&&h._iO.onplayerror.apply(h))}return h},this.start=this.play,this.stop=function(t){var e,n=h._iO;return 1===h.playState&&(h._onbufferchange(0),h._resetOnPosition(0),h.paused=!1,h.isHTML5||(h.playState=0),u(),n.to&&h.clearOnPosition(n.to),h.isHTML5?h._a&&(e=h.position,h.setPosition(0),h.position=e,h._a.pause(),h.playState=0,h._onTimer(),a()):(me._stop(h.id,t),n.serverURL&&h.unload()),h.instanceCount=0,h._iO={},n.onstop&&n.onstop.apply(h)),h},this.setAutoPlay=function(t){h._iO.autoPlay=t,h.isHTML5||(me._setAutoPlay(h.id,t),t&&(h.instanceCount||1!==h.readyState||h.instanceCount++))},this.getAutoPlay=function(){return h._iO.autoPlay},this.setPosition=function(t){t===e&&(t=0);var n,o,i=h.isHTML5?Math.max(t,0):Math.min(h.duration||h._iO.duration,Math.max(t,0));if(h.position=i,o=h.position/Ye,h._resetOnPosition(h.position),h._iO.position=i,h.isHTML5){if(h._a){if(h._html5_canplay){if(h._a.currentTime!==o)try{h._a.currentTime=o,(0===h.playState||h.paused)&&h._a.pause()}catch(a){}}else if(o)return h;h.paused&&h._onTimer(!0)}}else n=9===d?h.position:o,h.readyState&&2!==h.readyState&&me._setPosition(h.id,n,h.paused||!h.playState,h._iO.multiShot);return h},this.pause=function(t){return h.paused||0===h.playState&&1!==h.readyState?h:(h.paused=!0,h.isHTML5?(h._setup_html5().pause(),a()):(t||t===e)&&me._pause(h.id,h._iO.multiShot),h._iO.onpause&&h._iO.onpause.apply(h),h)},this.resume=function(){var t=h._iO;return h.paused?(h.paused=!1,h.playState=1,h.isHTML5?(h._setup_html5().play(),r()):(t.isMovieStar&&!t.serverURL&&h.setPosition(h.position),me._pause(h.id,t.multiShot)),!m&&t.onplay?(t.onplay.apply(h),m=!0):t.onresume&&t.onresume.apply(h),h):h},this.togglePause=function(){return 0===h.playState?(h.play({position:9!==d||h.isHTML5?h.position/Ye:h.position}),h):(h.paused?h.resume():h.pause(),h)},this.setPan=function(t,n){return t===e&&(t=0),n===e&&(n=!1),h.isHTML5||me._setPan(h.id,t),h._iO.pan=t,n||(h.pan=t,h.options.pan=t),h},this.setVolume=function(t,n){return t===e&&(t=100),n===e&&(n=!1),h.isHTML5?h._a&&(pe.muted&&!h.muted&&(h.muted=!0,h._a.muted=!0),h._a.volume=Math.max(0,Math.min(1,t/100))):me._setVolume(h.id,pe.muted&&!h.muted||h.muted?0:t),h._iO.volume=t,n||(h.volume=t,h.options.volume=t),h},this.mute=function(){return h.muted=!0,h.isHTML5?h._a&&(h._a.muted=!0):me._setVolume(h.id,0),h},this.unmute=function(){h.muted=!1;var t=h._iO.volume!==e;return h.isHTML5?h._a&&(h._a.muted=!1):me._setVolume(h.id,t?h._iO.volume:h.options.volume),h},this.toggleMute=function(){return h.muted?h.unmute():h.mute()},this.onPosition=function(t,n,o){return g.push({position:parseInt(t,10),method:n,scope:o!==e?o:h,fired:!1}),h},this.onposition=this.onPosition,this.clearOnPosition=function(t,e){var n;if(t=parseInt(t,10),isNaN(t))return!1;for(n=0;n<g.length;n++)t===g[n].position&&(e&&e!==g[n].method||(g[n].fired&&_--,g.splice(n,1)))},this._processOnPosition=function(){var t,e,n=g.length;if(!n||!h.playState||_>=n)return!1;for(t=n-1;t>=0;t--)e=g[t],!e.fired&&h.position>=e.position&&(e.fired=!0,_++,e.method.apply(e.scope,[e.position]),n=g.length);return!0},this._resetOnPosition=function(t){var e,n,o=g.length;if(!o)return!1;for(e=o-1;e>=0;e--)n=g[e],n.fired&&t<=n.position&&(n.fired=!1,_--);return!0},l=function(){var t,e,n=h._iO,o=n.from,i=n.to;return e=function(){h.clearOnPosition(i,e),h.stop()},t=function(){null===i||isNaN(i)||h.onPosition(i,e)},null===o||isNaN(o)||(n.position=o,n.multiShot=!1,t()),n},s=function(){var t,e=h._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&h.onPosition(parseInt(t,10),e[t])},u=function(){var t,e=h._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&h.clearOnPosition(parseInt(t,10))},r=function(){h.isHTML5&&q(h)},a=function(){h.isHTML5&&X(h)},n=function(t){t||(g=[],_=0),m=!1,h._hasTimer=null,h._a=null,h._html5_canplay=!1,h.bytesLoaded=null,h.bytesTotal=null,h.duration=h._iO&&h._iO.duration?h._iO.duration:null,h.durationEstimate=null,h.buffered=[],h.eqData=[],h.eqData.left=[],h.eqData.right=[],h.failures=0,h.isBuffering=!1,h.instanceOptions={},h.instanceCount=0,h.loaded=!1,h.metadata={},h.readyState=0,h.muted=!1,h.paused=!1,h.peakData={left:0,right:0},h.waveformData={left:[],right:[]},h.playState=0,h.position=null,h.id3={}},n(),this._onTimer=function(t){var e,n,o=!1,i={};return h._hasTimer||t?(h._a&&(t||(h.playState>0||1===h.readyState)&&!h.paused)&&(e=h._get_html5_duration(),e!==c.duration&&(c.duration=e,h.duration=e,o=!0),h.durationEstimate=h.duration,n=h._a.currentTime*Ye||0,n!==c.time&&(c.time=n,o=!0),(o||t)&&h._whileplaying(n,i,i,i,i)),o):void 0},this._get_html5_duration=function(){var t=h._iO,e=h._a&&h._a.duration?h._a.duration*Ye:t&&t.duration?t.duration:null,n=e&&!isNaN(e)&&1/0!==e?e:null;return n},this._apply_loop=function(t,e){t.loop=e>1?"loop":""},this._setup_html5=function(t){var e,i=p(h._iO,t),a=Ee?he:h._a,r=decodeURI(i.url);if(Ee?r===decodeURI(ae)&&(e=!0):r===decodeURI(v)&&(e=!0),a){if(a._s)if(Ee)a._s&&a._s.playState&&!e&&a._s.stop();else if(!Ee&&r===decodeURI(v))return h._apply_loop(a,i.loops),a;e||(v&&n(!1),a.src=i.url,h.url=i.url,v=i.url,ae=i.url,a._called_load=!1)}else i.autoLoad||i.autoPlay?(h._a=new Audio(i.url),h._a.load()):h._a=Be&&opera.version()<10?new Audio(null):new Audio,a=h._a,a._called_load=!1,Ee&&(he=a);return h.isHTML5=!0,h._a=a,a._s=h,o(),h._apply_loop(a,i.loops),i.autoLoad||i.autoPlay?h.load():(a.autobuffer=!1,a.preload="auto"),a},o=function(){function t(t,e,n){return h._a?h._a.addEventListener(t,e,n||!1):null}if(h._a._added_events)return!1;var e;h._a._added_events=!0;for(e in le)le.hasOwnProperty(e)&&t(e,le[e]);return!0},i=function(){function t(t,e,n){return h._a?h._a.removeEventListener(t,e,n||!1):null}var e;h._a._added_events=!1;for(e in le)le.hasOwnProperty(e)&&t(e,le[e])},this._onload=function(t){var e=!!t||!h.isHTML5&&8===d&&h.duration;return h.loaded=e,h.readyState=e?3:2,h._onbufferchange(0),h._iO.onload&&fe(h,function(){h._iO.onload.apply(h,[e])}),!0},this._onbufferchange=function(t){return 0===h.playState?!1:t&&h.isBuffering||!t&&!h.isBuffering?!1:(h.isBuffering=1===t,h._iO.onbufferchange&&h._iO.onbufferchange.apply(h,[t]),!0)},this._onsuspend=function(){return h._iO.onsuspend&&h._iO.onsuspend.apply(h),!0},this._onfailure=function(t,e,n){h.failures++,h._iO.onfailure&&1===h.failures&&h._iO.onfailure(t,e,n)},this._onwarning=function(t,e,n){h._iO.onwarning&&h._iO.onwarning(t,e,n)},this._onfinish=function(){var t=h._iO.onfinish;h._onbufferchange(0),h._resetOnPosition(0),h.instanceCount&&(h.instanceCount--,h.instanceCount||(u(),h.playState=0,h.paused=!1,h.instanceCount=0,h.instanceOptions={},h._iO={},a(),h.isHTML5&&(h.position=0)),(!h.instanceCount||h._iO.multiShotEvents)&&t&&fe(h,function(){t.apply(h)}))},this._whileloading=function(t,e,n,o){var i=h._iO;h.bytesLoaded=t,h.bytesTotal=e,h.duration=Math.floor(n),h.bufferLength=o,h.durationEstimate=h.isHTML5||i.isMovieStar?h.duration:i.duration?h.duration>i.duration?h.duration:i.duration:parseInt(h.bytesTotal/h.bytesLoaded*h.duration,10),h.isHTML5||(h.buffered=[{start:0,end:h.duration}]),(3!==h.readyState||h.isHTML5)&&i.whileloading&&i.whileloading.apply(h)},this._whileplaying=function(t,n,o,i,a){var r,s=h._iO;return isNaN(t)||null===t?!1:(h.position=Math.max(0,t),h._processOnPosition(),!h.isHTML5&&d>8&&(s.usePeakData&&n!==e&&n&&(h.peakData={left:n.leftPeak,right:n.rightPeak}),s.useWaveformData&&o!==e&&o&&(h.waveformData={left:o.split(","),right:i.split(",")}),s.useEQData&&a!==e&&a&&a.leftEQ&&(r=a.leftEQ.split(","),h.eqData=r,h.eqData.left=r,a.rightEQ!==e&&a.rightEQ&&(h.eqData.right=a.rightEQ.split(",")))),1===h.playState&&(h.isHTML5||8!==d||h.position||!h.isBuffering||h._onbufferchange(0),s.whileplaying&&s.whileplaying.apply(h)),!0)},this._oncaptiondata=function(t){h.captiondata=t,h._iO.oncaptiondata&&h._iO.oncaptiondata.apply(h,[t])},this._onmetadata=function(t,e){var n,o,i={};for(n=0,o=t.length;o>n;n++)i[t[n]]=e[n];h.metadata=i,console.log("updated metadata",h.metadata),h._iO.onmetadata&&h._iO.onmetadata.call(h,h.metadata)},this._onid3=function(t,e){var n,o,i=[];for(n=0,o=t.length;o>n;n++)i[t[n]]=e[n];h.id3=p(h.id3,i),h._iO.onid3&&h._iO.onid3.apply(h)},this._onconnect=function(t){t=1===t,h.connected=t,t&&(h.failures=0,j(h.id)&&(h.getAutoPlay()?h.play(e,h.getAutoPlay()):h._iO.autoLoad&&h.load()),h._iO.onconnect&&h._iO.onconnect.apply(h,[t]))},this._ondataerror=function(){h.playState>0&&h._iO.ondataerror&&h._iO.ondataerror.apply(h)}},M=function(){return ve.body||ve.getElementsByTagName("div")[0]},s=function(t){return ve.getElementById(t)},p=function(t,n){var o,i,a=t||{};o=n===e?pe.defaultOptions:n;for(i in o)o.hasOwnProperty(i)&&a[i]===e&&(a[i]="object"!=typeof o[i]||null===o[i]?o[i]:p(a[i],o[i]));return a},fe=function(e,n){e.isHTML5||8!==d?n():t.setTimeout(n,0)},m={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},h=function(t,n){var o,i=!0,a=n!==e,r=pe.setupOptions,s=m;for(o in t)if(t.hasOwnProperty(o))if("object"!=typeof t[o]||null===t[o]||t[o]instanceof Array||t[o]instanceof RegExp)a&&s[n]!==e?pe[n][o]=t[o]:r[o]!==e?(pe.setupOptions[o]=t[o],pe[o]=t[o]):s[o]===e?i=!1:pe[o]instanceof Function?pe[o].apply(pe,t[o]instanceof Array?t[o]:[t[o]]):pe[o]=t[o];else{if(s[o]!==e)return h(t[o],o);i=!1}return i},ie=function(){function e(t){var e=Le.call(t),n=e.length;return a?(e[1]="on"+e[1],n>3&&e.pop()):3===n&&e.push(!1),e}function n(t,e){var n=t.shift(),o=[r[e]];a?n[o](t[0],t[1]):n[o].apply(n,t)}function o(){n(e(arguments),"add")}function i(){n(e(arguments),"remove")}var a=t.attachEvent,r={add:a?"attachEvent":"addEventListener",remove:a?"detachEvent":"removeEventListener"};return{add:o,remove:i}}(),le={abort:a(function(){}),canplay:a(function(){var t,n=this._s;if(n._html5_canplay)return!0;if(n._html5_canplay=!0,n._onbufferchange(0),t=n._iO.position===e||isNaN(n._iO.position)?null:n._iO.position/Ye,this.currentTime!==t)try{this.currentTime=t}catch(o){}n._iO._oncanplay&&n._iO._oncanplay()}),canplaythrough:a(function(){var t=this._s;t.loaded||(t._onbufferchange(0),t._whileloading(t.bytesLoaded,t.bytesTotal,t._get_html5_duration()),t._onload(!0))}),durationchange:a(function(){var t,e=this._s;t=e._get_html5_duration(),isNaN(t)||t===e.duration||(e.durationEstimate=e.duration=t)}),ended:a(function(){var t=this._s;t._onfinish()}),error:a(function(){this._s._onload(!1)}),loadeddata:a(function(){var t=this._s;t._loaded||Fe||(t.duration=t._get_html5_duration())}),loadedmetadata:a(function(){}),loadstart:a(function(){this._s._onbufferchange(1)}),play:a(function(){this._s._onbufferchange(0)}),playing:a(function(){this._s._onbufferchange(0)}),progress:a(function(t){var e,n,o=this._s,i=0,a=("progress"===t.type,t.target.buffered),r=t.loaded||0,s=t.total||1;if(o.buffered=[],a&&a.length){for(e=0,n=a.length;n>e;e++)o.buffered.push({start:a.start(e)*Ye,end:a.end(e)*Ye});i=(a.end(0)-a.start(0))*Ye,r=Math.min(1,i/(t.target.duration*Ye))}isNaN(r)||(o._whileloading(r,s,o._get_html5_duration()),r&&s&&r===s&&le.canplaythrough.call(this,t))}),ratechange:a(function(){}),suspend:a(function(t){var e=this._s;le.progress.call(this,t),e._onsuspend()}),stalled:a(function(){}),timeupdate:a(function(){this._s._onTimer()}),waiting:a(function(){var t=this._s;t._onbufferchange(1)})},Q=function(t){var e;return e=t&&(t.type||t.url||t.serverURL)?t.serverURL||t.type&&i(t.type)?!1:t.type?Z({type:t.type}):Z({url:t.url})||pe.html5Only||t.url.match(/data\:/i):!1},ee=function(t){var e;return t&&(e=Fe?Je:pe.html5.canPlayType("audio/wav")?Ge:Je,t.src=e,void 0!==t._called_unload&&(t._called_load=!1)),Ee&&(ae=null),e},Z=function(t){if(!pe.useHTML5Audio||!pe.hasHTML5)return!1;var n,o,a,r,s=t.url||null,u=t.type||null,l=pe.audioFormats;if(u&&pe.html5[u]!==e)return pe.html5[u]&&!i(u);if(!te){te=[];for(r in l)l.hasOwnProperty(r)&&(te.push(r),l[r].related&&(te=te.concat(l[r].related)));te=new RegExp("\\.("+te.join("|")+")(\\?.*)?$","i")}return a=s?s.toLowerCase().match(te):null,a&&a.length?a=a[1]:u?(o=u.indexOf(";"),a=(-1!==o?u.substr(0,o):u).substr(6)):n=!1,a&&pe.html5[a]!==e?n=pe.html5[a]&&!i(a):(u="audio/"+a,n=pe.html5.canPlayType({type:u}),pe.html5[a]=n,n=n&&pe.html5[u]&&!i(u)),n},oe=function(){function t(t){var e,n,o=!1,i=!1;if(!r||"function"!=typeof r.canPlayType)return o;if(t instanceof Array){for(a=0,n=t.length;n>a;a++)(pe.html5[t[a]]||r.canPlayType(t[a]).match(pe.html5Test))&&(i=!0,pe.html5[t[a]]=!0,pe.flash[t[a]]=!!t[a].match(ze));o=i}else e=r&&"function"==typeof r.canPlayType?r.canPlayType(t):!1,o=!(!e||!e.match(pe.html5Test));return o}if(!pe.useHTML5Audio||!pe.hasHTML5)return pe.html5.usingFlash=!0,Ie=!0,!1;var n,o,i,a,r=Audio!==e?Be&&opera.version()<10?new Audio(null):new Audio:null,s={};i=pe.audioFormats;for(n in i)if(i.hasOwnProperty(n)&&(o="audio/"+n,s[n]=t(i[n].type),s[o]=s[n],n.match(ze)?(pe.flash[n]=!0,pe.flash[o]=!0):(pe.flash[n]=!1,pe.flash[o]=!1),i[n]&&i[n].related))for(a=i[n].related.length-1;a>=0;a--)s["audio/"+i[n].related[a]]=s[n],pe.html5[i[n].related[a]]=s[n],pe.flash[i[n].related[a]]=s[n];return s.canPlayType=r?t:null,pe.html5=p(pe.html5,s),pe.html5.usingFlash=G(),Ie=pe.html5.usingFlash,!0},S={},H=function(){},B=function(t){return 8===d&&t.loops>1&&t.stream&&(t.stream=!1),t},R=function(t){return t&&!t.usePolicyFile&&(t.onid3||t.usePeakData||t.useWaveformData||t.useEQData)&&(t.usePolicyFile=!0),t},N=function(){},u=function(){return!1},E=function(t){var e;for(e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=u);e=null},D=function(t){t===e&&(t=!1),(ke||t)&&pe.disable(t)},U=function(t){var e,n=null;if(t)if(t.match(/\.swf(\?.*)?$/i)){if(n=t.substr(t.toLowerCase().lastIndexOf(".swf?")+4))return t}else t.lastIndexOf("/")!==t.length-1&&(t+="/");return e=(t&&-1!==t.lastIndexOf("/")?t.substr(0,t.lastIndexOf("/")+1):"./")+pe.movieURL,pe.noSWFCache&&(e+="?ts="+(new Date).getTime()),e},T=function(){d=parseInt(pe.flashVersion,10),8!==d&&9!==d&&(pe.flashVersion=d=Ae);var t=pe.debugMode||pe.debugFlash?"_debug.swf":".swf";pe.useHTML5Audio&&!pe.html5Only&&pe.audioFormats.mp4.required&&9>d&&(pe.flashVersion=d=9),pe.version=pe.versionNumber+(pe.html5Only?" (HTML5-only mode)":9===d?" (AS3/Flash 9)":" (AS2/Flash 8)"),d>8?(pe.defaultOptions=p(pe.defaultOptions,pe.flash9Options),pe.features.buffering=!0,pe.defaultOptions=p(pe.defaultOptions,pe.movieStarOptions),pe.filePatterns.flash9=new RegExp("\\.(mp3|"+en.join("|")+")(\\?.*)?$","i"),pe.features.movieStar=!0):pe.features.movieStar=!1,pe.filePattern=pe.filePatterns[8!==d?"flash9":"flash8"],pe.movieURL=(8===d?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",t),pe.features.peakData=pe.features.waveformData=pe.features.eqData=d>8},I=function(t,e){return me?void me._setPolling(t,e):!1},L=function(){},j=this.getSoundById,W=function(){var t=[];return pe.debugMode&&t.push(F.sm2Debug),pe.debugFlash&&t.push(F.flashDebug),pe.useHighPerformance&&t.push(F.highPerf),t.join(" ")},$=function(){var t=(H("fbHandler"),pe.getMoviePercent()),e=F,n={type:"FLASHBLOCK"};return pe.html5Only?!1:void(pe.ok()?pe.oMC&&(pe.oMC.className=[W(),e.swfDefault,e.swfLoaded+(pe.didFlashBlock?" "+e.swfUnblocked:"")].join(" ")):(Ie&&(pe.oMC.className=W()+" "+e.swfDefault+" "+(null===t?e.swfTimedout:e.swfError)),pe.didFlashBlock=!0,_({type:"ontimeout",ignoreInit:!0,error:n}),K(n)))},g=function(t,n,o){ye[t]===e&&(ye[t]=[]),ye[t].push({method:n,scope:o||null,fired:!1})},_=function(t){if(t||(t={type:pe.ok()?"onready":"ontimeout"}),!Te&&t&&!t.ignoreInit)return!1;if("ontimeout"===t.type&&(pe.ok()||ke&&!t.ignoreInit))return!1;var e,n,o={success:t&&t.ignoreInit?pe.ok():!ke},i=t&&t.type?ye[t.type]||[]:[],a=[],r=[o],s=Ie&&!pe.ok();for(t.error&&(r[0].error=t.error),e=0,n=i.length;n>e;e++)i[e].fired!==!0&&a.push(i[e]);if(a.length)for(e=0,n=a.length;n>e;e++)a[e].scope?a[e].method.apply(a[e].scope,r):a[e].method.apply(this,r),s||(a[e].fired=!0);return!0},v=function(){t.setTimeout(function(){pe.useFlashBlock&&$(),_(),"function"==typeof pe.onload&&pe.onload.apply(t),pe.waitForWindowLoad&&ie.add(t,"load",v)},1)},se=function(){if(re!==e)return re;var n,o,i,a=!1,r=navigator,s=r.plugins,u=t.ActiveXObject;if(s&&s.length)o="application/x-shockwave-flash",i=r.mimeTypes,i&&i[o]&&i[o].enabledPlugin&&i[o].enabledPlugin.description&&(a=!0);else if(u!==e&&!ge.match(/MSAppHost/i)){try{n=new u("ShockwaveFlash.ShockwaveFlash")}catch(l){n=null}a=!!n,n=null}return re=a,a},G=function(){var t,e,n=pe.audioFormats,o=Ue&&!!ge.match(/os (1|2|3_0|3_1)\s/i);if(o?(pe.hasHTML5=!1,pe.html5Only=!0,pe.oMC&&(pe.oMC.style.display="none")):pe.useHTML5Audio&&(pe.html5&&pe.html5.canPlayType||(pe.hasHTML5=!1)),pe.useHTML5Audio&&pe.hasHTML5){J=!0;for(e in n)n.hasOwnProperty(e)&&n[e].required&&(pe.html5.canPlayType(n[e].type)?pe.preferFlash&&(pe.flash[e]||pe.flash[n[e].type])&&(t=!0):(J=!1,t=!0))}return pe.ignoreFlash&&(t=!1,J=!0),pe.html5Only=pe.hasHTML5&&pe.useHTML5Audio&&!t,!pe.html5Only},Y=function(t){var e,n,o,i=0;if(t instanceof Array){for(e=0,n=t.length;n>e;e++)if(t[e]instanceof Object){if(pe.canPlayMIME(t[e].type)){i=e;break}}else if(pe.canPlayURL(t[e])){i=e;break}t[i].url&&(t[i]=t[i].url),o=t[i]}else o=t;return o},q=function(t){t._hasTimer||(t._hasTimer=!0,!Re&&pe.html5PollingInterval&&(null===Pe&&0===Me&&(Pe=setInterval(z,pe.html5PollingInterval)),Me++))},X=function(t){t._hasTimer&&(t._hasTimer=!1,!Re&&pe.html5PollingInterval&&Me--)},z=function(){var t;if(null!==Pe&&!Me)return clearInterval(Pe),Pe=null,!1;for(t=pe.soundIDs.length-1;t>=0;t--)pe.sounds[pe.soundIDs[t]].isHTML5&&pe.sounds[pe.soundIDs[t]]._hasTimer&&pe.sounds[pe.soundIDs[t]]._onTimer()},K=function(n){n=n!==e?n:{},"function"==typeof pe.onerror&&pe.onerror.apply(t,[{type:n.type!==e?n.type:null}]),n.fatal!==e&&n.fatal&&pe.disable()},ue=function(){if(!Ne||!se())return!1;var t,e,n=pe.audioFormats;for(e in n)if(n.hasOwnProperty(e)&&("mp3"===e||"mp4"===e)&&(pe.html5[e]=!1,n[e]&&n[e].related))for(t=n[e].related.length-1;t>=0;t--)pe.html5[n[e].related[t]]=!1},this._setSandboxType=function(){},this._externalInterfaceOK=function(){if(pe.swfLoaded)return!1;pe.swfLoaded=!0,qe=!1,Ne&&ue(),setTimeout(c,$e?100:1)},P=function(t,n){function o(){}function i(t,e){return'<param name="'+t+'" value="'+e+'" />'}if(be&&we)return!1;if(pe.html5Only)return T(),o(),pe.oMC=s(pe.movieID),c(),be=!0,we=!0,!1;var a,r,u,l,d,f,p,h,m=n||pe.url,g=pe.altURL||m,_="JS/Flash audio component (SoundManager 2)",v=M(),y=W(),b=null,w=ve.getElementsByTagName("html")[0];if(b=w&&w.dir&&w.dir.match(/rtl/i),t=t===e?pe.id:t,T(),pe.url=U(Qe?m:g),n=pe.url,pe.wmode=!pe.wmode&&pe.useHighPerformance?"transparent":pe.wmode,null!==pe.wmode&&(ge.match(/msie 8/i)||!$e&&!pe.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Ke.push(S.spcWmode),pe.wmode=null),a={name:t,id:t,src:n,quality:"high",allowScriptAccess:pe.allowScriptAccess,bgcolor:pe.bgColor,pluginspage:Ze+"www.macromedia.com/go/getflashplayer",title:_,type:"application/x-shockwave-flash",wmode:pe.wmode,hasPriority:"true"},pe.debugFlash&&(a.FlashVars="debug=1"),pe.wmode||delete a.wmode,$e)r=ve.createElement("div"),l=['<object id="'+t+'" data="'+n+'" type="'+a.type+'" title="'+a.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Ze+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',i("movie",n),i("AllowScriptAccess",pe.allowScriptAccess),i("quality",a.quality),pe.wmode?i("wmode",pe.wmode):"",i("bgcolor",pe.bgColor),i("hasPriority","true"),pe.debugFlash?i("FlashVars",a.FlashVars):"","</object>"].join("");else{r=ve.createElement("embed");for(u in a)a.hasOwnProperty(u)&&r.setAttribute(u,a[u])}if(L(),y=W(),v=M())if(pe.oMC=s(pe.movieID)||ve.createElement("div"),pe.oMC.id)h=pe.oMC.className,pe.oMC.className=(h?h+" ":F.swfDefault)+(y?" "+y:""),pe.oMC.appendChild(r),$e&&(d=pe.oMC.appendChild(ve.createElement("div")),d.className=F.swfBox,d.innerHTML=l),we=!0;else{if(pe.oMC.id=pe.movieID,pe.oMC.className=F.swfDefault+" "+y,f=null,d=null,pe.useFlashBlock||(pe.useHighPerformance?f={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(f={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},b&&(f.left=Math.abs(parseInt(f.left,10))+"px"))),We&&(pe.oMC.style.zIndex=1e4),!pe.debugFlash)for(p in f)f.hasOwnProperty(p)&&(pe.oMC.style[p]=f[p]);try{$e||pe.oMC.appendChild(r),v.appendChild(pe.oMC),$e&&(d=pe.oMC.appendChild(ve.createElement("div")),d.className=F.swfBox,d.innerHTML=l),we=!0}catch(k){throw new Error(H("domError")+" \n"+k.toString())}}return be=!0,o(),!0},A=function(){return pe.html5Only?(P(),!1):me?!1:pe.url?(me=pe.getMovie(pe.id),me||(Oe?($e?pe.oMC.innerHTML=xe:pe.oMC.appendChild(Oe),Oe=null,be=!0):P(pe.id,pe.url),me=pe.getMovie(pe.id)),"function"==typeof pe.oninitmovie&&setTimeout(pe.oninitmovie,1),!0):!1},y=function(){setTimeout(b,1e3)},w=function(){t.setTimeout(function(){pe.setup({preferFlash:!1}).reboot(),pe.didFlashBlock=!0,pe.beginDelayedInit()},1)},b=function(){var e,n=!1;return pe.url?Ve?!1:(Ve=!0,ie.remove(t,"load",y),re&&qe&&!je?!1:(Te||(e=pe.getMoviePercent(),e>0&&100>e&&(n=!0)),void setTimeout(function(){return e=pe.getMoviePercent(),n?(Ve=!1,t.setTimeout(y,1),!1):void(!Te&&Xe&&(null===e?pe.useFlashBlock||0===pe.flashLoadTimeout?pe.useFlashBlock&&$():!pe.useFlashBlock&&J?w():_({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}}):0===pe.flashLoadTimeout||(!pe.useFlashBlock&&J?w():D(!0))))
},pe.flashLoadTimeout))):!1},k=function(){function e(){ie.remove(t,"focus",k)}return je||!qe?(e(),!0):(Xe=!0,je=!0,Ve=!1,y(),e(),!0)},de=function(){},ce=function(){},f=function(e){if(Te)return!1;if(pe.html5Only)return Te=!0,v(),!0;var n,o=pe.useFlashBlock&&pe.flashLoadTimeout&&!pe.getMoviePercent(),i=!0;return o||(Te=!0),n={type:!re&&Ie?"NO_FLASH":"INIT_TIMEOUT"},(ke||e)&&(pe.useFlashBlock&&pe.oMC&&(pe.oMC.className=W()+" "+(null===pe.getMoviePercent()?F.swfTimedout:F.swfError)),_({type:"ontimeout",error:n,ignoreInit:!0}),K(n),i=!1),ke||(pe.waitForWindowLoad&&!Se?ie.add(t,"load",v):v()),i},l=function(){var t,n=pe.setupOptions;for(t in n)n.hasOwnProperty(t)&&(pe[t]===e?pe[t]=n[t]:pe[t]!==n[t]&&(pe.setupOptions[t]=pe[t]))},c=function(){function e(){ie.remove(t,"load",pe.beginDelayedInit)}if(Te)return!1;if(pe.html5Only)return Te||(e(),pe.enabled=!0,f()),!0;A();try{me._externalInterfaceTest(!1),I(!0,pe.flashPollingInterval||(pe.useHighPerformance?10:50)),pe.debugMode||me._disableDebug(),pe.enabled=!0,pe.html5Only||ie.add(t,"unload",u)}catch(n){return K({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),D(!0),f(),!1}return f(),e(),!0},x=function(){return C?!1:(C=!0,l(),L(),!re&&pe.hasHTML5&&pe.setup({useHTML5Audio:!0,preferFlash:!1}),oe(),!re&&Ie&&(Ke.push(S.needFlash),pe.setup({flashLoadTimeout:1})),ve.removeEventListener&&ve.removeEventListener("DOMContentLoaded",x,!1),A(),!0)},ne=function(){return"complete"===ve.readyState&&(x(),ve.detachEvent("onreadystatechange",ne)),!0},V=function(){Se=!0,x(),ie.remove(t,"load",V)},O=function(){Re&&(pe.setupOptions.useHTML5Audio=!0,pe.setupOptions.preferFlash=!1,(Ue||He&&!ge.match(/android\s2\.3/i))&&(Ue&&(pe.ignoreFlash=!0),Ee=!0))},O(),se(),ie.add(t,"focus",k),ie.add(t,"load",y),ie.add(t,"load",V),ve.addEventListener?ve.addEventListener("DOMContentLoaded",x,!1):ve.attachEvent?ve.attachEvent("onreadystatechange",ne):K({type:"NO_DOM2_EVENTS",fatal:!0})}if(!t||!t.document)throw new Error("SoundManager requires a browser with window and document objects.");var o=null;void 0!==t.SM2_DEFER&&SM2_DEFER||(o=new n),"object"==typeof module&&module&&"object"==typeof module.exports?(t.soundManager=o,module.exports.SoundManager=n,module.exports.soundManager=o):"function"==typeof define&&define.amd?define("SoundManager",[],function(){return{SoundManager:n,soundManager:o}}):(t.SoundManager=n,t.soundManager=o)}(window),function(t){function e(){var t="";for(i=0;5>i;i++)t+=Math.ceil(15*Math.random()).toString(16);return t}function n(t,e,o,i,a){t[e]?o.apply(i):(a=a||0,1e3>a&&setTimeout(function(){n(t,e,o,i,a+1)},0))}function o(e){setTimeout(function(){var o=document.createElement("script");o.type="text/javascript",o.src=e||t.fastXDM.helperUrl,n(document,"body",function(){document.getElementsByTagName("HEAD")[0].appendChild(o)})},0)}function a(t,e){switch(typeof t){case"string":return e?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t.replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");case"object":if("[object Array]"===Object.prototype.toString.apply(t)){newValue=[];for(var n=0;n<t.length;n++)newValue[n]=a(t[n],e)}else for(var o in t)newValue={},Object.hasOwnProperty.call(t,o)&&(newValue[o]=a(t[o],e));default:newValue=t}return newValue}function r(t,e){f.loaded?t.apply(e,[f]):d.push([e,t])}function s(){f.loaded=!0;for(var t=d.length;t--;)d[t][1].apply(d[t][0],[f])}function u(t,e){r(function(n){var o=n.json.parse(t);if(o[0]){o[1]||(o[1]=[]);for(var i=o[1].length;i--;)if(o[1][i]._func){var r=o[1][i]._func;o[1][i]=function(){var t=Array.prototype.slice.call(arguments);t.unshift("_func"+r),e.callMethod.apply(e,t)}}else e.options.safe&&(o[1][i]=a(o[1][i],!0));setTimeout(function(){if(!e.methods[o[0]])throw Error("fastXDM: Method "+o[0]+" is undefined");e.methods[o[0]].apply(e,o[1])},0)}})}function l(t,e){for(var n in e)t[n]&&"object"==typeof t[n]?l(t[n],e[n]):t[n]=e[n]}if(!t.fastXDM){var c={},d=[],f={};t.fastXDM={_id:0,helperUrl:("https:"===location.protocol?"https:":"http:")+"//vk.com/js/api/xdmHelper.js",Server:function(n,o,i){this.methods=n||{},this.id=t.fastXDM._id++,this.options=i||{},this.filter=o,this.key=e(),this.methods["%init%"]=this.methods.__fxdm_i=function(){t.fastXDM.run(this.id),this.methods.onInit&&this.methods.onInit()},this.frameName="fXD"+this.key,this.server=!0,c[this.key]=[u,this]},Client:function(e,n){if(this.methods=e||{},this.id=t.fastXDM._id++,this.options=n||{},t.fastXDM.run(this.id),0!==window.name.indexOf("fXD"))throw Error("Wrong window.name property.");this.key=window.name.substr(3),this.caller=window.parent,c[this.key]=[u,this],this.client=!0,t.fastXDM.on("helper",function(){t.fastXDM.onClientStart(this)},this),r(function(t){t.send(this,t.json.stringify(["%init%"]));var e=this.methods;setTimeout(function(){e.onInit&&e.onInit()},0)},this)},onMessage:function(t){if(!t.data)return!1;var e=t.data.substr(0,5);if(c[e]){var n=c[e][1];!n||n.filter&&!n.filter(t.origin)||c[e][0](t.data.substr(6),n)}},setJSON:function(t){f.json=t},getJSON:function(t){return t?void r(function(e){t(e.json)}):f.json},setEnv:function(t){var e;for(e in t)f[e]=t[e];s()},_q:{},on:function(t,e,n){this._q[t]||(this._q[t]=[]),-1==this._q[t]?e.apply(n):this._q[t].push([e,n])},run:function(t){var e=(this._q[t]||[]).length;if(this._q[t]&&e>0)for(var n=0;e>n;n++)this._q[t][n][0].apply(this._q[t][n][1]);this._q[t]=-1},waitFor:n},t.fastXDM.Server.prototype.start=function(e,n){if(e.contentWindow)this.caller=e.contentWindow,this.frame=e,t.fastXDM.on("helper",function(){t.fastXDM.onServerStart(this)},this);else{var o=this;n=n||0,50>n&&setTimeout(function(){o.start.apply(o,[e,n+1])},100)}},t.fastXDM.Server.prototype.destroy=function(){c.splice(c.indexOf(this.key),1)},t.fastXDM.Server.prototype.append=function(t,e){var n=document.createElement("DIV");n.innerHTML='<iframe name="'+this.frameName+'" ></iframe>';var o=n.firstChild,i=this;return setTimeout(function(){o.frameBorder="0",e&&l(o,e),t.insertBefore(o,t.firstChild),i.start(o)},0),o},t.fastXDM.Client.prototype.callMethod=t.fastXDM.Server.prototype.callMethod=function(){for(var e=Array.prototype.slice.call(arguments),o=e.shift(),i=e.length;i--;)if("function"==typeof e[i]){this.funcsCount=(this.funcsCount||0)+1;var s=e[i],u="_func"+this.funcsCount;this.methods[u]=function(){s.apply(this,arguments),delete this.methods[u]},e[i]={_func:this.funcsCount}}else this.options.safe&&(e[i]=a(e[i],!1));n(this,"caller",function(){t.fastXDM.on(this.id,function(){r(function(t){t.send(this,t.json.stringify([o,e]))},this)},this)},this)},t.JSON&&"object"==typeof t.JSON&&t.JSON.parse&&t.JSON.stringify&&'{"a":[1,2,3]}'==t.JSON.stringify({a:[1,2,3]}).replace(/ /g,"")?f.json={parse:t.JSON.parse,stringify:t.JSON.stringify}:t.fastXDM._needJSON=!0,t.postMessage?(f.protocol="p",f.send=function(t,e){var n=t.frame?t.frame.contentWindow:t.caller;n.postMessage(t.key+":"+e,"*")},t.addEventListener?t.addEventListener("message",t.fastXDM.onMessage,!1):t.attachEvent("onmessage",t.fastXDM.onMessage),t.fastXDM._needJSON?(t.fastXDM._onlyJSON=!0,o()):s()):o()}}(window),window.VK||(window.VK={}),VK.MD5||(VK.MD5=function(t){var e=function(t,e){var n=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(n>>16);return o<<16|65535&n},n=function(t,e){return t<<e|t>>>32-e},o=function(t,o,i,a,r,s){return e(n(e(e(o,t),e(a,s)),r),i)},i=function(t,e,n,i,a,r,s){return o(e&n|~e&i,t,e,a,r,s)},a=function(t,e,n,i,a,r,s){return o(e&i|n&~i,t,e,a,r,s)},r=function(t,e,n,i,a,r,s){return o(e^n^i,t,e,a,r,s)},s=function(t,e,n,i,a,r,s){return o(n^(e|~i),t,e,a,r,s)},u=function(t,n){var o,u,l,c,d=1732584193,f=-271733879,p=-1732584194,h=271733878;t[n>>5]|=128<<n%32,t[(n+64>>>9<<4)+14]=n;for(var m=0,g=t.length;g>m;m+=16)o=d,u=f,l=p,c=h,d=i(d,f,p,h,t[m+0],7,-680876936),h=i(h,d,f,p,t[m+1],12,-389564586),p=i(p,h,d,f,t[m+2],17,606105819),f=i(f,p,h,d,t[m+3],22,-1044525330),d=i(d,f,p,h,t[m+4],7,-176418897),h=i(h,d,f,p,t[m+5],12,1200080426),p=i(p,h,d,f,t[m+6],17,-1473231341),f=i(f,p,h,d,t[m+7],22,-45705983),d=i(d,f,p,h,t[m+8],7,1770035416),h=i(h,d,f,p,t[m+9],12,-1958414417),p=i(p,h,d,f,t[m+10],17,-42063),f=i(f,p,h,d,t[m+11],22,-1990404162),d=i(d,f,p,h,t[m+12],7,1804603682),h=i(h,d,f,p,t[m+13],12,-40341101),p=i(p,h,d,f,t[m+14],17,-1502002290),f=i(f,p,h,d,t[m+15],22,1236535329),d=a(d,f,p,h,t[m+1],5,-165796510),h=a(h,d,f,p,t[m+6],9,-1069501632),p=a(p,h,d,f,t[m+11],14,643717713),f=a(f,p,h,d,t[m+0],20,-373897302),d=a(d,f,p,h,t[m+5],5,-701558691),h=a(h,d,f,p,t[m+10],9,38016083),p=a(p,h,d,f,t[m+15],14,-660478335),f=a(f,p,h,d,t[m+4],20,-405537848),d=a(d,f,p,h,t[m+9],5,568446438),h=a(h,d,f,p,t[m+14],9,-1019803690),p=a(p,h,d,f,t[m+3],14,-187363961),f=a(f,p,h,d,t[m+8],20,1163531501),d=a(d,f,p,h,t[m+13],5,-1444681467),h=a(h,d,f,p,t[m+2],9,-51403784),p=a(p,h,d,f,t[m+7],14,1735328473),f=a(f,p,h,d,t[m+12],20,-1926607734),d=r(d,f,p,h,t[m+5],4,-378558),h=r(h,d,f,p,t[m+8],11,-2022574463),p=r(p,h,d,f,t[m+11],16,1839030562),f=r(f,p,h,d,t[m+14],23,-35309556),d=r(d,f,p,h,t[m+1],4,-1530992060),h=r(h,d,f,p,t[m+4],11,1272893353),p=r(p,h,d,f,t[m+7],16,-155497632),f=r(f,p,h,d,t[m+10],23,-1094730640),d=r(d,f,p,h,t[m+13],4,681279174),h=r(h,d,f,p,t[m+0],11,-358537222),p=r(p,h,d,f,t[m+3],16,-722521979),f=r(f,p,h,d,t[m+6],23,76029189),d=r(d,f,p,h,t[m+9],4,-640364487),h=r(h,d,f,p,t[m+12],11,-421815835),p=r(p,h,d,f,t[m+15],16,530742520),f=r(f,p,h,d,t[m+2],23,-995338651),d=s(d,f,p,h,t[m+0],6,-198630844),h=s(h,d,f,p,t[m+7],10,1126891415),p=s(p,h,d,f,t[m+14],15,-1416354905),f=s(f,p,h,d,t[m+5],21,-57434055),d=s(d,f,p,h,t[m+12],6,1700485571),h=s(h,d,f,p,t[m+3],10,-1894986606),p=s(p,h,d,f,t[m+10],15,-1051523),f=s(f,p,h,d,t[m+1],21,-2054922799),d=s(d,f,p,h,t[m+8],6,1873313359),h=s(h,d,f,p,t[m+15],10,-30611744),p=s(p,h,d,f,t[m+6],15,-1560198380),f=s(f,p,h,d,t[m+13],21,1309151649),d=s(d,f,p,h,t[m+4],6,-145523070),h=s(h,d,f,p,t[m+11],10,-1120210379),p=s(p,h,d,f,t[m+2],15,718787259),f=s(f,p,h,d,t[m+9],21,-343485551),d=e(d,o),f=e(f,u),p=e(p,l),h=e(h,c);return[d,f,p,h]},l=function(t){for(var e,n,o="",i=-1,a=t.length;++i<a;)e=t.charCodeAt(i),n=a>i+1?t.charCodeAt(i+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),i++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},c=function(t){var e,n,o=Array(t.length>>2);for(e=0,n=o.length;n>e;e++)o[e]=0;for(e=0,n=8*t.length;n>e;e+=8)o[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return o},d=function(t){for(var e="",n=0,o=32*t.length;o>n;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},f=function(t){return d(u(c(t),8*t.length))},p=function(t){for(var e,n="0123456789abcdef",o="",i=0,a=t.length;a>i;i++)e=t.charCodeAt(i),o+=n.charAt(e>>>4&15)+n.charAt(15&e);return o};return p(f(l(t)))}),VK.extend=function(t,e,n){for(var o in e)(n||"undefined"==typeof t[o])&&(t[o]=e[o]);return t},"https:"!==VK._protocol&&(VK._protocol="https:"===location.protocol?"https:":"http:"),VK.xdConnectionCallbacks?(setTimeout(function(){for(var t;t=VK.xdConnectionCallbacks.pop();)t()},0),VK.Widgets&&!VK.Widgets._constructor&&(VK.Widgets=!1)):(VK.extend(VK,{version:1,_apiId:null,_session:null,_userStatus:"unknown",_domain:{main:"https://oauth.vk.com/",api:"https://api.vk.com/"},_path:{login:"authorize",proxy:"fxdm_oauth_proxy.html"},_rootId:"vk_api_transport",_nameTransportPath:"",xdReady:!1,access:{FRIENDS:2,PHOTOS:4,AUDIO:8,VIDEO:16,MATCHES:32,QUESTIONS:64,WIKI:128}}),VK.init=function(t){var e,n;if(VK._apiId=null,!t.apiId)throw Error("VK.init() called without an apiId");if(VK._apiId=t.apiId,t.onlyWidgets)return!0;t.nameTransportPath&&""!==t.nameTransportPath&&(VK._nameTransportPath=t.nameTransportPath),n=document.getElementById(VK._rootId),n||(n=document.createElement("div"),n.id=VK._rootId,e=document.getElementsByTagName("body")[0],e.insertBefore(n,e.childNodes[0])),n.style.position="absolute",n.style.top="-10000px";var o=VK.Cookie.load();o&&(VK.Auth._loadState="loaded",VK.Auth.setSession(o,o?"connected":"unknown"))},VK.Cookie||(VK.Cookie={_domain:null,load:function(){var t,e=document.cookie.match("\\bvk_app_"+VK._apiId+"=([^;]*)\\b");if(e){if(t=this.decode(e[1]),"oauth"!=t.secret)return!1;t.expire=parseInt(t.expire,10),VK.Cookie._domain="."+window.location.hostname}return t},setRaw:function(t,e,n,o){var i;i="vk_app_"+VK._apiId+"="+t;var a=o?(new Date).getTime()+1e3*o:1e3*e;i+=t&&0===e?"":"; expires="+new Date(a).toGMTString(),i+="; path=/",i+=n?"; domain=."+n:"",document.cookie=i,this._domain=n},set:function(t,e){t?this.setRaw(this.encode(t),t.expire,window.location.hostname,(e||{}).time):this.clear()},clear:function(){this.setRaw("",0,this._domain,0)},encode:function(t){var e,n=[];for(e in t)"user"!=e&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.sort(),n.join("&")},decode:function(t){var e,n,o={},i=t.split("&");for(e=0;e<i.length;e++)n=i[e].split("=",2),n&&n[0]&&(o[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return o}}),VK.Api||(VK.Api={_headId:null,_callbacks:{},ie6_7:function(){return VK.Api.ieTested||(VK.Api.isIE6_7=navigator.userAgent.match(/MSIE [6|7]/i),VK.Api.ieTested=!0),VK.Api.isIE6_7},attachScript:function(t){VK.Api._headId||(VK.Api._headId=document.getElementsByTagName("head")[0]);var e=document.createElement("script");e.type="text/javascript",e.setAttribute("encoding","UTF-8"),e.src=t,VK.Api._headId.appendChild(e)},checkMethod:function(t,e,n,o){var i=t.toLowerCase();if("wall.post"==i||"activity.set"==i){var a="activity.set"==i?e.text:e.message,r=VK._protocol+"//vk.com/al_apps.php?act=wall_post_box&widget=1&method="+i+"&aid="+parseInt(VK._apiId,10)+"&text="+encodeURIComponent(a);"wall.post"==i&&(r+="&owner_id="+parseInt(e.owner_id||0,10)+"&attachments="+(e.attachments||e.attachment||""));var s="_"+Math.random().toString(16).substr(2);r+="&method_access="+s;var u=(VK.UI.popup({url:r,width:460,height:249}),setInterval(function(){VK.UI.active.closed&&(clearInterval(u),e.method_access=s,VK.Api.call(t,e,n,o))},500));return!1}return!0},call:function(t,e,n,o){var i,a,r=e||{};if("object"!=typeof r||"function"!=typeof n)return!1;if(e.method_access||e.method_force||VK.Api.checkMethod(t,e,n,o)){if(o||(o=0),"loaded"!=VK.Auth._loadState){var s=function(o){o&&o.session&&(VK.Observer.unsubscribe("auth.loginStatus",s),VK.Api.call(t,e,n))};return VK.Observer.subscribe("auth.loginStatus",s),void VK.Auth.getLoginStatus()}if(VK.Api.queryLength(r)<1500&&!VK.Api.ie6_7()){for(var u=!1,l=parseInt(1e7*Math.random(),10);VK.Api._callbacks[l];)l=parseInt(1e7*Math.random(),10);r.callback="VK.Api._callbacks["+l+"]"}else var u=!0;VK._session&&VK._session.sid&&(r.access_token=VK._session.sid),i=VK.Cookie.encode(r),a=function(i){if(!i.error||3!=i.error.error_code&&4!=i.error.error_code&&5!=i.error.error_code)n(i);else{if(o>3)return!1;var a=function(i){VK.Observer.unsubscribe("auth.sessionChange",a),delete e.access_token,i.session&&VK.Api.call(t,e,n,o+1)};VK.Observer.subscribe("auth.sessionChange",a),VK.Auth.getLoginStatus()}u||delete VK.Api._callbacks[l]},u?VK.xdReady?VK.XDM.remote.callMethod("apiCall",t,i,a):(VK.Observer.subscribe("xdm.init",function(){VK.XDM.remote.callMethod("apiCall",t,i,a)}),VK.XDM.init()):(VK.Api._callbacks[l]=a,VK.Api.attachScript(VK._domain.api+"method/"+t+"?"+i))}},queryLength:function(t){var e,n=100;for(e in t)n+=e.length+encodeURIComponent(t.i).length+1;return n}},VK.api=function(t,e,n){VK.Api.call(t,e,n)}),VK.Auth||(VK.Auth={popup:null,lsCb:{},setSession:function(t,e,n,o){var i=!VK._session&&t,a=VK._session&&!t,r=VK._session&&t&&VK._session.mid!=t.mid,s=i||a||VK._session&&t&&VK._session.sid!=t.sid,u=e!=VK._userStatus,l={session:t,status:e,settings:n};return VK._session=t,VK._userStatus=e,VK.Cookie.set(t,o),(s||u||r)&&setTimeout(function(){u&&VK.Observer.publish("auth.statusChange",l),(a||r)&&VK.Observer.publish("auth.logout",l),(i||r)&&VK.Observer.publish("auth.login",l),s&&VK.Observer.publish("auth.sessionChange",l)},0),l},login:function(t,e){var n,o;if(!VK._apiId)return!1;n=window.location.protocol+"//"+window.location.hostname,o=VK._domain.main+VK._path.login+"?client_id="+VK._apiId+"&display=popup&redirect_uri=close.html&response_type=token",e&&parseInt(e,10)>0&&(o+="&scope="+e),VK.Observer.unsubscribe("auth.onLogin"),VK.Observer.subscribe("auth.onLogin",t),VK.UI.popup({width:620,height:370,url:o});var i=function(){VK.Auth.getLoginStatus(function(t){VK.Observer.publish("auth.onLogin",t),VK.Observer.unsubscribe("auth.onLogin")},!0)};VK.UI.popupOpened=!0;var a=function(){if(!VK.UI.popupOpened)return!1;try{if(!VK.UI.active.top||VK.UI.active.closed)return VK.UI.popupOpened=!1,i(),!0}catch(t){return VK.UI.popupOpened=!1,i(),!0}setTimeout(a,100)};setTimeout(a,100)},logout:function(t){VK.Auth.revokeGrants(t)},revokeGrants:function(t){var e=function(n){VK.Observer.unsubscribe("auth.statusChange",e),t&&t(n)};VK.Observer.subscribe("auth.statusChange",e),VK._session&&VK._session.sid&&VK.Api.attachScript("https://login.vk.com/?act=openapi&oauth=1&aid="+parseInt(VK._apiId,10)+"&location="+encodeURIComponent(window.location.hostname)+"&do_logout=1&token="+VK._session.sid),VK.Cookie.clear()},getSession:function(){return VK._session},getLoginStatus:function(t,e){if(VK._apiId){if(t){if(!e&&"loaded"==VK.Auth._loadState)return void t({status:VK._userStatus,session:VK._session});VK.Observer.subscribe("auth.loginStatus",t)}if(e||"loading"!=VK.Auth._loadState){VK.Auth._loadState="loading";for(var n=parseInt(1e7*Math.random(),10);VK.Auth.lsCb[n];)n=parseInt(1e7*Math.random(),10);VK.Auth.lsCb[n]=function(t){if(delete VK.Auth.lsCb[n],VK.Auth._loadState="loaded",t&&t.auth){var o={mid:t.user.id,sid:t.access_token,sig:t.sig,secret:t.secret,expire:t.expire};e&&(o.user=t.user);var i="connected"}else{var o=null,i=t.user?"logined":"unknown";VK.Cookie.clear()}VK.Auth.setSession(o,i,!1,t),VK.Observer.publish("auth.loginStatus",{session:o,status:i}),VK.Observer.unsubscribe("auth.loginStatus")},VK.Api.attachScript("https://login.vk.com/?act=openapi&oauth=1&aid="+parseInt(VK._apiId,10)+"&location="+encodeURIComponent(window.location.hostname)+"&rnd="+n)}}}})),VK.UI||(VK.UI={active:null,_buttons:[],popup:function(t){var e="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,n="undefined"!=typeof window.screenY?window.screenY:window.screenTop,o="undefined"!=typeof window.outerWidth?window.outerWidth:document.body.clientWidth,i="undefined"!=typeof window.outerHeight?window.outerHeight:document.body.clientHeight-22,a=t.width,r=t.height,s=parseInt(e+(o-a)/2,10),u=parseInt(n+(i-r)/2.5,10),l="width="+a+",height="+r+",left="+s+",top="+u;this.active=window.open(t.url,"vk_openapi",l)},button:function(t){var e="";"string"==typeof t&&(t=document.getElementById(t)),this._buttons.push(t),index=this._buttons.length-1,e='<table cellspacing="0" cellpadding="0" id="openapi_UI_'+index+'" onmouseover="VK.UI._change(1, '+index+');" onmouseout="VK.UI._change(0, '+index+');" onmousedown="VK.UI._change(2, '+index+');" onmouseup="VK.UI._change(1, '+index+');" style="cursor: pointer; border: 0px; font-family: tahoma, arial, verdana, sans-serif, Lucida Sans; font-size: 10px;"><tr style="vertical-align: middle"><td><div style="border: 1px solid #3b6798;border-radius: 2px 0px 0px 2px;-moz-border-radius: 2px 0px 0px 2px;-webkit-border-radius: 2px 0px 0px 2px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 4px 0px 6px;line-height: 13px;">&#1042;&#1086;&#1081;&#1090;&#1080;</div></div></td><td><div style="background: url('+VK._protocol+'//vk.com/images/btns.png) 0px -42px no-repeat; width: 21px; height: 21px"></div></td><td><div style="border: 1px solid #3b6798;border-radius: 0px 2px 2px 0px;-moz-border-radius: 0px 2px 2px 0px;-webkit-border-radius: 0px 2px 2px 0px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 6px 0px 4px;line-height: 13px;">&#1050;&#1086;&#1085;&#1090;&#1072;&#1082;&#1090;&#1077;</div></div></td></tr></table>',t.innerHTML=e,t.style.width=t.childNodes[0].offsetWidth+"px"},_change:function(t,e){for(var n=document.getElementById("openapi_UI_"+e).rows[0],o=[n.cells[0].firstChild.firstChild,n.cells[2].firstChild.firstChild],i=0;2>i;++i){var a=o[i];0===t?(a.style.backgroundColor="#6D8DB1",a.style.borderTopColor="#7E9CBC",a.style.borderLeftColor=a.style.borderRightColor=a.style.borderBottomColor="#5C82AB"):1==t?(a.style.backgroundColor="#7693B6",a.style.borderTopColor="#88A4C4",a.style.borderLeftColor=a.style.borderRightColor=a.style.borderBottomColor="#6088B4"):2==t&&(a.style.backgroundColor="#6688AD",a.style.borderBottomColor="#7495B8",a.style.borderLeftColor=a.style.borderRightColor=a.style.borderTopColor="#51779F")}0===t||2==t?n.cells[2].firstChild.style.backgroundPosition="0px -42px":1==t&&(n.cells[2].firstChild.style.backgroundPosition="0px -63px")}}),VK.XDM||(VK.XDM={remote:null,init:function(){if(this.remote)return!1;var t=VK._domain.api+VK._path.proxy;this.remote=new fastXDM.Server({onInit:function(){VK.xdReady=!0,VK.Observer.publish("xdm.init")}}),this.remote.append(document.getElementById(VK._rootId),{src:t})},xdHandler:function(code){try{eval("VK."+code)}catch(e){}}}),VK.Observer||(VK.Observer={_subscribers:function(){return this._subscribersMap||(this._subscribersMap={}),this._subscribersMap},publish:function(t){var e,n,o=Array.prototype.slice.call(arguments),t=o.shift(),i=this._subscribers()[t];if(i)for(e=0,n=i.length;n>e;e++)null!=i[e]&&i[e].apply(this,o)},subscribe:function(t,e){var n=this._subscribers();return"function"!=typeof e?!1:void(n[t]?n[t].push(e):n[t]=[e])},unsubscribe:function(t,e){var n,o,i=this._subscribers()[t];if(!i)return!1;if("function"==typeof e)for(n=0,o=i.length;o>n;n++)i[n]==e&&(i[n]=null);else delete this._subscribers()[t]}}),VK.Widgets||(VK.Widgets={},VK.Widgets.count=0,VK.Widgets.RPC={},VK.Widgets.loading=function(t,e){t.style.background=e?'url("'+VK._protocol+'//vk.com/images/upload.gif") center center no-repeat transparent':"none"},VK.Widgets.Comments=function(t,e,n){var o=VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=e||{};var i,a,r={limit:e.limit||10,height:e.height||0,mini:void 0===e.mini?"auto":e.mini,norealtime:e.norealtime?1:0},s=function(){return a.callMethod("mouseUp"),!1},u=function(t){a.callMethod("mouseMove",{screenY:t.screenY})};if(e.browse)r.browse=1,r.replies=e.replies||0;else{var l=e.pageUrl||o.url;"/"==l.substr(0,1)&&(l=location.protocol+"//"+location.host+l),VK.extend(r,{page:n||0,status_publish:void 0===e.autoPublish?1:e.autoPublish,attach:void 0===e.attach?"*":e.attach?e.attach:"",url:l,title:e.pageTitle||o.title,description:e.pageDescription||o.description,image:e.pageImage||o.image})}return e.onChange&&(VK.Observer.subscribe("widgets.comments.new_comment",e.onChange),VK.Observer.subscribe("widgets.comments.delete_comment",e.onChange)),VK.Widgets._constructor("widget_comments.php",t,e,r,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com")+"/"+t,[],{proxy:function(){a.callMethod.apply(a,arguments)}});n.show()},startDrag:function(){cursorBack=window.document.body.style.cursor,window.document.body.style.cursor="pointer",VK.Util.addEvent("mousemove",u),VK.Util.addEvent("mouseup",s)},stopDrag:function(){window.document.body.style.cursor=cursorBack,VK.Util.removeEvent("mousemove",u),VK.Util.removeEvent("mouseup",s)}},{startHeight:133,minWidth:300,width:"100%"},function(t,e,n){i=e,a=n})},VK.Widgets.CommentsBrowse=function(t,e){return e=e||{},e.browse=1,VK.Widgets.Comments(t,e)},VK.Widgets.Recommended=function(t,e){VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=e||{};var n={limit:e.limit||5,max:e.max||0,sort:e.sort||"friend_likes",verb:e.verb||0,period:e.period||"week",target:e.target||"parent"};return VK.Widgets._constructor("widget_recommended.php",t,e,n,{},{startHeight:90+30*n.limit,minWidth:150,width:"100%"})},VK.Widgets.Like=function(t,e,n){function o(t){if((y||t)&&c&&l&&c&&("none"==l.style.display||"yes"==l.getAttribute("vkhidden"))){var n=e.getScrollTop?e.getScrollTop():document.body.scrollTop||document.documentElement.scrollTop||0,o=VK.Util.getXY(r,e.fixed),i=v?0:o[1];n>o[1]-120&&"top"!=e.tooltipPos||"vertical"==p||"bottom"==e.tooltipPos?(l.style.top=i+g+2+"px",c.callMethod("show",!1)):(l.style.top=i-125+"px",c.callMethod("show",!0)),VK.Util.ss(l,{left:(v?0:o[0])-("vertical"==p||"mini"==p?36:2)+"px",display:"block",opacity:1,filter:"none"}),l.setAttribute("vkhidden","no"),y=!0}}function i(t){y&&!t||!c||(c.callMethod("hide"),u.callMethod("hide"),setTimeout(function(){l.style.display="none"},400))}var a=VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=VK.extend(e||{},{allowTransparency:!0}),("button"==e.type||"vertical"==e.type||"mini"==e.type)&&delete e.width;var r,s,u,l,c,d,f,p="full"==e.type||"button"==e.type||"vertical"==e.type||"mini"==e.type?e.type:"full",h="full"==p?Math.max(200,e.width||350):"button"==p?180:"mini"==p?100:41,m=parseInt(e.height,10)||22,g="vertical"==p?2*m+7:"full"==p?m+1:m,_={page:n||0,url:e.pageUrl||a.url,type:p,verb:1==e.verb?1:0,title:e.pageTitle||a.title,description:e.pageDescription||a.description,image:e.pageImage||a.image,text:(e.text||"").substr(0,140),h:m},v=e.ttHere||!1,y=!1;return VK.Widgets._constructor("widget_like.php",t,e,_,{initTooltip:function(t){c=new fastXDM.Server({onInit:t?function(){o(!0)}:function(){},proxy:function(){u.callMethod.apply(u,arguments)},showBox:function(t,n){var o=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[n.width,n.height],{proxy:function(){c.callMethod.apply(c,arguments)}});o.show()},statsBox:function(){i(!0),f=VK.Util.Box(s.src+"&act=a_stats_box&widget_width=620"),f.show()}},!1,{safe:!0}),l=c.append(v?r:document.body,{src:s.src+"&act=a_share_tooltip",scrolling:"no",allowTransparency:!0,id:s.id+"_tt",style:{position:"absolute",padding:0,display:"block",opacity:.01,filter:"alpha(opacity=1)",border:"0",width:"206px",height:"127px",zIndex:5e3,overflow:"hidden"}}),l.setAttribute("vkhidden","yes"),r.onmouseover=l.onmouseover=function(){y=!0},r.onmouseout=l.onmouseout=function(){clearTimeout(d),y=!1,d=setTimeout(function(){i()},200)}},showTooltip:o,hideTooltip:i,showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){u.callMethod.apply(u,arguments)}});n.show()},proxy:function(){c&&c.callMethod.apply(c,arguments)}},{startHeight:g,minWidth:h},function(t,e,n){u=n,VK.Util.ss(r=t,{height:g+"px",width:h+"px",position:"relative",clear:"both"}),VK.Util.ss(s=e,{height:g+"px",width:h+"px",overflow:"hidden",zIndex:150})})},VK.Widgets.Poll=function(t,e,n){var o=VK.Util.getPageData();if(!n)throw Error("No poll id passed");e=e||{};var i={poll_id:n,url:e.pageUrl||o.url||location.href,title:e.pageTitle||o.title,description:e.pageDescription||o.description};return VK.Widgets._constructor("widget_poll.php",t,e,i,{},{startHeight:133,minWidth:300,width:"100%"})},VK.Widgets.PagePoll=function(t,e,n){var o=VK.Util.getPageData();e=e||{};var i={page:n||0,norealtime:e.norealtime?1:0,poll_id:e.pollId||"",url:e.pageUrl||o.url||location.href,title:e.pageTitle||o.title,description:e.pageDescription||o.description};return VK.Widgets._constructor("al_widget_poll.php",t,e,i,{},{startHeight:133,minWidth:300,width:"100%"})},VK.Widgets.Community=VK.Widgets.Group=function(t,e,n){function o(){return a.callMethod("mouseUp"),!1}function i(t){return a.callMethod("mouseMove",{screenY:t.screenY}),!1}n=parseInt(n,10);var a;if(!n)throw Error("No group_id passed");e.mode=parseInt(e.mode,10).toString();var r={gid:n,mode:e.mode?e.mode:"0"};e.width||(e.width=200),e.wall&&(r.wall=e.wall),r.color1=e.color1||"",r.color2=e.color2||"",r.color3=e.color3||"",e.no_head&&(r.no_head=1),e.height||(e.height=290),e.wide&&(r.wide=1,e.width<300&&(e.width=300));var s;return VK.Widgets._constructor("widget_community.php",t,e,r,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});n.show()},startDrag:function(){s=window.document.body.style.cursor,window.document.body.style.cursor="pointer",VK.Util.addEvent("mousemove",i),VK.Util.addEvent("mouseup",o)},stopDrag:function(){window.document.body.style.cursor=s,VK.Util.removeEvent("mousemove",i),VK.Util.removeEvent("mouseup",o)},auth:function(){VK.Auth.login(null,1)}},{minWidth:120,width:"200",height:"290",startHeight:200},function(t,e,n){a=n})},VK.Widgets.Auth=function(t,e){VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");return e.width||(e.width=200),type=e.type?1:0,VK.Widgets._constructor("widget_auth.php",t,e,{},{makeAuth:function(t){if(t.session&&(VK.Auth._loadState="loaded",VK.Auth.setSession(t.session,"connected"),VK.Observer.publish("auth.loginStatus",{session:t.session,status:"connected"}),VK.Observer.unsubscribe("auth.loginStatus")),e.onAuth)e.onAuth(t);else{if(e.authUrl)var n=e.authUrl;else var n=window.location.href;n+=-1==n.indexOf("?")?"?":"&";var o=[];for(var i in t)"session"!=i&&o.push(i+"="+decodeURIComponent(t[i]).replace(/&/g,"%26").replace(/\?/,"%3F"));window.location.href=n+o.join("&")}}},{startHeight:80})},VK.Widgets.Subscribe=function(t,e,n){n=parseInt(n,10);var o;if(!n)throw Error("No owner_id passed");var i={oid:n};return e.mode&&(i.mode=e.mode),e.soft&&(i.soft=e.soft),VK.Widgets._constructor("widget_subscribe.php",t,e,i,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});n.show()},auth:function(){VK.Auth.login(null,1)}},{minWidth:220,startHeight:22,height:e.height||22},function(t,e,n){o=n})},VK.Widgets.Ads=function(t,e,n){function o(t){VK.Widgets.loading(v,!0),a(t)}function i(t,n){VK.Widgets.loading(v,!1),r(n),e.onAdsReady&&e.onAdsReady.apply(e.onAdsReady,Array.prototype.slice.call(arguments)),s(t)}function a(t){if("vk__adsLight"in window)window.vk__adsLight&&vk__adsLight.userHandlers&&vk__adsLight.userHandlers.onInit&&vk__adsLight.userHandlers.onInit(!1);else{window.vk__adsLight=!1,t=parseInt(t);var n=VK.Api&&VK.Api.attachScript||VK.addScript,o=e.base_domain||VK._protocol+"//vk.com";n(o+"/js/al/aes_light.js?"+t)}}function r(t){if(t)for(var e in t){var n=t[e];"ads_ad_unit_width"===e||"ads_ad_unit_height"===e?e in y||(b[e]=parseInt(n)||"auto"===n&&y[e+"_auto"]||w[e]):e in b||(b[e]=n)}}function s(t){var e=u(b.ads_handler,t);if(0>=t&&e!==!0){try{console.log("VK: ad_unit_id = "+y.ads_ad_unit_id,", errorCode = ",t)}catch(n){}l(b.ads_handler_empty_html,b.ads_ad_unit_width,b.ads_ad_unit_height)}}function u(t){function e(t){return"[object Function]"===Object.prototype.toString.call(t)}function n(t){return"[object String]"===Object.prototype.toString.call(t)}var o=!1;try{if(!t)return!1;var i=!1;if(e(t))i=t;else if(n(t)){var a=t.split(".");i=window;for(var r=0,s=a.length;s>r&&(i=i[a[r]],i);r++);if(!i){"function"===t.substr(0,8)&&(t="return "+t+";");var u=new Function(t)();e(u)?i=u:o=u}}if(i){var l=Array.prototype.slice.call(arguments,1);o=i.apply(i,l)}}catch(c){try{console.error(c)}catch(d){}}return o}function l(t,e,n){function o(){if(!n)try{var t=a.contentWindow.document.body.firstChild.getBoundingClientRect(),e=Math.ceil(t.bottom-t.top);e&&(a.style.height=e,v.style.height=e)}catch(o){}}if(t&&v){e=e?e+"px":"",n=n?n+"px":"";var i='<html><head></head><body style="padding: 0; margin: 0;"><div>'+t+"</div></body></html>",a=document.createElement("iframe");a.onload=o,a.id=(p?p.id:"vkwidget-"+Math.round(1e6*Math.random()))+"_ads_html_handler",a.src="about:blank",a.width="100%",a.height="100%",a.scrolling="no",a.frameBorder="0",a.allowTransparency=!0,a.style.overflow="hidden",a.style.width=e,a.style.height=n,v.style.width=e,v.style.height=n,v.appendChild(a),a.contentWindow.vk_ads_html_handler=i,a.src='javascript:window["vk_ads_html_handler"]'
}}function c(t,e,n){for(var o=n||0,i=(t||[]).length;i>o;o++)if(t[o]==e)return o;return-1}function d(t,e){return-1!=c(e,t)}function f(t,e,n){v=t,p=e,h=n}e=e||{},n=n||{};var p,h,m={},g={},_={},v=document.getElementById(t),y={},b={},w={};for(var T in n){var k=d(T,["hash"])?T:"ads_"+T;y[k]=n[T]}if(v&&v.getBoundingClientRect){v.style.width="100%",v.style.height="100%";var S=v.getBoundingClientRect();v.style.width="",v.style.height="",y.ads_ad_unit_width_auto=Math.floor(S.right-S.left),y.ads_ad_unit_height_auto=Math.floor(S.bottom-S.top)}return w.ads_ad_unit_width=100,w.ads_ad_unit_height=100,b.ads_ad_unit_width=parseInt(y.ads_ad_unit_width)||"auto"===y.ads_ad_unit_width&&y.ads_ad_unit_width_auto||w.ads_ad_unit_width,b.ads_ad_unit_height=parseInt(y.ads_ad_unit_height)||"auto"===y.ads_ad_unit_height&&y.ads_ad_unit_height_auto||w.ads_ad_unit_height,y.ads_handler&&(b.ads_handler=y.ads_handler),y.ads_handler_empty_html&&(b.ads_handler_empty_html=y.ads_handler_empty_html),delete y.ads_handler,delete y.ads_handler_empty_html,m.act="ads_web",m.url=location.href,VK.extend(m,y),e.noDefaultParams=!0,e.width=b.ads_ad_unit_width,e.allowTransparency=!0,g.startHeight=b.ads_ad_unit_height,g.minWidth=b.ads_ad_unit_width,_.adsOnInitLoader=o,_.adsOnInit=i,VK.Widgets._constructor("ads_rotate.php",t,e,m,_,g,f)},VK.Widgets._constructor=function(t,e,n,o,i,a,r,s,u){var l=document.getElementById(e);if(s=s||++VK.Widgets.count,!l){if(u=u||0,u>10)throw Error("VK.Widgets: object #"+e+" not found.");return setTimeout(function(){VK.Widgets._constructor(t,e,n,o,i,a,r,s,u+1)},500),s}var c,d,f,p,h,m,g,_;n=n||{},a=a||{},i=i||{},c=n.base_domain||VK._protocol+"//vk.com",d="auto"==n.width?l.clientWidth||"100%":parseInt(n.width,10),n.height?(o.height=n.height,l.style.height=n.height+"px"):l.style.height=(a.startHeight||200)+"px",d=d?Math.max(a.minWidth||200,Math.min(1e4,d))+"px":"100%",o.url||(o.url=n.pageUrl||location.href.replace(/#.*$/,"")),f=c+"/"+t,p="",n.noDefaultParams||(p+="&app="+(VK._apiId||"0")+"&width="+d),p+="&_ver="+VK.version,VK._iframeAppWidget&&(o.iframe_app=1);for(_ in o){if("title"==_&&o[_].length>80&&(o[_]=o[_].substr(0,80)+"..."),"description"==_&&o[_].length>160&&(o[_]=o[_].substr(0,160)+"..."),"number"==typeof o[_])h=o[_];else try{h=encodeURIComponent(o[_])}catch(v){h=""}p+="&"+_+"="+h}return p+="&"+(+new Date).toString(16),f+="?"+p.substr(1),l.style.width=d,VK.Widgets.loading(l,!0),i.publish=function(){var t=Array.prototype.slice.call(arguments);t.push(s),VK.Observer.publish.apply(VK.Observer,t)},i.onInit=function(){VK.Widgets.loading(l,!1),i.onReady&&i.onReady(),n.onReady&&n.onReady()},i.resize=function(t){l.style.height=t+"px";var e=document.getElementById("vkwidget"+s);e&&(e.style.height=t+"px")},i.resizeWidget=function(t,e){t=parseInt(t),e=parseInt(e);var o=document.getElementById("vkwidget"+s);isFinite(t)&&(l.style.width=t+"px",o&&(o.style.width=t+"px")),isFinite(e)&&(l.style.height=e+"px",o&&(o.style.height=e+"px")),n.onResizeWidget&&n.onResizeWidget()},i.updateVersion=function(t){t>1&&VK.Api.attachScript("//vk.com/js/api/openapi_update.js?"+parseInt(t))},m=VK.Widgets.RPC[s]=new fastXDM.Server(i,function(t){return t?(t=t.toLowerCase(),-1!=t.indexOf(".vk.com")||-1!=t.indexOf("/vk.com")):!0},{safe:!0}),g=VK.Widgets.RPC[s].append(l,{src:f,width:-1!=d.indexOf("%")?d:parseInt(d)||d,height:a.startHeight||"100%",scrolling:"no",id:"vkwidget"+s,allowTransparency:n.allowTransparency||!1,style:{overflow:"hidden"}}),r&&setTimeout(function(){r(l,g||l.firstChild,m)},10),s}),VK.Util||(VK.Util={getPageData:function(){if(!VK._pData){var t,e=document.getElementsByTagName("meta"),n={},o=["description","title","url","image","app_id"];for(var i in e)if(e[i].getAttribute&&e[i].getAttribute&&((t=e[i].getAttribute("name"))||(t=e[i].getAttribute("property"))))for(var a in o)(t==o[a]||t=="og:"+o[a]||t=="vk:"+o[a])&&(n[o[a]]=e[i].content);n.app_id&&!VK._apiId&&(VK._apiId=n.app_id),n.title=n.title||document.title||"",n.description=n.description||"",n.image=n.image||"",!n.url&&VK._iframeAppWidget&&VK._apiId&&(n.url="/app"+VK._apiId,VK._browserHash&&(n.url+=VK._browserHash));var r=location.href.replace(/#.*$/,"");n.url&&n.url.indexOf(r)||(n.url=r),VK._pData=n}return VK._pData},getStyle:function(t,e){var n,o=document.defaultView||window;if(o.getComputedStyle){e=e.replace(/([A-Z])/g,"-$1").toLowerCase();var i=o.getComputedStyle(t,null);i&&(n=i.getPropertyValue(e))}else if(t.currentStyle){var a=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()});n=t.currentStyle[e]||t.currentStyle[a]}return n},getXY:function(t,e){if(t&&void 0!==t){var n=0,o=0;if(void 0!==t.getBoundingClientRect){var i=t.getBoundingClientRect();n=i.left,o=i.top,e=!0}else if(t.offsetParent)do n+=t.offsetLeft,o+=t.offsetTop,e&&(n-=t.scrollLeft,o-=t.scrollTop);while(t=t.offsetParent);return e&&(o+=window.pageYOffset||window.scrollNode&&scrollNode.scrollTop||document.documentElement.scrollTop,n+=window.pageXOffset||window.scrollNode&&scrollNode.scrollLeft||document.documentElement.scrollLeft),[n,o]}},Box:function(t,e,n){n=n||{};var o=document.body.style.overflow,i=document.createElement("DIV"),a=new fastXDM.Server(VK.extend(n,{onInit:function(){r.style.background="transparent",r.style.visibility="visible",document.body.style.overflow="hidden",document.body.removeChild(i)},hide:function(){r.style.display="none"},tempHide:function(){r.style.left="-10000px",r.style.top="-10000px",r.style.width="10px",r.style.height="10px",document.body.style.overflow=o},destroy:function(){try{r.src="about: blank;"}catch(t){}r.parentNode.removeChild(r),document.body.style.overflow=o},resize:function(){}},!0),!1,{safe:!0}),r=a.append(document.body,{src:t.replace(/&amp;/g,"&"),scrolling:"no",allowTransparency:!0,style:{position:"fixed",left:0,top:0,zIndex:1002,background:VK._protocol+"//vk.com/images/upload.gif center center no-repeat transparent",padding:"0",border:"0",width:"100%",height:"100%",overflow:"hidden",visibility:"hidden"}});return i.innerHTML='<div style="position: fixed;left: 50%;top: 50%;margin: 0px auto 0px -60px;z-index: 1002;width: 100px;"><div style="background: url(//vk.com/images/upload_inv_mono'+(window.devicePixelRatio>=2?"_2x":"")+'.gif) no-repeat 50% 50%;background-size: 64px 16px;height: 50px;position: absolute;width: 100%;z-index: 100;"></div><div style="background-color: #000;opacity: 0.7;filter: alpha(opacity=70);height: 50px;-webkit-border-radius: 5px;-khtml-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-webkit-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);-moz-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);"></div></div>',document.body.insertBefore(i,document.body.firstChild),{show:function(){r.style.display="block",document.body.style.overflow="hidden"},hide:function(){r.style.display="none",document.body.style.overflow=o},iframe:r,rpc:a}},addEvent:function(t,e){window.document.addEventListener?window.document.addEventListener(t,e,!1):window.document.attachEvent&&window.document.attachEvent("on"+t,e)},removeEvent:function(t,e){window.document.removeEventListener?window.document.removeEventListener(t,e,!1):window.document.detachEvent&&window.document.detachEvent("on"+t,e)},ss:function(t,e){VK.extend(t.style,e,!0)}}),window.vkAsyncInit&&setTimeout(vkAsyncInit,0),window.vkAsyncInitCallbacks&&vkAsyncInitCallbacks.length&&setTimeout(function(){for(var t;t=vkAsyncInitCallbacks.pop();)try{t()}catch(e){try{console.error(e)}catch(n){}}},0);try{window.stManager&&stManager.done("api/openapi.js")}catch(e){}angular.module("App").controller("Cm_shareTrack",["$scope","trackInfo","__domain",function(t,e,n){var o=this;o.trackUrl=n+"/share/track/"+e.owner_id+"_"+e.id,console.log(e)}]),angular.module("App").controller("Cm_vkCaptcha",["$scope","imageUrl",function(t,e){t.imageUrl=e}]),angular.module("App").controller("CD_track",["$scope","S_eventer","S_sound",function(t,e,n){var o=this;return o.thisIsCurrentTrack=function(){var e=n.getSoundId();return e?e===t.info.id:!1},o}]),angular.module("App").service("PS_echonest",["$http","__echonest",function(t,e){function n(n,o){return t({url:e.url+n,method:"GET",params:angular.extend({api_key:e.key},o)})}var o={};return o.getStaticPlaylist=function(t){return n("playlist/static",angular.extend({type:"artist-radio",bucket:"id:musicbrainz",results:50},t))},o.getGenresList=function(t){return n("genre/list",angular.extend({results:50},t))},o.extractArtists=function(t){return n("artist/extract",{text:t,results:3})},o}]),angular.module("App").service("PS_lastfm",["$q","$http","__lastfm",function(t,e,n){function o(t,o){return e.jsonp(n.url,{params:angular.extend(o,{format:"json",callback:"JSON_CALLBACK",method:t,api_key:n.keys.api})})}var i={};return i.init=function(){},i.artist={getInfo:function(t){return o("artist.getInfo",{artist:t,autocorrect:!0})},getSimilar:function(e){var n=t.defer();return o("artist.getSimilar",{artist:e,autocorrect:!1,limit:9}).then(function(t){var e,o=t.data.similarartists.artist;angular.forEach(o,function(t){e=t.image.length,t.imageSrc=t.image[4]["#text"]}),n.resolve(o)}),n.promise},getTopTags:function(t){return o("artist.getTopTags",{artist:t,autocorrect:!0})},getTopAlbums:function(e){var n=t.defer();return o("artist.getTopAlbums",angular.extend({limit:16,page:0},e)).then(function(t){var e=[],o=t.data;if(o.topalbums["@attr"]){var i=(o.topalbums["@attr"].totalPages,o.topalbums["@attr"].total);if(1==i&&e.push(o.topalbums.album),i>1){var a=o.topalbums.album;for(r=0;r<a.length;r++)e.push(a[r])}}for(var r=0,s=e.length;s>r;r++){var a=e[r],u=a.image.length;a.albumImage=a.image[u-1]["#text"]}n.resolve(e)}),n.promise}},i.album={getInfo:function(e){return t.when(o("album.getInfo",angular.extend({},e)).then(function(t){var e=t.data.album.image[3]["#text"];return t.data.album.albumImage=e,t.data.album}))}},i.tag={getTopTracks:function(t){return o("tag.getTopTracks",{tag:t,limit:12})}},i.chart={getTopArtists:function(t){return o("chart.getTopArtists",{limit:t||50})},getHypedArtists:function(t){return o("chart.getHypedArtists",{limit:t||50})}},i}]),angular.module("App").service("PS_self",["$http","__api",function(t,e){var n={},o=e.url;return n.getHotArtists=function(){return t({url:o+e.paths.getTopArtists,method:"GET"})},n.getTrackTranslationData=function(n){return t({url:o+e.paths.getTrackTranslationData+n,method:"GET"})},n.getTranslationUrl=function(t){return e.url+e.paths.translationTrackMp3+t},n}]),angular.module("App").service("PS_vk",["$q","$modal","$rootScope","__vkAppId","S_utils",function(t,e,n,o,i){function a(n,o,i){return i=i||t.defer(),o=$.extend({v:5.23},o),VK.Api.call(n,o,function(t){if(t.response&&i.resolve(t),t.error&&14===t.error.error_code){var r=t.error.captcha_sid;e.open({templateUrl:"templates/modals/vkCaptcha.html",controller:"Cm_vkCaptcha as ctr",size:"sm",resolve:{imageUrl:function(){return t.error.captcha_img}}}).result.then(function(t){a(n,angular.extend(o,{captcha_key:t,captcha_sid:r}),i)})}}),i.promise}function r(t){t.session?VK.Api.call("users.get",{fields:"photo_50"},function(t){var e=t.response[0].uid,o=t.response[0].first_name+" "+t.response[0].last_name,i=t.response[0].photo_50;l={id:e,name:o,photo:i},n.$broadcast("userLogin",l)}):n.$broadcast("badAuthorization")}function s(t,e){return'API.audio.search({"q":"'+t+" "+e+'","count": 10})'}var u={},l={};return u.addTrackToAudios=function(e){var n=i.getExecuteCode(function(){for(var t,e,n=API.audio.get({count:100}),o=n.items.length,i=-1;o-1>i;)if(i+=1,t=n.items[i],t.artist==_artist&&t.title==_title)return e=!0,{success:!0,already:!0};return e?void 0:(API.audio.add({audio_id:_id,owner_id:_owner_id}),{success:!0,res:n})},{_id:e.id,_owner_id:e.owner_id,_artist:e.artist,_title:e.title});return t.when(u.call("execute",{code:n}))},u.call=function(t,e){return a(t,e)},u.getUserInfo=function(){},u.init=function(){VK.init({apiId:o})},u.authorize=function(){VK.Auth.login(function(){VK.Auth.getLoginStatus(r)},VK.access.AUDIO+262144)},u.intro=function(){VK.Auth.getLoginStatus(function(t){r(t)})},u.get=function(t){t=$.extend({count:10},t),VK.Api.call("audio.get",{count:50,offset:that.offset,v:5},function(t){if(t.response){var e=t.response;e.items.length>0&&console.log(e.items)}})},u.findTrackArray=function(t,e,n){function o(){for(var a="",c=l*i,d=c;c+i>d;d++){var f=t[d];if(!f)break;""!=a&&(a+=","),a+=s(f.artist,f.title)}a="return ["+a+"];",u.call("execute",{code:a}).then(function(t){l++,e(t,c),r>l?setTimeout(o,1e3):n()})}var i=5,a=t.length,r=Math.ceil(a/i),l=0;o()},u.search=function(t){return a("audio.search",angular.extend({auto_complete:1,lyrics:0,performer_only:0,sort:2,search_own:1,offset:0,count:50,v:5.23},t))},u}]),angular.module("App").controller("C_album",["$stateParams","PS_lastfm","PS_vk","S_reduce",function(t,e,n,o){function i(t){for(var e=[],n=0,o=t.tracks.track.length;o>n;n++){var i=t.tracks.track[n];e.push({artist:i.artist.name,title:i.name,duration:i.duration})}return"undefined"==typeof t.tracks.track.length&&e.push(t.tracks.track),e}var a=this,r=t.artist,s=t.albumName;a.audios=[],a.tracksPlurals={0:"нет треков",one:"{} трек",few:"{} трека",many:"{} треков",other:"{} треков"},e.album.getInfo({artist:r,album:s}).then(function(t){a.info=t;var e=i(t);n.findTrackArray(e,function(t,n){console.log("part!");var i=[];$.each(t.response,function(t,o){var a=o.items[0];if(!a){var r=e[n+t];a={error:!0,artist:r.artist,title:r.title,duration:r.duration}}i.push(a)}),i=o.filterTracks(i),a.audios=a.audios.concat(i)},function(){console.log("all!")})})}]),angular.module("App").controller("C_artists",["$q","PS_echonest","PS_lastfm","S_reduce",function(t,e,n,o){var i={};return i.limits={hyped:6,artists:6},t.all({artists:n.chart.getTopArtists(21),hyped:n.chart.getHypedArtists(21)}).then(function(t){i.artists=o.normalizeTopArtists(t.artists.data.artists.artist),i.hypedArtists=o.normalizeTopArtists(t.hyped.data.artists.artist)}),i}]),angular.module("App").controller("C_artists.page",["$q","$scope","$rootScope","$stateParams","$state","PS_lastfm","PS_self","PS_vk","S_reduce","S_processing",function(t,e,n,o,i,a,r,s,u,l){var c={},d=i.params.artist;return c.section=i.params.section,e.$on("$stateChangeSuccess",function(t,e,n){c.section=n.section,c.loadInfo(c.section)}),c.loadInfo=function(e){switch(l.loading(),e){case"tracks":t.all({tracks:s.search({q:d,count:50,performer_only:1})}).then(function(t){c.searchTracks=u.filterTracks(t.tracks.response.items),l.ready()});break;case"albums":t.all({albums:a.artist.getTopAlbums({artist:d})}).then(function(t){c.albums=t.albums,l.ready()});break;case"similar":t.all({similar:a.artist.getSimilar(d)}).then(function(t){c.similarArtists=t.similar,l.ready()});break;default:t.all({tracks:s.search({q:d,performer_only:1}),albums:a.artist.getTopAlbums({artist:d,limit:3})}).then(function(t){c.searchTracks=u.filterTracks(t.tracks.response.items).splice(0,10),c.albums=t.albums,l.ready()})}},t.all({info:a.artist.getInfo(d),tags:a.artist.getTopTags(d),publics:s.call("groups.search",{q:d,fields:"members_count,verified,site",count:3})}).then(function(t){var e=t.info.data.artist;c.artistInfo={name:e.name,image:e.image[e.image.length-1]["#text"],tags:t.tags.data.toptags.tag},c.publics=t.publics.response?t.publics.response.items:[],console.log(c.publics)}),c}]),angular.module("App").controller("C_discover",["$stateParams","PS_echonest","PS_self",function(t,e,n){var o={};return o.searchMode=t.q?!0:!1,o.query=t.q,n.getHotArtists().then(function(t){o.artists=t.data.artists}),o}]),angular.module("App").controller("C_flow",["$stateParams","$scope","PS_echonest","PS_vk","PS_lastfm","S_utils","S_processing","S_reduce","S_sound","S_logic",function(t,e,n,o,i,a,r,s,u,l){function c(t){p.playing=!1;var e=d(t);o.findTrackArray(e,function(t,n){var o=[];$.each(t.response,function(t,i){var a=e[n+t],r=l.findMostLikelyTrack({artist:a.artist,title:a.title},i.items);r||(r={error:!0,artist:a.artist,title:a.title,duration:a.duration}),o.push(r)}),o=s.filterTracks(o,{withDurations:!0}),p.songs=p.songs.concat(o),!p.playing&&p.songs.length>0&&(p.playing=!0,soundManager.ok()?u.createAndPlay(p.songs[0]):u.onload=function(){u.createAndPlay(p.songs[0])})},function(){r.ready()})}function d(t){for(var e=[],n=0,o=t.length;o>n;n++){var i=t[n];e.push({artist:a.prepareTextToExecute(i.artist_name||i.artist),title:a.prepareTextToExecute(i.title)})}return e}function f(t){i.artist.getInfo(t).then(function(e){var n=e.data.artist;if(n&&n.image&&""!==n.image[n.image.length-1]["#text"])p.artistInfo={name:n.name,image:n.image[n.image.length-1]["#text"]};else{var o=new Trianglify,i=o.generate(document.body.clientWidth,document.body.clientHeight);p.artistInfo={name:t,image:i.dataUri}}})}var p={};if(p.isTag=t.tag?!0:!1,p.typeLocale=p.isTag?"тегу":"исполнителю",p.query=t.tag?t.tag:t.artist,p.songs=[],p.playing=!1,t.artist&&!t.tag){var h=t.artist;n.getStaticPlaylist({artist:h,bucket:"id:twitter",results:30}).then(function(t){c(t.data.response.songs)})}if(t.tag&&!t.artist){var m=t.tag;n.getStaticPlaylist({results:12,type:"genre-radio",genre:m}).then(function(t){c(t.data.response.songs)},function(){i.tag.getTopTracks(m).then(function(t){c(s.normalizeTopTracks(t.data.toptracks.track))})})}return e.$on("trackStarted",function(t,e){f(e.artist)}),p}]),angular.module("App").controller("C_playlists",["$stateParams","$scope","PS_echonest","S_utils",function(t,e,n,o){var i={};return n.getGenresList({results:1e3}).then(function(t){i.genreList=o.shuffleArray(t.data.response.genres)}),i}]),angular.module("App").controller("C_public",["$stateParams","$q","$scope","$state","PS_vk","PS_echonest",function(t,e,n,o,i,a){var r={};return r.activeAlbum=+o.params.album_id,i.call("groups.getById",{group_id:t.id,fields:"description,verified,activity"}).then(function(n){n.response?(r.public=n.response[0],a.extractArtists(r.public.name).then(function(t){r.parsedArtists=t.data.response.artists.splice(0,1)}),e.all({audios:i.call("audio.get",{owner_id:"-"+t.id,count:100,album_id:t.album_id}),albums:i.call("audio.getAlbums",{owner_id:"-"+t.id})}).then(function(t){r.songs=t.audios.response.items,t.albums.response.count>0&&(r.albums=t.albums.response.items)})):alert("Error while loading!")}),r.loadAlbum=function(e){r.activeAlbum=e,i.call("audio.get",{owner_id:"-"+t.id,album_id:e}).then(function(t){r.songs=t.response.items})},r}]),angular.module("App").controller("C_share",["$stateParams","$scope","PS_self","PS_vk","PS_lastfm","S_sound","S_processing","S_eventer",function(t,e,n,o,i,a,r,s){function u(){s.sendEvent("shareScreenTrack")}function l(t){i.artist.getInfo(t).then(function(t){var e=t.data.artist;if(e&&e.image&&""!==e.image[e.image.length-1]["#text"])c.image=e.image[e.image.length-1]["#text"];else{var n=new Trianglify,o=n.generate(document.body.clientWidth,document.body.clientHeight);c.image=o.dataUri}})}var c={},d=t.type,f=t.id;return"track"===d&&(e.$on("badAuthorization",function(){n.getTrackTranslationData(f).then(function(t){if(u(),r.ready(),!t.data.error){var e=angular.extend(t.data,{url:n.getTranslationUrl(t.data.url)});l(e.artist),soundManager.ok()?a.createAndPlay(e):a.onload=function(){a.createAndPlay(e)}}})}),e.$on("userLogin",function(){c.iAmHere||o.call("audio.getById",{audios:f}).then(function(t){u(),r.ready();var e=t.response[0];return e?(l(e.artist),void(soundManager.ok()?a.createAndPlay(e):a.onload=function(){a.createAndPlay(e)})):void alert("ID error")})})),c.auth=function(){c.iAmHere=!0,o.authorize()},e.$on("userLogin",function(){c.hideIntroButton=!0}),c}]);