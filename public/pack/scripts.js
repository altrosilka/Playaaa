function LastFM(t){var e=t.apiKey||"",n=t.apiSecret||"",o=t.apiUrl||"http://ws.audioscrobbler.com/2.0/",r=t.cache||void 0;this.setApiKey=function(t){e=t},this.setApiSecret=function(t){n=t},this.setApiUrl=function(t){o=t},this.setCache=function(t){r=t};var a=function(t,e,n){if("POST"==n){iframes=document.getElementsByClassName("ifr");var a=document.getElementsByTagName("html")[0];for(i=0;i<iframes.length;i++)a.removeChild(iframes[i]);var s,u=document.createElement("iframe");u.width=1,u.height=1,u.className="ifr",u.style.border="none",u.onload=function(){"undefined"!=typeof e.success&&e.success()},a.appendChild(u),s="undefined"!=typeof u.contentWindow?u.contentWindow.document:"undefined"!=typeof u.contentDocument.document?u.contentDocument.document.document:u.contentDocument.document,s.open(),s.clear(),s.write('<form method="post" action="'+o+'" id="form">');for(var d in t)s.write('<input type="text" name="'+d+'" value="'+t[d]+'">');s.write("</form>"),s.write('<script type="text/javascript">'),s.write('document.getElementById("form").submit();'),s.write("</script>"),s.close()}else{var c="jsonp"+(new Date).getTime(),p=l.getApiSignature(t);if("undefined"!=typeof r&&r.contains(p)&&!r.isExpired(p))return void("undefined"!=typeof e.success&&e.success(r.load(p)));t.callback=c,t.format="json",window[c]=function(n){if("undefined"!=typeof r){var o=r.getExpirationTime(t);o>0&&r.store(p,n,o)}"undefined"!=typeof n.error?"undefined"!=typeof e.error&&e.error(n.error,n.message):"undefined"!=typeof e.success&&e.success(n),window[c]=void 0;try{delete window[c]}catch(i){}f&&f.removeChild(h)};var f=document.getElementsByTagName("head")[0],h=document.createElement("script"),m=[];for(var d in t)m.push(encodeURIComponent(d)+"="+encodeURIComponent(t[d]));h.src=o+"?"+m.join("&").replace(/%20/g,"+"),f.appendChild(h)}},s=function(t,n,o,i){n=n||{},o=o||{},i=i||"GET",n.method=t,n.api_key=e,a(n,o,i)},u=function(t,n,o,i,r){n=n||{},i=i||{},r=r||"GET",n.method=t,n.api_key=e,n.sk=P.lastkey,n.api_sig=l.getApiSignature(n),a(n,i,r)};this.album={addTags:function(t,e,n){"object"==typeof t.tags&&(t.tags=t.tags.join(",")),u("album.addTags",t,e,n,"POST")},getBuylinks:function(t,e){s("album.getBuylinks",t,e)},getInfo:function(t,e){s("album.getInfo",t,e)},getTags:function(t,e,n){u("album.getTags",t,e,n)},removeTag:function(t,e,n){u("album.removeTag",t,e,n,"POST")},search:function(t,e){s("album.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("album.share",t,n)}},this.artist={addTags:function(t,e,n){"object"==typeof t.tags&&(t.tags=t.tags.join(",")),u("artist.addTags",t,e,n,"POST")},getCorrection:function(t,e){s("artist.getCorrection",t,e)},getEvents:function(t,e){s("artist.getEvents",t,e)},getImages:function(t,e){s("artist.getImages",t,e)},getInfo:function(t,e){s("artist.getInfo",t,e)},getPastEvents:function(t,e){s("artist.getPastEvents",t,e)},getPodcast:function(t,e){s("artist.getPodcast",t,e)},getShouts:function(t,e){s("artist.getShouts",t,e)},getSimilar:function(t,e){s("artist.getSimilar",t,e)},getTags:function(t,e,n){u("artist.getTags",t,e,n)},getTopAlbums:function(t,e){s("artist.getTopAlbums",t,e)},getTopFans:function(t,e){s("artist.getTopFans",t,e)},getTopTags:function(t,e){s("artist.getTopTags",t,e)},getTopTracks:function(t,e){s("artist.getTopTracks",t,e)},removeTag:function(t,e,n){u("artist.removeTag",t,e,n,"POST")},search:function(t,e){s("artist.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("artist.share",t,e,n,"POST")},shout:function(t,e,n){u("artist.shout",t,e,n,"POST")}},this.auth={getMobileSession:function(t,e){t={username:t.username,authToken:hex_md5(t.username+hex_md5(t.password))},u("auth.getMobileSession",t,null,e)},getSession:function(t,e){u("auth.getSession",t,null,e)},getToken:function(t){u("auth.getToken",null,null,t)},getWebSession:function(t){var e=o;o="http://ext.last.fm/2.0/",u("auth.getWebSession",null,null,t),o=e}},this.chart={getHypedArtists:function(t,e){s("chart.getHypedArtists",t,e)},getHypedTracks:function(t,e,n){s("chart.getHypedTracks",t,n)},getLovedTracks:function(t,e,n){s("chart.getLovedTracks",t,n)},getTopArtists:function(t,e){s("chart.getTopArtists",t,e)},getTopTags:function(t,e,n){s("chart.getTopTags",t,n)},getTopTracks:function(t,e,n){s("chart.getTopTracks",t,n)}},this.event={attend:function(t,e,n){u("event.attend",t,e,n,"POST")},getAttendees:function(t,e,n){s("event.getAttendees",t,n)},getInfo:function(t,e){s("event.getInfo",t,e)},getShouts:function(t,e){s("event.getShouts",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("event.share",t,e,n,"POST")},shout:function(t,e,n){u("event.shout",t,e,n,"POST")}},this.geo={getEvents:function(t,e){s("geo.getEvents",t,e)},getMetroArtistChart:function(t,e){s("geo.getMetroArtistChart",t,e)},getMetroHypeArtistChart:function(t,e){s("geo.getMetroHypeArtistChart",t,e)},getMetroHypeTrackChart:function(t,e){s("geo.getMetroHypeTrackChart",t,e)},getMetroTrackChart:function(t,e){s("geo.getMetroTrackChart",t,e)},getMetroUniqueArtistChart:function(t,e){s("geo.getMetroUniqueArtistChart",t,e)},getMetroUniqueTrackChart:function(t,e){s("geo.getMetroUniqueTrackChart",t,e)},getMetroWeeklyChartlist:function(t,e){s("geo.getMetroWeeklyChartlist",t,e)},getMetros:function(t,e){s("geo.getMetros",t,e)},getTopArtists:function(t,e){s("geo.getTopArtists",t,e)},getTopTracks:function(t,e){s("geo.getTopTracks",t,e)}},this.group={getHype:function(t,e){s("group.getHype",t,e)},getMembers:function(t,e){s("group.getMembers",t,e)},getWeeklyAlbumChart:function(t,e){s("group.getWeeklyAlbumChart",t,e)},getWeeklyArtistChart:function(t,e){s("group.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("group.getWeeklyChartList",t,e)},getWeeklyTrackChart:function(t,e){s("group.getWeeklyTrackChart",t,e)}},this.library={addAlbum:function(t,e,n){u("library.addAlbum",t,e,n,"POST")},addArtist:function(t,e,n){u("library.addArtist",t,e,n,"POST")},addTrack:function(t,e,n){u("library.addTrack",t,e,n,"POST")},getAlbums:function(t,e){s("library.getAlbums",t,e)},getArtists:function(t,e){s("library.getArtists",t,e)},getTracks:function(t,e){s("library.getTracks",t,e)}},this.playlist={addTrack:function(t,e,n){u("playlist.addTrack",t,e,n,"POST")},create:function(t,e,n){u("playlist.create",t,e,n,"POST")},fetch:function(t,e){s("playlist.fetch",t,e)}},this.radio={getPlaylist:function(t,e,n){u("radio.getPlaylist",t,e,n)},search:function(t,e,n){u("radio.search",t,e,n)},tune:function(t,e,n){u("radio.tune",t,e,n)}},this.tag={getInfo:function(t,e){s("tag.getInfo",t,e)},getSimilar:function(t,e){s("tag.getSimilar",t,e)},getTopAlbums:function(t,e){s("tag.getTopAlbums",t,e)},getTopArtists:function(t,e){s("tag.getTopArtists",t,e)},getTopTags:function(t){s("tag.getTopTags",null,t)},getTopTracks:function(t,e){s("tag.getTopTracks",t,e)},getWeeklyArtistChart:function(t,e){s("tag.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("tag.getWeeklyChartList",t,e)},search:function(t,e){s("tag.search",t,e)}},this.tasteometer={compare:function(t,e){s("tasteometer.compare",t,e)},compareGroup:function(t,e){s("tasteometer.compareGroup",t,e)}},this.track={addTags:function(t,e,n){u("track.addTags",t,e,n,"POST")},ban:function(t,e,n){u("track.ban",t,e,n,"POST")},getBuylinks:function(t,e){s("track.getBuylinks",t,e)},getCorrection:function(t,e){s("track.getCorrection",t,e)},getFingerprintMetadata:function(t,e){s("track.getFingerprintMetadata",t,e)},getInfo:function(t,e){s("track.getInfo",t,e)},getShouts:function(t,e){s("track.getShouts",t,e)},getSimilar:function(t,e){s("track.getSimilar",t,e)},getTags:function(t,e,n){u("track.getTags",t,e,n)},getTopFans:function(t,e){s("track.getTopFans",t,e)},getTopTags:function(t,e){s("track.getTopTags",t,e)},love:function(t,e,n){u("track.love",t,e,n,"POST")},removeTag:function(t,e,n){u("track.removeTag",t,e,n,"POST")},scrobble:function(t,e,n){if(-1!=t.constructor.toString().indexOf("Array")){var o={};for(i in t)for(j in t[i])o[j+"["+i+"]"]=t[i][j];t=o}u("track.scrobble",t,e,n,"POST")},search:function(t,e){s("track.search",t,e)},share:function(t,e,n){"object"==typeof t.recipient&&(t.recipient=t.recipient.join(",")),u("track.share",t,e,n,"POST")},unban:function(t,e,n){u("track.unban",t,e,n,"POST")},unlove:function(t,e,n){u("track.unlove",t,e,n,"POST")},updateNowPlaying:function(t,e,n){u("track.updateNowPlaying",t,e,n,"POST")}},this.user={getArtistTracks:function(t,e){s("user.getArtistTracks",t,e)},getBannedTracks:function(t,e){s("user.getBannedTracks",t,e)},getEvents:function(t,e){s("user.getEvents",t,e)},getFriends:function(t,e){s("user.getFriends",t,e)},getInfo:function(t,e){s("user.getInfo",t,e)},getLovedTracks:function(t,e){s("user.getLovedTracks",t,e)},getNeighbours:function(t,e){s("user.getNeighbours",t,e)},getNewReleases:function(t,e){s("user.getNewReleases",t,e)},getPastEvents:function(t,e){s("user.getPastEvents",t,e)},getPersonalTracks:function(t,e){s("user.getPersonalTracks",t,e)},getPlaylists:function(t,e){s("user.getPlaylists",t,e)},getRecentStations:function(t,e,n){u("user.getRecentStations",t,e,n)},getRecentTracks:function(t,e){s("user.getRecentTracks",t,e)},getRecommendedArtists:function(t,e,n){u("user.getRecommendedArtists",t,e,n)},getRecommendedEvents:function(t,e,n){u("user.getRecommendedEvents",t,e,n)},getShouts:function(t,e){s("user.getShouts",t,e)},getTopAlbums:function(t,e){s("user.getTopAlbums",t,e)},getTopArtists:function(t,e){s("user.getTopArtists",t,e)},getTopTags:function(t,e){s("user.getTopTags",t,e)},getTopTracks:function(t,e){s("user.getTopTracks",t,e)},getWeeklyAlbumChart:function(t,e){s("user.getWeeklyAlbumChart",t,e)},getWeeklyArtistChart:function(t,e){s("user.getWeeklyArtistChart",t,e)},getWeeklyChartList:function(t,e){s("user.getWeeklyChartList",t,e)},getWeeklyTrackChart:function(t,e){s("user.getWeeklyTrackChart",t,e)},shout:function(t,e,n){u("user.shout",t,e,n,"POST")}},this.venue={getEvents:function(t,e){s("venue.getEvents",t,e)},getPastEvents:function(t,e){s("venue.getPastEvents",t,e)},search:function(t,e){s("venue.search",t,e)}};var l={getApiSignature:function(t){var e=[],o="";for(var i in t)e.push(i);e.sort();for(var r in e){var i=e[r];o+=i+t[i]}return o+=n,hex_md5(o)}}}function hex_md5(t){return rstr2hex(rstr_md5(str2rstr_utf8(t)))}function hex_hmac_md5(t,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(t),str2rstr_utf8(e)))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(t){return binl2rstr(binl_md5(rstr2binl(t),8*t.length))}function rstr_hmac_md5(t,e){var n=rstr2binl(t);n.length>16&&(n=binl_md5(n,8*t.length));for(var o=Array(16),i=Array(16),r=0;16>r;r++)o[r]=909522486^n[r],i[r]=1549556828^n[r];var a=binl_md5(o.concat(rstr2binl(e)),512+8*e.length);return binl2rstr(binl_md5(i.concat(a),640))}function rstr2hex(t){try{}catch(e){hexcase=0}for(var n,o=hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",r=0;r<t.length;r++)n=t.charCodeAt(r),i+=o.charAt(n>>>4&15)+o.charAt(15&n);return i}function str2rstr_utf8(t){for(var e,n,o="",i=-1;++i<t.length;)e=t.charCodeAt(i),n=i+1<t.length?t.charCodeAt(i+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),i++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o}function rstr2binl(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function binl2rstr(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function binl_md5(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,o=-271733879,i=-1732584194,r=271733878,a=0;a<t.length;a+=16){var s=n,u=o,l=i,d=r;n=md5_ff(n,o,i,r,t[a+0],7,-680876936),r=md5_ff(r,n,o,i,t[a+1],12,-389564586),i=md5_ff(i,r,n,o,t[a+2],17,606105819),o=md5_ff(o,i,r,n,t[a+3],22,-1044525330),n=md5_ff(n,o,i,r,t[a+4],7,-176418897),r=md5_ff(r,n,o,i,t[a+5],12,1200080426),i=md5_ff(i,r,n,o,t[a+6],17,-1473231341),o=md5_ff(o,i,r,n,t[a+7],22,-45705983),n=md5_ff(n,o,i,r,t[a+8],7,1770035416),r=md5_ff(r,n,o,i,t[a+9],12,-1958414417),i=md5_ff(i,r,n,o,t[a+10],17,-42063),o=md5_ff(o,i,r,n,t[a+11],22,-1990404162),n=md5_ff(n,o,i,r,t[a+12],7,1804603682),r=md5_ff(r,n,o,i,t[a+13],12,-40341101),i=md5_ff(i,r,n,o,t[a+14],17,-1502002290),o=md5_ff(o,i,r,n,t[a+15],22,1236535329),n=md5_gg(n,o,i,r,t[a+1],5,-165796510),r=md5_gg(r,n,o,i,t[a+6],9,-1069501632),i=md5_gg(i,r,n,o,t[a+11],14,643717713),o=md5_gg(o,i,r,n,t[a+0],20,-373897302),n=md5_gg(n,o,i,r,t[a+5],5,-701558691),r=md5_gg(r,n,o,i,t[a+10],9,38016083),i=md5_gg(i,r,n,o,t[a+15],14,-660478335),o=md5_gg(o,i,r,n,t[a+4],20,-405537848),n=md5_gg(n,o,i,r,t[a+9],5,568446438),r=md5_gg(r,n,o,i,t[a+14],9,-1019803690),i=md5_gg(i,r,n,o,t[a+3],14,-187363961),o=md5_gg(o,i,r,n,t[a+8],20,1163531501),n=md5_gg(n,o,i,r,t[a+13],5,-1444681467),r=md5_gg(r,n,o,i,t[a+2],9,-51403784),i=md5_gg(i,r,n,o,t[a+7],14,1735328473),o=md5_gg(o,i,r,n,t[a+12],20,-1926607734),n=md5_hh(n,o,i,r,t[a+5],4,-378558),r=md5_hh(r,n,o,i,t[a+8],11,-2022574463),i=md5_hh(i,r,n,o,t[a+11],16,1839030562),o=md5_hh(o,i,r,n,t[a+14],23,-35309556),n=md5_hh(n,o,i,r,t[a+1],4,-1530992060),r=md5_hh(r,n,o,i,t[a+4],11,1272893353),i=md5_hh(i,r,n,o,t[a+7],16,-155497632),o=md5_hh(o,i,r,n,t[a+10],23,-1094730640),n=md5_hh(n,o,i,r,t[a+13],4,681279174),r=md5_hh(r,n,o,i,t[a+0],11,-358537222),i=md5_hh(i,r,n,o,t[a+3],16,-722521979),o=md5_hh(o,i,r,n,t[a+6],23,76029189),n=md5_hh(n,o,i,r,t[a+9],4,-640364487),r=md5_hh(r,n,o,i,t[a+12],11,-421815835),i=md5_hh(i,r,n,o,t[a+15],16,530742520),o=md5_hh(o,i,r,n,t[a+2],23,-995338651),n=md5_ii(n,o,i,r,t[a+0],6,-198630844),r=md5_ii(r,n,o,i,t[a+7],10,1126891415),i=md5_ii(i,r,n,o,t[a+14],15,-1416354905),o=md5_ii(o,i,r,n,t[a+5],21,-57434055),n=md5_ii(n,o,i,r,t[a+12],6,1700485571),r=md5_ii(r,n,o,i,t[a+3],10,-1894986606),i=md5_ii(i,r,n,o,t[a+10],15,-1051523),o=md5_ii(o,i,r,n,t[a+1],21,-2054922799),n=md5_ii(n,o,i,r,t[a+8],6,1873313359),r=md5_ii(r,n,o,i,t[a+15],10,-30611744),i=md5_ii(i,r,n,o,t[a+6],15,-1560198380),o=md5_ii(o,i,r,n,t[a+13],21,1309151649),n=md5_ii(n,o,i,r,t[a+4],6,-145523070),r=md5_ii(r,n,o,i,t[a+11],10,-1120210379),i=md5_ii(i,r,n,o,t[a+2],15,718787259),o=md5_ii(o,i,r,n,t[a+9],21,-343485551),n=safe_add(n,s),o=safe_add(o,u),i=safe_add(i,l),r=safe_add(r,d)}return Array(n,o,i,r)}function md5_cmn(t,e,n,o,i,r){return safe_add(bit_rol(safe_add(safe_add(e,t),safe_add(o,r)),i),n)}function md5_ff(t,e,n,o,i,r,a){return md5_cmn(e&n|~e&o,t,e,i,r,a)}function md5_gg(t,e,n,o,i,r,a){return md5_cmn(e&o|n&~o,t,e,i,r,a)}function md5_hh(t,e,n,o,i,r,a){return md5_cmn(e^n^o,t,e,i,r,a)}function md5_ii(t,e,n,o,i,r,a){return md5_cmn(n^(e|~o),t,e,i,r,a)}function safe_add(t,e){var n=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(n>>16);return o<<16|65535&n}function bit_rol(t,e){return t<<e|t>>>32-e}var App=angular.module("App",["ui.router","ui.bootstrap","templates"]);App.constant("__vkAppId",4468735).constant("__echonest",{key:"JPIQUINIHEVVTYYRU",url:"http://developer.echonest.com/api/v4/"}).constant("__lastfm",{url:"http://ws.audioscrobbler.com/2.0/",keys:{api:"3b716084894fd83886ebe8a20df6bdf0",secret:"abda2711d758f43cbbede5942541f97f"}}),angular.module("App").filter("toGIS",function(){return function(t){if(!t)return"";var e="",n="",o=t;return o=Math.round(o),sec=o%60,min=Math.floor(o/60),10>sec&&(e="0"),10>min&&(n="0"),n+min+":"+e+sec}}).filter("formatBitrate",function(){return function(t){var e="";return 128>t&&(e="< 128"),t>=128&&180>t&&(e="128"),t>=180&&240>t&&(e="192"),t>=240&&300>t&&(e="256"),t>=300&&(e="320"),e+" кбит/с"}}),App.config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(t,e,n,o){o.defaults.useXDomain=!0,delete o.defaults.headers.common["X-Requested-With"],o.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=utf8",n.html5Mode(!0).hashPrefix("!"),e.otherwise("/discover"),t.state("discover",{url:"/discover/?q",controller:"C_discover as ctr",templateUrl:"templates/views/discover/index.html"}).state("artists",{url:"/artists/",controller:"C_artists as ctr",templateUrl:"templates/views/artists/index.html"}).state("artistpage",{url:"/artists/:artist",controller:"C_artists.page as ctr",templateUrl:"templates/views/artists/page.html"}).state("flow",{url:"/flow/?artist&tag",controller:"C_flow as ctr",templateUrl:"templates/views/flow/index.html",reloadOnSearch:!1}).state("playlists",{url:"/playlists/",controller:"C_playlists as ctr",templateUrl:"templates/views/playlists/index.html",reloadOnSearch:!1}).state("share",{url:"/share/:type/:id",controller:"C_share"})}]),App.run(["$rootScope","PS_lastfm","S_sound","PS_vk",function(t,e,n,o){t.$on("$stateChangeStart",function(){t.status="loading"}),o.init(),o.intro(),n.init()}]),angular.module("App").controller("C_controlPanel",["$scope","$http","S_sound",function(t,e,n){function o(t){var e=t.currentTarget,n=e.clientWidth-10,o=t.offsetX-("volumeHider"===t.target.className||"progressHider"===t.target.className?5:0),i=100*(o/n);return i}function i(e){var i=o(e);t.progress=i,n.setProgress(i)}function r(e){var i=o(e);t.volume=i,n.setVolume(i)}function a(){var t=$(".playing").closest(".ng-scope"),e=t.closest(".tracks"),n=e.children();return{tracks:n,length:n.length,index:t.index()}}var s=this;t.playing=!1;var u=!1,l=!1;return t.$on("progressChanged",function(e,n){var o=n.position/n.durationEstimate*100;s.currentTime=n.position/1e3,s.progress=o,t.$$phase||t.$apply()}),t.$on("progressCalculated",function(e,n){s.totalTime=n.durationEstimate/1e3,t.$$phase||t.$apply()}),t.$on("playStateChanged",function(e,n){s.playing=n,t.$$phase||t.$apply()}),t.$on("volumeChanged",function(e,n){s.volume=n,t.$$phase||t.$apply()}),t.$on("trackStarted",function(e,n){t.$apply(function(){s.totalTime=n.duration,s.artist=n.artist,s.title=n.title})}),s.title="asdsad",s.pause=function(){n.togglePause()},s.mouseDown=function(t,e){if(1===t.which){switch(e){case"v":u=!0,r(t);break;case"p":}$("body").on("mouseup",function(){u=!1,l=!1})}},s.mouseMove=function(t,e){switch(e){case"v":u&&r(t);break;case"p":}},s.mouseUp=function(t,e){switch(e){case"v":1===t.which&&(r(t),u=!1);break;case"p":1===t.which&&(i(t),l=!1)}$("body").off("mouseup")},s.play=function(){n.togglePause()},s.next=function(){var t=a();setTimeout(function(){t.index+1>=t.length?t.tracks.eq(0).find(".track").trigger("click"):t.tracks.eq(t.index+1).find(".track").trigger("click")},0)},s.prev=function(){var t=a();setTimeout(function(){0===t.index?t.tracks.eq(t.length-1).find(".track").trigger("click"):t.tracks.eq(t.index-1).find(".track").trigger("click")},0)},s}]),angular.module("App").controller("C_header",["$state","PS_lastfm",function(t,e){var n=this;return n.search=function(n){e.artist.getInfo(n).then(function(e){!e.data.artist||e.data.artist.stats.listeners<100||e.data.artist.name.toLowerCase()!=n.toLowerCase()?t.go("^.discover",{q:n}):t.go("artistpage",{artist:e.data.artist.name})})},n}]),angular.module("App").controller("C_intro",["$scope","$timeout","PS_vk",function(t,e,n){var o=this;return t.$on("userLogin",function(n,i){t.$apply(function(){o.userName=i.name,e(function(){o.hideIntro=!0,e(function(){o.removeIntro=!0},550)},2e3)})}),t.$on("badAuthorization",function(){t.$apply(function(){o.needAuth=!0})}),o.authorize=function(){n.authorize(),o.needAuth=!1},o}]),angular.module("App").directive("albumImage",[function(){return{scope:{info:"="},templateUrl:"templates/directives/albumImage.html"}}]),angular.module("App").directive("minutesScaler",[function(){return{scope:{duration:"="},templateUrl:"templates/directives/minutesScaler.html",link:function(t,e){t.$watch("duration",function(t){if(t){e.html("");for(var n=e[0].offsetWidth,o=t/60,i=n/o,r=Math.ceil(o),a=0;r>a;a++)e.append('<div class="scale" style="left:'+a*i+'px"></div>')}})}}}]),angular.module("App").directive("setBgOnLoad",[function(){return{scope:{src:"@setBgOnLoad"},link:function(t,e){var n=new Image;n.src=t.src,n.onload=function(){e.css({"background-image":"url("+t.src+")"}).addClass("active")}}}}]),angular.module("App").directive("track",["S_sound",function(t){return{scope:{info:"="},templateUrl:"templates/directives/track.html",link:function(e,n){n.on("click",function(){t.createAndPlay(e.info)})}}}]),angular.module("App").service("S_enviroment",[function(){var t={};return t.setTitle=function(t){document.title=t},t}]),angular.module("App").service("S_processing",["$rootScope",function(t){var e={};return e.loading=function(){t.$apply(function(){t.status="loading"})},e.ready=function(){t.$apply(function(){t.status="ready"})},e}]),angular.module("App").service("S_reduce",["$rootScope",function(){var t={};return t.normalizeTopTracks=function(t){return _.reduce(t,function(t,e){return t.push({artist:e.artist.name,title:e.name,duration:e.duration}),t},[])},t}]),angular.module("App").service("S_sound",["$rootScope","S_utils","S_enviroment",function(t,e,n){var o,i,r={},a={};return r.getVolume=function(){var t=e.getCookie("volume");return""===t&&(t=50),+t},r.init=function(){soundManager.setup({url:"/static/js/libs/sm/swf",allowScriptAccess:"always",flashVersion:9,useHighPerformance:!0,preferFlash:!0,useConsole:!1,onready:function(){},onload:function(){},waitForWindowLoad:!0,ontimeout:function(){}}),soundManager.defaultOptions={autoLoad:!0,autoPlay:!1,from:null,loops:1,multiShot:!0,multiShotEvents:!1,pan:0,volume:i,stream:!0},soundManager.onload=function(){var t=r.getVolume();r.setVolume(t),"function"==typeof r.onload&&r.onload()}},r.checkBitRate=function(t,e,n,o){if(a[t])return void(o.bitrate=a[t]);var i=e.lastIndexOf("?");e=e.slice(0,i);{var r="br"+t;soundManager.createSound({volume:10,id:r,url:e,autoLoad:!0,autoPlay:!1,whileloading:function(){if(this.bytesLoaded>50){var e=this.bytesTotal,i=Math.floor(e/1024*8/n);a[t]=i,o.bitrate=i,setTimeout(function(){o.$$phase||o.$apply()},0),this.playState||soundManager.unload(r),o.error=!1}}})}},r.getSound=function(){return o},r.setVolume=function(t){t=+t,0>t&&(t=0),t>100&&(t=100),i=t,o&&o.setVolume(t),e.setCookie("volume",t)},r.setProgress=function(e){e=+e,0>e&&(e=0),e>100&&(e=100),o&&o.setPosition(o.durationEstimate*e/100),t.$broadcast("progressChanged",o)},r.togglePause=function(){return o?(o.togglePause(),!0):!1},r.pause=function(){o&&o.pause()},r.create=function(e,n){var a=e.aid,s=e.url;return r.stopAll(),o&&o.unload(),o=soundManager.createSound({id:a,url:s,volume:i,onfinish:function(){"function"==typeof n&&n()},onload:function(){t.$broadcast("progressCalculated",this)},whileplaying:function(){null!=this.duration&&t.$broadcast("progressChanged",this)},onplay:function(){t.$broadcast("playStateChanged",!0)},onresume:function(){t.$broadcast("playStateChanged",!0)},onpause:function(){t.$broadcast("playStateChanged",!1)}})},r.stopAll=function(){soundManager.stopAll()},r.getMemory=function(){var t=(soundManager.getMemoryUse()/1024/1024).toFixed(2);return t},r.createAndPlay=function(e,o,i){var a=r.create(e,i);a.play(),n.setTitle(e.artist+" – "+e.title),setTimeout(function(){var t=Sound.getSound();t.sID===e.id&&null===t.bytesLoaded&&"function"==typeof o&&o()},1e4),t.$broadcast("trackStarted",e)},r}]),angular.module("App").service("S_utils",[function(){function t(t){var e=["♫","►","=","♥"," ]","★","™","║","●","✖"];t=t.replace(new RegExp("[0-9]+[.]","g"),""),t=t.replace(new RegExp("^[0-9]+[ ]","g"),""),t=t.replace(new RegExp("[(][0-9]+[)]","g"),""),t=t.replace(new RegExp("[(][.]+[)]","g"),""),t=t.replace(new RegExp("www.[0-9^ ]*","g"),""),t=t.replace(new RegExp("club[^ ]*","g"),""),t=t.replace(new RegExp("ё","g"),"е"),t=t.replace(/([^ ]*\.ru)/g,""),t=t.replace(/\[[^]*\]/g,"");for(var n=0;n<e.length;n++)t=t.replace(new RegExp(e[n],"g"),"");return t}var e={};e.setCookie=function(t,e,n){var o;if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),o="; expires="+i.toGMTString()}else o="";document.cookie=t+"="+e+o+"; path=/"},e.getCookie=function(t){return document.cookie.length>0&&(c_start=document.cookie.indexOf(t+"="),-1!=c_start)?(c_start=c_start+t.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},e.filterAudios=function(e,n){for(var o=[],i=e.length,r=0;i>r;r++){var a=e[r],s=t(a.title);"undefined"!=typeof a.duration&&(a.title.length<50||n)&&(a.title=s,a.artist=t(a.artist),o.push(a))}return o},e.shuffleArray=function(t){for(var e,n,o=t.length;0!==o;)n=Math.floor(Math.random()*o),o-=1,e=t[o],t[o]=t[n],t[n]=e;return t};var n=function(){return document.addEventListener?function(t,e,o){if(t&&t.nodeName||t===window)t.addEventListener(e,o,!1);else if(t&&t.length)for(var i=0;i<t.length;i++)n(t[i],e,o)}:function(t,e,o){if(t&&t.nodeName||t===window)t.attachEvent("on"+e,function(){return o.call(t,window.event)});else if(t&&t.length)for(var i=0;i<t.length;i++)n(t[i],e,o)}}();return e}]);var hexcase=0;!function(t,e){"use strict";function n(n,o){function i(t){return fe.preferFlash&&ae&&!fe.ignoreFlash&&fe.flash[t]!==e&&fe.flash[t]}function r(t){return function(e){var n,o=this._s;return n=o&&o._a?t.call(this,e):null}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!1,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=o||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20140901",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var a,s,u,l,d,c,p,f,h,m,g,_,v,y,b,w,T,k,O,S,V,A,x,M,C,K,P,I,L,E,D,U,H,W,F,B,R,$,N,j,q,X,z,J,G,Q,Y,Z,te,ee,ne,oe,ie,re,ae,se,ue,le,de,ce,pe,fe=this,he=null,me=null,ge=navigator.userAgent,_e=t.location.href.toString(),ve=document,ye=[],be=!1,we=!1,Te=!1,ke=!1,Oe=!1,Se=8,Ve=null,Ae=null,xe=!1,Me=!1,Ce=0,Ke=null,Pe=[],Ie=null,Le=Array.prototype.slice,Ee=!1,De=0,Ue=ge.match(/(ipad|iphone|ipod)/i),He=ge.match(/android/i),We=ge.match(/msie/i),Fe=ge.match(/webkit/i),Be=ge.match(/safari/i)&&!ge.match(/chrome/i),Re=ge.match(/opera/i),$e=ge.match(/(mobile|pre\/|xoom)/i)||Ue||He,Ne=!_e.match(/usehtml5audio/i)&&!_e.match(/sm2\-ignorebadua/i)&&Be&&!ge.match(/silk/i)&&ge.match(/OS X 10_6_([3-7])/i),je=(t.console!==e&&console.log!==e,ve.hasFocus!==e?ve.hasFocus():null),qe=Be&&(ve.hasFocus===e||!ve.hasFocus()),Xe=!qe,ze=/(mp3|mp4|mpa|m4a|m4b)/i,Je=1e3,Ge="about:blank",Qe="data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==",Ye=ve.location?ve.location.protocol.match(/http/i):null,Ze=Ye?"":"http://",tn=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,en=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],nn=new RegExp("\\.("+en.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!Ye,B={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==e&&(Re&&opera!==e&&opera.version()<10?new Audio(null):new Audio).canPlayType!==e}catch(t){return!1}}(),this.setup=function(t){var n=!fe.url;return t!==e&&Te&&Ie&&fe.ok()&&(t.flashVersion!==e||t.url!==e||t.html5Test!==e),h(t),t&&(n&&M&&t.url!==e&&fe.beginDelayedInit(),M||t.url===e||"complete"!==ve.readyState||setTimeout(A,1)),fe},this.ok=function(){return Ie?Te&&!ke:fe.useHTML5Audio&&fe.hasHTML5},this.supported=this.ok,this.getMovie=function(e){return s(e)||ve[e]||t[e]},this.createSound=function(t,n){function o(){return r=R(r),fe.sounds[r.id]=new a(r),fe.soundIDs.push(r.id),fe.sounds[r.id]}var i,r,s=null;if(!Te||!fe.ok())return!1;if(n!==e&&(t={id:t,url:n}),r=f(t),r.url=J(r.url),void 0===r.id&&(r.id=fe.setupOptions.idPrefix+De++),j(r.id,!0))return fe.sounds[r.id];if(Y(r))s=o(),s._setup_html5(r);else{if(fe.html5Only)return o();if(fe.html5.usingFlash&&r.url&&r.url.match(/data\:/i))return o();c>8&&null===r.isMovieStar&&(r.isMovieStar=!!(r.serverURL||(r.type?r.type.match(tn):!1)||r.url&&r.url.match(nn))),r=$(r,i),s=o(),8===c?me._createSound(r.id,r.loops||1,r.usePolicyFile):(me._createSound(r.id,r.url,r.usePeakData,r.useWaveformData,r.useEQData,r.isMovieStar,r.isMovieStar?r.bufferTime:!1,r.loops||1,r.serverURL,r.duration||null,r.autoPlay,!0,r.autoLoad,r.usePolicyFile),r.serverURL||(s.connected=!0,r.onconnect&&r.onconnect.apply(s))),r.serverURL||!r.autoLoad&&!r.autoPlay||s.load(r)}return!r.serverURL&&r.autoPlay&&s.play(),s},this.destroySound=function(t,e){if(!j(t))return!1;var n,o=fe.sounds[t];for(o._iO={},o.stop(),o.unload(),n=0;n<fe.soundIDs.length;n++)if(fe.soundIDs[n]===t){fe.soundIDs.splice(n,1);break}return e||o.destruct(!0),o=null,delete fe.sounds[t],!0},this.load=function(t,e){return j(t)?fe.sounds[t].load(e):!1},this.unload=function(t){return j(t)?fe.sounds[t].unload():!1},this.onPosition=function(t,e,n,o){return j(t)?fe.sounds[t].onposition(e,n,o):!1},this.onposition=this.onPosition,this.clearOnPosition=function(t,e,n){return j(t)?fe.sounds[t].clearOnPosition(e,n):!1},this.play=function(t,e){var n=null,o=e&&!(e instanceof Object);if(!Te||!fe.ok())return!1;if(j(t,o))o&&(e={url:e});else{if(!o)return!1;o&&(e={url:e}),e&&e.url&&(e.id=t,n=fe.createSound(e).play())}return null===n&&(n=fe.sounds[t].play(e)),n},this.start=this.play,this.setPosition=function(t,e){return j(t)?fe.sounds[t].setPosition(e):!1},this.stop=function(t){return j(t)?fe.sounds[t].stop():!1},this.stopAll=function(){var t;for(t in fe.sounds)fe.sounds.hasOwnProperty(t)&&fe.sounds[t].stop()},this.pause=function(t){return j(t)?fe.sounds[t].pause():!1},this.pauseAll=function(){var t;for(t=fe.soundIDs.length-1;t>=0;t--)fe.sounds[fe.soundIDs[t]].pause()},this.resume=function(t){return j(t)?fe.sounds[t].resume():!1},this.resumeAll=function(){var t;for(t=fe.soundIDs.length-1;t>=0;t--)fe.sounds[fe.soundIDs[t]].resume()},this.togglePause=function(t){return j(t)?fe.sounds[t].togglePause():!1},this.setPan=function(t,e){return j(t)?fe.sounds[t].setPan(e):!1},this.setVolume=function(t,e){return j(t)?fe.sounds[t].setVolume(e):!1},this.mute=function(t){var e=0;if(t instanceof String&&(t=null),t)return j(t)?fe.sounds[t].mute():!1;for(e=fe.soundIDs.length-1;e>=0;e--)fe.sounds[fe.soundIDs[e]].mute();
return fe.muted=!0,!0},this.muteAll=function(){fe.mute()},this.unmute=function(t){var e;if(t instanceof String&&(t=null),t)return j(t)?fe.sounds[t].unmute():!1;for(e=fe.soundIDs.length-1;e>=0;e--)fe.sounds[fe.soundIDs[e]].unmute();return fe.muted=!1,!0},this.unmuteAll=function(){fe.unmute()},this.toggleMute=function(t){return j(t)?fe.sounds[t].toggleMute():!1},this.getMemoryUse=function(){var t=0;return me&&8!==c&&(t=parseInt(me._getMemoryUse(),10)),t},this.disable=function(n){var o;if(n===e&&(n=!1),ke)return!1;for(ke=!0,o=fe.soundIDs.length-1;o>=0;o--)E(fe.sounds[fe.soundIDs[o]]);return p(n),ie.remove(t,"load",v),!0},this.canPlayMIME=function(t){var e;return fe.hasHTML5&&(e=Z({type:t})),!e&&Ie&&(e=t&&fe.ok()?!!((c>8?t.match(tn):null)||t.match(fe.mimePattern)):null),e},this.canPlayURL=function(t){var e;return fe.hasHTML5&&(e=Z({url:t})),!e&&Ie&&(e=t&&fe.ok()?!!t.match(fe.filePattern):null),e},this.canPlayLink=function(t){return t.type!==e&&t.type&&fe.canPlayMIME(t.type)?!0:fe.canPlayURL(t.href)},this.getSoundById=function(t){if(!t)return null;var e=fe.sounds[t];return e},this.onready=function(e,n){var o="onready",i=!1;if("function"!=typeof e)throw H("needFunction",o);return n||(n=t),g(o,e,n),_(),i=!0,i},this.ontimeout=function(e,n){var o="ontimeout",i=!1;if("function"!=typeof e)throw H("needFunction",o);return n||(n=t),g(o,e,n),_({type:o}),i=!0,i},this._writeDebug=function(){return!0},this._wD=this._writeDebug,this._debug=function(){},this.reboot=function(e,n){var o,i,r;for(o=fe.soundIDs.length-1;o>=0;o--)fe.sounds[fe.soundIDs[o]].destruct();if(me)try{We&&(Ae=me.innerHTML),Ve=me.parentNode.removeChild(me)}catch(a){}if(Ae=Ve=Ie=me=null,fe.enabled=M=Te=xe=Me=be=we=ke=Ee=fe.swfLoaded=!1,fe.soundIDs=[],fe.sounds={},De=0,e)ye=[];else for(o in ye)if(ye.hasOwnProperty(o))for(i=0,r=ye[o].length;r>i;i++)ye[o][i].fired=!1;return fe.html5={usingFlash:null},fe.flash={},fe.html5Only=!1,fe.ignoreFlash=!1,t.setTimeout(function(){V(),n||fe.beginDelayedInit()},20),fe},this.reset=function(){return fe.reboot(!0,!0)},this.getMoviePercent=function(){return me&&"PercentLoaded"in me?me.PercentLoaded():null},this.beginDelayedInit=function(){Oe=!0,A(),setTimeout(function(){return Me?!1:(K(),S(),Me=!0,!0)},20),y()},this.destruct=function(){fe.disable(!0)},a=function(t){var n,o,i,r,a,s,u,l,d,p,h=this,m=!1,g=[],_=0,v=null;d={duration:null,time:null},this.id=t.id,this.sID=this.id,this.url=t.url,this.options=f(t),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,p=this.url?!1:!0,this.id3={},this._debug=function(){},this.load=function(t){var n,o=null;if(t!==e?h._iO=f(t,h.options):(t=h.options,h._iO=t,v&&v!==h.url&&(h._iO.url=h.url,h.url=null)),h._iO.url||(h._iO.url=h.url),h._iO.url=J(h._iO.url),h.instanceOptions=h._iO,n=h._iO,!n.url&&!h.url)return h;if(n.url===h.url&&0!==h.readyState&&2!==h.readyState)return 3===h.readyState&&n.onload&&pe(h,function(){n.onload.apply(h,[!!h.duration])}),h;if(h.loaded=!1,h.readyState=1,h.playState=0,h.id3={},Y(n))o=h._setup_html5(n),o._called_load||(h._html5_canplay=!1,h.url!==n.url&&(h._a.src=n.url,h.setPosition(0)),h._a.autobuffer="auto",h._a.preload="auto",h._a._called_load=!0);else{if(fe.html5Only)return h;if(h._iO.url&&h._iO.url.match(/data\:/i))return h;try{h.isHTML5=!1,h._iO=$(R(n)),h._iO.autoPlay&&(h._iO.position||h._iO.from)&&(h._iO.autoPlay=!1),n=h._iO,8===c?me._load(h.id,n.url,n.stream,n.autoPlay,n.usePolicyFile):me._load(h.id,n.url,!!n.stream,!!n.autoPlay,n.loops||1,!!n.autoLoad,n.usePolicyFile)}catch(i){P({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return h.url=n.url,h},this.unload=function(){return 0!==h.readyState&&(h.isHTML5?(r(),h._a&&(h._a.pause(),v=ee(h._a))):8===c?me._unload(h.id,Ge):me._unload(h.id),n()),h},this.destruct=function(t){h.isHTML5?(r(),h._a&&(h._a.pause(),ee(h._a),Ee||i(),h._a._s=null,h._a=null)):(h._iO.onfailure=null,me._destroySound(h.id)),t||fe.destroySound(h.id,!0)},this.play=function(t,n){var o,i,r,u,d,g,_=!0,v=null;if(n=n===e?!0:n,t||(t={}),h.url&&(h._iO.url=h.url),h._iO=f(h._iO,h.options),h._iO=f(t,h._iO),h._iO.url=J(h._iO.url),h.instanceOptions=h._iO,!h.isHTML5&&h._iO.serverURL&&!h.connected)return h.getAutoPlay()||h.setAutoPlay(!0),h;if(Y(h._iO)&&(h._setup_html5(h._iO),a()),1!==h.playState||h.paused||(o=h._iO.multiShot,o||(h.isHTML5&&h.setPosition(h._iO.position),v=h)),null!==v)return v;if(t.url&&t.url!==h.url&&(h.readyState||h.isHTML5||8!==c||!p?h.load(h._iO):p=!1),h.loaded||(0===h.readyState?(h.isHTML5||fe.html5Only?h.isHTML5?h.load(h._iO):v=h:(h._iO.autoPlay=!0,h.load(h._iO)),h.instanceOptions=h._iO):2===h.readyState&&(v=h)),null!==v)return v;if(!h.isHTML5&&9===c&&h.position>0&&h.position===h.duration&&(t.position=0),h.paused&&h.position>=0&&(!h._iO.serverURL||h.position>0))h.resume();else{if(h._iO=f(t,h._iO),(!h.isHTML5&&null!==h._iO.position&&h._iO.position>0||null!==h._iO.from&&h._iO.from>0||null!==h._iO.to)&&0===h.instanceCount&&0===h.playState&&!h._iO.serverURL){if(r=function(){h._iO=f(t,h._iO),h.play(h._iO)},h.isHTML5&&!h._html5_canplay?(h.load({_oncanplay:r}),v=!1):h.isHTML5||h.loaded||h.readyState&&2===h.readyState||(h.load({onload:r}),v=!1),null!==v)return v;h._iO=l()}(!h.instanceCount||h._iO.multiShotEvents||h.isHTML5&&h._iO.multiShot&&!Ee||!h.isHTML5&&c>8&&!h.getAutoPlay())&&h.instanceCount++,h._iO.onposition&&0===h.playState&&s(h),h.playState=1,h.paused=!1,h.position=h._iO.position===e||isNaN(h._iO.position)?0:h._iO.position,h.isHTML5||(h._iO=$(R(h._iO))),h._iO.onplay&&n&&(h._iO.onplay.apply(h),m=!0),h.setVolume(h._iO.volume,!0),h.setPan(h._iO.pan,!0),h.isHTML5?h.instanceCount<2?(a(),i=h._setup_html5(),h.setPosition(h._iO.position),i.play()):(u=new Audio(h._iO.url),d=function(){ie.remove(u,"ended",d),h._onfinish(h),ee(u),u=null},g=function(){ie.remove(u,"canplay",g);try{u.currentTime=h._iO.position/Je}catch(t){}u.play()},ie.add(u,"ended",d),void 0!==h._iO.volume&&(u.volume=Math.max(0,Math.min(1,h._iO.volume/100))),h.muted&&(u.muted=!0),h._iO.position?ie.add(u,"canplay",g):u.play()):(_=me._start(h.id,h._iO.loops||1,9===c?h.position:h.position/Je,h._iO.multiShot||!1),9!==c||_||h._iO.onplayerror&&h._iO.onplayerror.apply(h))}return h},this.start=this.play,this.stop=function(t){var e,n=h._iO;return 1===h.playState&&(h._onbufferchange(0),h._resetOnPosition(0),h.paused=!1,h.isHTML5||(h.playState=0),u(),n.to&&h.clearOnPosition(n.to),h.isHTML5?h._a&&(e=h.position,h.setPosition(0),h.position=e,h._a.pause(),h.playState=0,h._onTimer(),r()):(me._stop(h.id,t),n.serverURL&&h.unload()),h.instanceCount=0,h._iO={},n.onstop&&n.onstop.apply(h)),h},this.setAutoPlay=function(t){h._iO.autoPlay=t,h.isHTML5||(me._setAutoPlay(h.id,t),t&&(h.instanceCount||1!==h.readyState||h.instanceCount++))},this.getAutoPlay=function(){return h._iO.autoPlay},this.setPosition=function(t){t===e&&(t=0);var n,o,i=h.isHTML5?Math.max(t,0):Math.min(h.duration||h._iO.duration,Math.max(t,0));if(h.position=i,o=h.position/Je,h._resetOnPosition(h.position),h._iO.position=i,h.isHTML5){if(h._a){if(h._html5_canplay){if(h._a.currentTime!==o)try{h._a.currentTime=o,(0===h.playState||h.paused)&&h._a.pause()}catch(r){}}else if(o)return h;h.paused&&h._onTimer(!0)}}else n=9===c?h.position:o,h.readyState&&2!==h.readyState&&me._setPosition(h.id,n,h.paused||!h.playState,h._iO.multiShot);return h},this.pause=function(t){return h.paused||0===h.playState&&1!==h.readyState?h:(h.paused=!0,h.isHTML5?(h._setup_html5().pause(),r()):(t||t===e)&&me._pause(h.id,h._iO.multiShot),h._iO.onpause&&h._iO.onpause.apply(h),h)},this.resume=function(){var t=h._iO;return h.paused?(h.paused=!1,h.playState=1,h.isHTML5?(h._setup_html5().play(),a()):(t.isMovieStar&&!t.serverURL&&h.setPosition(h.position),me._pause(h.id,t.multiShot)),!m&&t.onplay?(t.onplay.apply(h),m=!0):t.onresume&&t.onresume.apply(h),h):h},this.togglePause=function(){return 0===h.playState?(h.play({position:9!==c||h.isHTML5?h.position/Je:h.position}),h):(h.paused?h.resume():h.pause(),h)},this.setPan=function(t,n){return t===e&&(t=0),n===e&&(n=!1),h.isHTML5||me._setPan(h.id,t),h._iO.pan=t,n||(h.pan=t,h.options.pan=t),h},this.setVolume=function(t,n){return t===e&&(t=100),n===e&&(n=!1),h.isHTML5?h._a&&(fe.muted&&!h.muted&&(h.muted=!0,h._a.muted=!0),h._a.volume=Math.max(0,Math.min(1,t/100))):me._setVolume(h.id,fe.muted&&!h.muted||h.muted?0:t),h._iO.volume=t,n||(h.volume=t,h.options.volume=t),h},this.mute=function(){return h.muted=!0,h.isHTML5?h._a&&(h._a.muted=!0):me._setVolume(h.id,0),h},this.unmute=function(){h.muted=!1;var t=h._iO.volume!==e;return h.isHTML5?h._a&&(h._a.muted=!1):me._setVolume(h.id,t?h._iO.volume:h.options.volume),h},this.toggleMute=function(){return h.muted?h.unmute():h.mute()},this.onPosition=function(t,n,o){return g.push({position:parseInt(t,10),method:n,scope:o!==e?o:h,fired:!1}),h},this.onposition=this.onPosition,this.clearOnPosition=function(t,e){var n;if(t=parseInt(t,10),isNaN(t))return!1;for(n=0;n<g.length;n++)t===g[n].position&&(e&&e!==g[n].method||(g[n].fired&&_--,g.splice(n,1)))},this._processOnPosition=function(){var t,e,n=g.length;if(!n||!h.playState||_>=n)return!1;for(t=n-1;t>=0;t--)e=g[t],!e.fired&&h.position>=e.position&&(e.fired=!0,_++,e.method.apply(e.scope,[e.position]),n=g.length);return!0},this._resetOnPosition=function(t){var e,n,o=g.length;if(!o)return!1;for(e=o-1;e>=0;e--)n=g[e],n.fired&&t<=n.position&&(n.fired=!1,_--);return!0},l=function(){var t,e,n=h._iO,o=n.from,i=n.to;return e=function(){h.clearOnPosition(i,e),h.stop()},t=function(){null===i||isNaN(i)||h.onPosition(i,e)},null===o||isNaN(o)||(n.position=o,n.multiShot=!1,t()),n},s=function(){var t,e=h._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&h.onPosition(parseInt(t,10),e[t])},u=function(){var t,e=h._iO.onposition;if(e)for(t in e)e.hasOwnProperty(t)&&h.clearOnPosition(parseInt(t,10))},a=function(){h.isHTML5&&q(h)},r=function(){h.isHTML5&&X(h)},n=function(t){t||(g=[],_=0),m=!1,h._hasTimer=null,h._a=null,h._html5_canplay=!1,h.bytesLoaded=null,h.bytesTotal=null,h.duration=h._iO&&h._iO.duration?h._iO.duration:null,h.durationEstimate=null,h.buffered=[],h.eqData=[],h.eqData.left=[],h.eqData.right=[],h.failures=0,h.isBuffering=!1,h.instanceOptions={},h.instanceCount=0,h.loaded=!1,h.metadata={},h.readyState=0,h.muted=!1,h.paused=!1,h.peakData={left:0,right:0},h.waveformData={left:[],right:[]},h.playState=0,h.position=null,h.id3={}},n(),this._onTimer=function(t){var e,n,o=!1,i={};return h._hasTimer||t?(h._a&&(t||(h.playState>0||1===h.readyState)&&!h.paused)&&(e=h._get_html5_duration(),e!==d.duration&&(d.duration=e,h.duration=e,o=!0),h.durationEstimate=h.duration,n=h._a.currentTime*Je||0,n!==d.time&&(d.time=n,o=!0),(o||t)&&h._whileplaying(n,i,i,i,i)),o):void 0},this._get_html5_duration=function(){var t=h._iO,e=h._a&&h._a.duration?h._a.duration*Je:t&&t.duration?t.duration:null,n=e&&!isNaN(e)&&1/0!==e?e:null;return n},this._apply_loop=function(t,e){t.loop=e>1?"loop":""},this._setup_html5=function(t){var e,i=f(h._iO,t),r=Ee?he:h._a,a=decodeURI(i.url);if(Ee?a===decodeURI(re)&&(e=!0):a===decodeURI(v)&&(e=!0),r){if(r._s)if(Ee)r._s&&r._s.playState&&!e&&r._s.stop();else if(!Ee&&a===decodeURI(v))return h._apply_loop(r,i.loops),r;e||(v&&n(!1),r.src=i.url,h.url=i.url,v=i.url,re=i.url,r._called_load=!1)}else i.autoLoad||i.autoPlay?(h._a=new Audio(i.url),h._a.load()):h._a=Re&&opera.version()<10?new Audio(null):new Audio,r=h._a,r._called_load=!1,Ee&&(he=r);return h.isHTML5=!0,h._a=r,r._s=h,o(),h._apply_loop(r,i.loops),i.autoLoad||i.autoPlay?h.load():(r.autobuffer=!1,r.preload="auto"),r},o=function(){function t(t,e,n){return h._a?h._a.addEventListener(t,e,n||!1):null}if(h._a._added_events)return!1;var e;h._a._added_events=!0;for(e in le)le.hasOwnProperty(e)&&t(e,le[e]);return!0},i=function(){function t(t,e,n){return h._a?h._a.removeEventListener(t,e,n||!1):null}var e;h._a._added_events=!1;for(e in le)le.hasOwnProperty(e)&&t(e,le[e])},this._onload=function(t){var e=!!t||!h.isHTML5&&8===c&&h.duration;return h.loaded=e,h.readyState=e?3:2,h._onbufferchange(0),h._iO.onload&&pe(h,function(){h._iO.onload.apply(h,[e])}),!0},this._onbufferchange=function(t){return 0===h.playState?!1:t&&h.isBuffering||!t&&!h.isBuffering?!1:(h.isBuffering=1===t,h._iO.onbufferchange&&h._iO.onbufferchange.apply(h,[t]),!0)},this._onsuspend=function(){return h._iO.onsuspend&&h._iO.onsuspend.apply(h),!0},this._onfailure=function(t,e,n){h.failures++,h._iO.onfailure&&1===h.failures&&h._iO.onfailure(t,e,n)},this._onwarning=function(t,e,n){h._iO.onwarning&&h._iO.onwarning(t,e,n)},this._onfinish=function(){var t=h._iO.onfinish;h._onbufferchange(0),h._resetOnPosition(0),h.instanceCount&&(h.instanceCount--,h.instanceCount||(u(),h.playState=0,h.paused=!1,h.instanceCount=0,h.instanceOptions={},h._iO={},r(),h.isHTML5&&(h.position=0)),(!h.instanceCount||h._iO.multiShotEvents)&&t&&pe(h,function(){t.apply(h)}))},this._whileloading=function(t,e,n,o){var i=h._iO;h.bytesLoaded=t,h.bytesTotal=e,h.duration=Math.floor(n),h.bufferLength=o,h.durationEstimate=h.isHTML5||i.isMovieStar?h.duration:i.duration?h.duration>i.duration?h.duration:i.duration:parseInt(h.bytesTotal/h.bytesLoaded*h.duration,10),h.isHTML5||(h.buffered=[{start:0,end:h.duration}]),(3!==h.readyState||h.isHTML5)&&i.whileloading&&i.whileloading.apply(h)},this._whileplaying=function(t,n,o,i,r){var a,s=h._iO;return isNaN(t)||null===t?!1:(h.position=Math.max(0,t),h._processOnPosition(),!h.isHTML5&&c>8&&(s.usePeakData&&n!==e&&n&&(h.peakData={left:n.leftPeak,right:n.rightPeak}),s.useWaveformData&&o!==e&&o&&(h.waveformData={left:o.split(","),right:i.split(",")}),s.useEQData&&r!==e&&r&&r.leftEQ&&(a=r.leftEQ.split(","),h.eqData=a,h.eqData.left=a,r.rightEQ!==e&&r.rightEQ&&(h.eqData.right=r.rightEQ.split(",")))),1===h.playState&&(h.isHTML5||8!==c||h.position||!h.isBuffering||h._onbufferchange(0),s.whileplaying&&s.whileplaying.apply(h)),!0)},this._oncaptiondata=function(t){h.captiondata=t,h._iO.oncaptiondata&&h._iO.oncaptiondata.apply(h,[t])},this._onmetadata=function(t,e){var n,o,i={};for(n=0,o=t.length;o>n;n++)i[t[n]]=e[n];h.metadata=i,console.log("updated metadata",h.metadata),h._iO.onmetadata&&h._iO.onmetadata.call(h,h.metadata)},this._onid3=function(t,e){var n,o,i=[];for(n=0,o=t.length;o>n;n++)i[t[n]]=e[n];h.id3=f(h.id3,i),h._iO.onid3&&h._iO.onid3.apply(h)},this._onconnect=function(t){t=1===t,h.connected=t,t&&(h.failures=0,j(h.id)&&(h.getAutoPlay()?h.play(e,h.getAutoPlay()):h._iO.autoLoad&&h.load()),h._iO.onconnect&&h._iO.onconnect.apply(h,[t]))},this._ondataerror=function(){h.playState>0&&h._iO.ondataerror&&h._iO.ondataerror.apply(h)}},C=function(){return ve.body||ve.getElementsByTagName("div")[0]},s=function(t){return ve.getElementById(t)},f=function(t,n){var o,i,r=t||{};o=n===e?fe.defaultOptions:n;for(i in o)o.hasOwnProperty(i)&&r[i]===e&&(r[i]="object"!=typeof o[i]||null===o[i]?o[i]:f(r[i],o[i]));return r},pe=function(e,n){e.isHTML5||8!==c?n():t.setTimeout(n,0)},m={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},h=function(t,n){var o,i=!0,r=n!==e,a=fe.setupOptions,s=m;for(o in t)if(t.hasOwnProperty(o))if("object"!=typeof t[o]||null===t[o]||t[o]instanceof Array||t[o]instanceof RegExp)r&&s[n]!==e?fe[n][o]=t[o]:a[o]!==e?(fe.setupOptions[o]=t[o],fe[o]=t[o]):s[o]===e?i=!1:fe[o]instanceof Function?fe[o].apply(fe,t[o]instanceof Array?t[o]:[t[o]]):fe[o]=t[o];else{if(s[o]!==e)return h(t[o],o);i=!1}return i},ie=function(){function e(t){var e=Le.call(t),n=e.length;return r?(e[1]="on"+e[1],n>3&&e.pop()):3===n&&e.push(!1),e}function n(t,e){var n=t.shift(),o=[a[e]];r?n[o](t[0],t[1]):n[o].apply(n,t)}function o(){n(e(arguments),"add")}function i(){n(e(arguments),"remove")}var r=t.attachEvent,a={add:r?"attachEvent":"addEventListener",remove:r?"detachEvent":"removeEventListener"};return{add:o,remove:i}}(),le={abort:r(function(){}),canplay:r(function(){var t,n=this._s;if(n._html5_canplay)return!0;if(n._html5_canplay=!0,n._onbufferchange(0),t=n._iO.position===e||isNaN(n._iO.position)?null:n._iO.position/Je,this.currentTime!==t)try{this.currentTime=t}catch(o){}n._iO._oncanplay&&n._iO._oncanplay()}),canplaythrough:r(function(){var t=this._s;t.loaded||(t._onbufferchange(0),t._whileloading(t.bytesLoaded,t.bytesTotal,t._get_html5_duration()),t._onload(!0))}),durationchange:r(function(){var t,e=this._s;t=e._get_html5_duration(),isNaN(t)||t===e.duration||(e.durationEstimate=e.duration=t)}),ended:r(function(){var t=this._s;t._onfinish()}),error:r(function(){this._s._onload(!1)}),loadeddata:r(function(){var t=this._s;t._loaded||Be||(t.duration=t._get_html5_duration())}),loadedmetadata:r(function(){}),loadstart:r(function(){this._s._onbufferchange(1)}),play:r(function(){this._s._onbufferchange(0)}),playing:r(function(){this._s._onbufferchange(0)}),progress:r(function(t){var e,n,o=this._s,i=0,r=("progress"===t.type,t.target.buffered),a=t.loaded||0,s=t.total||1;if(o.buffered=[],r&&r.length){for(e=0,n=r.length;n>e;e++)o.buffered.push({start:r.start(e)*Je,end:r.end(e)*Je});i=(r.end(0)-r.start(0))*Je,a=Math.min(1,i/(t.target.duration*Je))}isNaN(a)||(o._whileloading(a,s,o._get_html5_duration()),a&&s&&a===s&&le.canplaythrough.call(this,t))}),ratechange:r(function(){}),suspend:r(function(t){var e=this._s;le.progress.call(this,t),e._onsuspend()}),stalled:r(function(){}),timeupdate:r(function(){this._s._onTimer()}),waiting:r(function(){var t=this._s;t._onbufferchange(1)})},Y=function(t){var e;return e=t&&(t.type||t.url||t.serverURL)?t.serverURL||t.type&&i(t.type)?!1:t.type?Z({type:t.type}):Z({url:t.url})||fe.html5Only||t.url.match(/data\:/i):!1},ee=function(t){var e;return t&&(e=Be?Ge:fe.html5.canPlayType("audio/wav")?Qe:Ge,t.src=e,void 0!==t._called_unload&&(t._called_load=!1)),Ee&&(re=null),e},Z=function(t){if(!fe.useHTML5Audio||!fe.hasHTML5)return!1;var n,o,r,a,s=t.url||null,u=t.type||null,l=fe.audioFormats;if(u&&fe.html5[u]!==e)return fe.html5[u]&&!i(u);if(!te){te=[];for(a in l)l.hasOwnProperty(a)&&(te.push(a),l[a].related&&(te=te.concat(l[a].related)));te=new RegExp("\\.("+te.join("|")+")(\\?.*)?$","i")}return r=s?s.toLowerCase().match(te):null,r&&r.length?r=r[1]:u?(o=u.indexOf(";"),r=(-1!==o?u.substr(0,o):u).substr(6)):n=!1,r&&fe.html5[r]!==e?n=fe.html5[r]&&!i(r):(u="audio/"+r,n=fe.html5.canPlayType({type:u}),fe.html5[r]=n,n=n&&fe.html5[u]&&!i(u)),n},oe=function(){function t(t){var e,n,o=!1,i=!1;if(!a||"function"!=typeof a.canPlayType)return o;if(t instanceof Array){for(r=0,n=t.length;n>r;r++)(fe.html5[t[r]]||a.canPlayType(t[r]).match(fe.html5Test))&&(i=!0,fe.html5[t[r]]=!0,fe.flash[t[r]]=!!t[r].match(ze));o=i}else e=a&&"function"==typeof a.canPlayType?a.canPlayType(t):!1,o=!(!e||!e.match(fe.html5Test));return o}if(!fe.useHTML5Audio||!fe.hasHTML5)return fe.html5.usingFlash=!0,Ie=!0,!1;var n,o,i,r,a=Audio!==e?Re&&opera.version()<10?new Audio(null):new Audio:null,s={};i=fe.audioFormats;for(n in i)if(i.hasOwnProperty(n)&&(o="audio/"+n,s[n]=t(i[n].type),s[o]=s[n],n.match(ze)?(fe.flash[n]=!0,fe.flash[o]=!0):(fe.flash[n]=!1,fe.flash[o]=!1),i[n]&&i[n].related))for(r=i[n].related.length-1;r>=0;r--)s["audio/"+i[n].related[r]]=s[n],fe.html5[i[n].related[r]]=s[n],fe.flash[i[n].related[r]]=s[n];return s.canPlayType=a?t:null,fe.html5=f(fe.html5,s),fe.html5.usingFlash=Q(),Ie=fe.html5.usingFlash,!0},O={},H=function(){},R=function(t){return 8===c&&t.loops>1&&t.stream&&(t.stream=!1),t},$=function(t){return t&&!t.usePolicyFile&&(t.onid3||t.usePeakData||t.useWaveformData||t.useEQData)&&(t.usePolicyFile=!0),t},N=function(){},u=function(){return!1},E=function(t){var e;for(e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=u);e=null},D=function(t){t===e&&(t=!1),(ke||t)&&fe.disable(t)},U=function(t){var e,n=null;if(t)if(t.match(/\.swf(\?.*)?$/i)){if(n=t.substr(t.toLowerCase().lastIndexOf(".swf?")+4))return t}else t.lastIndexOf("/")!==t.length-1&&(t+="/");return e=(t&&-1!==t.lastIndexOf("/")?t.substr(0,t.lastIndexOf("/")+1):"./")+fe.movieURL,fe.noSWFCache&&(e+="?ts="+(new Date).getTime()),e},T=function(){c=parseInt(fe.flashVersion,10),8!==c&&9!==c&&(fe.flashVersion=c=Se);var t=fe.debugMode||fe.debugFlash?"_debug.swf":".swf";fe.useHTML5Audio&&!fe.html5Only&&fe.audioFormats.mp4.required&&9>c&&(fe.flashVersion=c=9),fe.version=fe.versionNumber+(fe.html5Only?" (HTML5-only mode)":9===c?" (AS3/Flash 9)":" (AS2/Flash 8)"),c>8?(fe.defaultOptions=f(fe.defaultOptions,fe.flash9Options),fe.features.buffering=!0,fe.defaultOptions=f(fe.defaultOptions,fe.movieStarOptions),fe.filePatterns.flash9=new RegExp("\\.(mp3|"+en.join("|")+")(\\?.*)?$","i"),fe.features.movieStar=!0):fe.features.movieStar=!1,fe.filePattern=fe.filePatterns[8!==c?"flash9":"flash8"],fe.movieURL=(8===c?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",t),fe.features.peakData=fe.features.waveformData=fe.features.eqData=c>8},I=function(t,e){return me?void me._setPolling(t,e):!1},L=function(){},j=this.getSoundById,F=function(){var t=[];return fe.debugMode&&t.push(B.sm2Debug),fe.debugFlash&&t.push(B.flashDebug),fe.useHighPerformance&&t.push(B.highPerf),t.join(" ")},W=function(){var t=(H("fbHandler"),fe.getMoviePercent()),e=B,n={type:"FLASHBLOCK"};return fe.html5Only?!1:void(fe.ok()?fe.oMC&&(fe.oMC.className=[F(),e.swfDefault,e.swfLoaded+(fe.didFlashBlock?" "+e.swfUnblocked:"")].join(" ")):(Ie&&(fe.oMC.className=F()+" "+e.swfDefault+" "+(null===t?e.swfTimedout:e.swfError)),fe.didFlashBlock=!0,_({type:"ontimeout",ignoreInit:!0,error:n}),P(n)))},g=function(t,n,o){ye[t]===e&&(ye[t]=[]),ye[t].push({method:n,scope:o||null,fired:!1})},_=function(t){if(t||(t={type:fe.ok()?"onready":"ontimeout"}),!Te&&t&&!t.ignoreInit)return!1;if("ontimeout"===t.type&&(fe.ok()||ke&&!t.ignoreInit))return!1;var e,n,o={success:t&&t.ignoreInit?fe.ok():!ke},i=t&&t.type?ye[t.type]||[]:[],r=[],a=[o],s=Ie&&!fe.ok();for(t.error&&(a[0].error=t.error),e=0,n=i.length;n>e;e++)i[e].fired!==!0&&r.push(i[e]);if(r.length)for(e=0,n=r.length;n>e;e++)r[e].scope?r[e].method.apply(r[e].scope,a):r[e].method.apply(this,a),s||(r[e].fired=!0);return!0},v=function(){t.setTimeout(function(){fe.useFlashBlock&&W(),_(),"function"==typeof fe.onload&&fe.onload.apply(t),fe.waitForWindowLoad&&ie.add(t,"load",v)},1)},se=function(){if(ae!==e)return ae;var n,o,i,r=!1,a=navigator,s=a.plugins,u=t.ActiveXObject;if(s&&s.length)o="application/x-shockwave-flash",i=a.mimeTypes,i&&i[o]&&i[o].enabledPlugin&&i[o].enabledPlugin.description&&(r=!0);else if(u!==e&&!ge.match(/MSAppHost/i)){try{n=new u("ShockwaveFlash.ShockwaveFlash")}catch(l){n=null}r=!!n,n=null}return ae=r,r},Q=function(){var t,e,n=fe.audioFormats,o=Ue&&!!ge.match(/os (1|2|3_0|3_1)\s/i);if(o?(fe.hasHTML5=!1,fe.html5Only=!0,fe.oMC&&(fe.oMC.style.display="none")):fe.useHTML5Audio&&(fe.html5&&fe.html5.canPlayType||(fe.hasHTML5=!1)),fe.useHTML5Audio&&fe.hasHTML5){G=!0;for(e in n)n.hasOwnProperty(e)&&n[e].required&&(fe.html5.canPlayType(n[e].type)?fe.preferFlash&&(fe.flash[e]||fe.flash[n[e].type])&&(t=!0):(G=!1,t=!0))}return fe.ignoreFlash&&(t=!1,G=!0),fe.html5Only=fe.hasHTML5&&fe.useHTML5Audio&&!t,!fe.html5Only},J=function(t){var e,n,o,i=0;if(t instanceof Array){for(e=0,n=t.length;n>e;e++)if(t[e]instanceof Object){if(fe.canPlayMIME(t[e].type)){i=e;break}}else if(fe.canPlayURL(t[e])){i=e;break}t[i].url&&(t[i]=t[i].url),o=t[i]}else o=t;return o},q=function(t){t._hasTimer||(t._hasTimer=!0,!$e&&fe.html5PollingInterval&&(null===Ke&&0===Ce&&(Ke=setInterval(z,fe.html5PollingInterval)),Ce++))},X=function(t){t._hasTimer&&(t._hasTimer=!1,!$e&&fe.html5PollingInterval&&Ce--)},z=function(){var t;if(null!==Ke&&!Ce)return clearInterval(Ke),Ke=null,!1;for(t=fe.soundIDs.length-1;t>=0;t--)fe.sounds[fe.soundIDs[t]].isHTML5&&fe.sounds[fe.soundIDs[t]]._hasTimer&&fe.sounds[fe.soundIDs[t]]._onTimer()},P=function(n){n=n!==e?n:{},"function"==typeof fe.onerror&&fe.onerror.apply(t,[{type:n.type!==e?n.type:null}]),n.fatal!==e&&n.fatal&&fe.disable()},ue=function(){if(!Ne||!se())return!1;var t,e,n=fe.audioFormats;for(e in n)if(n.hasOwnProperty(e)&&("mp3"===e||"mp4"===e)&&(fe.html5[e]=!1,n[e]&&n[e].related))for(t=n[e].related.length-1;t>=0;t--)fe.html5[n[e].related[t]]=!1},this._setSandboxType=function(){},this._externalInterfaceOK=function(){if(fe.swfLoaded)return!1;fe.swfLoaded=!0,qe=!1,Ne&&ue(),setTimeout(d,We?100:1)},K=function(t,n){function o(){}function i(t,e){return'<param name="'+t+'" value="'+e+'" />'}if(be&&we)return!1;if(fe.html5Only)return T(),o(),fe.oMC=s(fe.movieID),d(),be=!0,we=!0,!1;var r,a,u,l,c,p,f,h,m=n||fe.url,g=fe.altURL||m,_="JS/Flash audio component (SoundManager 2)",v=C(),y=F(),b=null,w=ve.getElementsByTagName("html")[0];if(b=w&&w.dir&&w.dir.match(/rtl/i),t=t===e?fe.id:t,T(),fe.url=U(Ye?m:g),n=fe.url,fe.wmode=!fe.wmode&&fe.useHighPerformance?"transparent":fe.wmode,null!==fe.wmode&&(ge.match(/msie 8/i)||!We&&!fe.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Pe.push(O.spcWmode),fe.wmode=null),r={name:t,id:t,src:n,quality:"high",allowScriptAccess:fe.allowScriptAccess,bgcolor:fe.bgColor,pluginspage:Ze+"www.macromedia.com/go/getflashplayer",title:_,type:"application/x-shockwave-flash",wmode:fe.wmode,hasPriority:"true"},fe.debugFlash&&(r.FlashVars="debug=1"),fe.wmode||delete r.wmode,We)a=ve.createElement("div"),l=['<object id="'+t+'" data="'+n+'" type="'+r.type+'" title="'+r.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+Ze+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',i("movie",n),i("AllowScriptAccess",fe.allowScriptAccess),i("quality",r.quality),fe.wmode?i("wmode",fe.wmode):"",i("bgcolor",fe.bgColor),i("hasPriority","true"),fe.debugFlash?i("FlashVars",r.FlashVars):"","</object>"].join("");else{a=ve.createElement("embed");for(u in r)r.hasOwnProperty(u)&&a.setAttribute(u,r[u])}if(L(),y=F(),v=C())if(fe.oMC=s(fe.movieID)||ve.createElement("div"),fe.oMC.id)h=fe.oMC.className,fe.oMC.className=(h?h+" ":B.swfDefault)+(y?" "+y:""),fe.oMC.appendChild(a),We&&(c=fe.oMC.appendChild(ve.createElement("div")),c.className=B.swfBox,c.innerHTML=l),we=!0;else{if(fe.oMC.id=fe.movieID,fe.oMC.className=B.swfDefault+" "+y,p=null,c=null,fe.useFlashBlock||(fe.useHighPerformance?p={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(p={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},b&&(p.left=Math.abs(parseInt(p.left,10))+"px"))),Fe&&(fe.oMC.style.zIndex=1e4),!fe.debugFlash)for(f in p)p.hasOwnProperty(f)&&(fe.oMC.style[f]=p[f]);try{We||fe.oMC.appendChild(a),v.appendChild(fe.oMC),We&&(c=fe.oMC.appendChild(ve.createElement("div")),c.className=B.swfBox,c.innerHTML=l),we=!0}catch(k){throw new Error(H("domError")+" \n"+k.toString())}}return be=!0,o(),!0},S=function(){return fe.html5Only?(K(),!1):me?!1:fe.url?(me=fe.getMovie(fe.id),me||(Ve?(We?fe.oMC.innerHTML=Ae:fe.oMC.appendChild(Ve),Ve=null,be=!0):K(fe.id,fe.url),me=fe.getMovie(fe.id)),"function"==typeof fe.oninitmovie&&setTimeout(fe.oninitmovie,1),!0):!1},y=function(){setTimeout(b,1e3)},w=function(){t.setTimeout(function(){fe.setup({preferFlash:!1}).reboot(),fe.didFlashBlock=!0,fe.beginDelayedInit()},1)},b=function(){var e,n=!1;return fe.url?xe?!1:(xe=!0,ie.remove(t,"load",y),ae&&qe&&!je?!1:(Te||(e=fe.getMoviePercent(),e>0&&100>e&&(n=!0)),void setTimeout(function(){return e=fe.getMoviePercent(),n?(xe=!1,t.setTimeout(y,1),!1):void(!Te&&Xe&&(null===e?fe.useFlashBlock||0===fe.flashLoadTimeout?fe.useFlashBlock&&W():!fe.useFlashBlock&&G?w():_({type:"ontimeout",ignoreInit:!0,error:{type:"INIT_FLASHBLOCK"}}):0===fe.flashLoadTimeout||(!fe.useFlashBlock&&G?w():D(!0))))},fe.flashLoadTimeout))):!1},k=function(){function e(){ie.remove(t,"focus",k)}return je||!qe?(e(),!0):(Xe=!0,je=!0,xe=!1,y(),e(),!0)},ce=function(){},de=function(){},p=function(e){if(Te)return!1;if(fe.html5Only)return Te=!0,v(),!0;var n,o=fe.useFlashBlock&&fe.flashLoadTimeout&&!fe.getMoviePercent(),i=!0;return o||(Te=!0),n={type:!ae&&Ie?"NO_FLASH":"INIT_TIMEOUT"},(ke||e)&&(fe.useFlashBlock&&fe.oMC&&(fe.oMC.className=F()+" "+(null===fe.getMoviePercent()?B.swfTimedout:B.swfError)),_({type:"ontimeout",error:n,ignoreInit:!0}),P(n),i=!1),ke||(fe.waitForWindowLoad&&!Oe?ie.add(t,"load",v):v()),i},l=function(){var t,n=fe.setupOptions;for(t in n)n.hasOwnProperty(t)&&(fe[t]===e?fe[t]=n[t]:fe[t]!==n[t]&&(fe.setupOptions[t]=fe[t]))},d=function(){function e(){ie.remove(t,"load",fe.beginDelayedInit)}if(Te)return!1;if(fe.html5Only)return Te||(e(),fe.enabled=!0,p()),!0;S();try{me._externalInterfaceTest(!1),I(!0,fe.flashPollingInterval||(fe.useHighPerformance?10:50)),fe.debugMode||me._disableDebug(),fe.enabled=!0,fe.html5Only||ie.add(t,"unload",u)}catch(n){return P({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),D(!0),p(),!1}return p(),e(),!0},A=function(){return M?!1:(M=!0,l(),L(),!ae&&fe.hasHTML5&&fe.setup({useHTML5Audio:!0,preferFlash:!1}),oe(),!ae&&Ie&&(Pe.push(O.needFlash),fe.setup({flashLoadTimeout:1})),ve.removeEventListener&&ve.removeEventListener("DOMContentLoaded",A,!1),S(),!0)},ne=function(){return"complete"===ve.readyState&&(A(),ve.detachEvent("onreadystatechange",ne)),!0},x=function(){Oe=!0,A(),ie.remove(t,"load",x)},V=function(){$e&&(fe.setupOptions.useHTML5Audio=!0,fe.setupOptions.preferFlash=!1,(Ue||He&&!ge.match(/android\s2\.3/i))&&(Ue&&(fe.ignoreFlash=!0),Ee=!0))},V(),se(),ie.add(t,"focus",k),ie.add(t,"load",y),ie.add(t,"load",x),ve.addEventListener?ve.addEventListener("DOMContentLoaded",A,!1):ve.attachEvent?ve.attachEvent("onreadystatechange",ne):P({type:"NO_DOM2_EVENTS",fatal:!0})}if(!t||!t.document)throw new Error("SoundManager requires a browser with window and document objects.");var o=null;void 0!==t.SM2_DEFER&&SM2_DEFER||(o=new n),"object"==typeof module&&module&&"object"==typeof module.exports?(t.soundManager=o,module.exports.SoundManager=n,module.exports.soundManager=o):"function"==typeof define&&define.amd?define("SoundManager",[],function(){return{SoundManager:n,soundManager:o}}):(t.SoundManager=n,t.soundManager=o)}(window),function(t){function e(){var t="";for(i=0;5>i;i++)t+=Math.ceil(15*Math.random()).toString(16);return t}function n(t,e,o,i,r){t[e]?o.apply(i):(r=r||0,1e3>r&&setTimeout(function(){n(t,e,o,i,r+1)},0))}function o(e){setTimeout(function(){var o=document.createElement("script");o.type="text/javascript",o.src=e||t.fastXDM.helperUrl,n(document,"body",function(){document.getElementsByTagName("HEAD")[0].appendChild(o)})},0)}function r(t,e){switch(typeof t){case"string":return e?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t.replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");case"object":if("[object Array]"===Object.prototype.toString.apply(t)){newValue=[];for(var n=0;n<t.length;n++)newValue[n]=r(t[n],e)}else for(var o in t)newValue={},Object.hasOwnProperty.call(t,o)&&(newValue[o]=r(t[o],e));default:newValue=t}return newValue}function a(t,e){p.loaded?t.apply(e,[p]):c.push([e,t])}function s(){p.loaded=!0;for(var t=c.length;t--;)c[t][1].apply(c[t][0],[p])}function u(t,e){a(function(n){var o=n.json.parse(t);if(o[0]){o[1]||(o[1]=[]);for(var i=o[1].length;i--;)if(o[1][i]._func){var a=o[1][i]._func;o[1][i]=function(){var t=Array.prototype.slice.call(arguments);t.unshift("_func"+a),e.callMethod.apply(e,t)}}else e.options.safe&&(o[1][i]=r(o[1][i],!0));setTimeout(function(){if(!e.methods[o[0]])throw Error("fastXDM: Method "+o[0]+" is undefined");e.methods[o[0]].apply(e,o[1])},0)}})}function l(t,e){for(var n in e)t[n]&&"object"==typeof t[n]?l(t[n],e[n]):t[n]=e[n]}if(!t.fastXDM){var d={},c=[],p={};t.fastXDM={_id:0,helperUrl:("https:"===location.protocol?"https:":"http:")+"//vk.com/js/api/xdmHelper.js",Server:function(n,o,i){this.methods=n||{},this.id=t.fastXDM._id++,this.options=i||{},this.filter=o,this.key=e(),this.methods["%init%"]=this.methods.__fxdm_i=function(){t.fastXDM.run(this.id),this.methods.onInit&&this.methods.onInit()},this.frameName="fXD"+this.key,this.server=!0,d[this.key]=[u,this]},Client:function(e,n){if(this.methods=e||{},this.id=t.fastXDM._id++,this.options=n||{},t.fastXDM.run(this.id),0!==window.name.indexOf("fXD"))throw Error("Wrong window.name property.");this.key=window.name.substr(3),this.caller=window.parent,d[this.key]=[u,this],this.client=!0,t.fastXDM.on("helper",function(){t.fastXDM.onClientStart(this)
},this),a(function(t){t.send(this,t.json.stringify(["%init%"]));var e=this.methods;setTimeout(function(){e.onInit&&e.onInit()},0)},this)},onMessage:function(t){if(!t.data)return!1;var e=t.data.substr(0,5);if(d[e]){var n=d[e][1];!n||n.filter&&!n.filter(t.origin)||d[e][0](t.data.substr(6),n)}},setJSON:function(t){p.json=t},getJSON:function(t){return t?void a(function(e){t(e.json)}):p.json},setEnv:function(t){var e;for(e in t)p[e]=t[e];s()},_q:{},on:function(t,e,n){this._q[t]||(this._q[t]=[]),-1==this._q[t]?e.apply(n):this._q[t].push([e,n])},run:function(t){var e=(this._q[t]||[]).length;if(this._q[t]&&e>0)for(var n=0;e>n;n++)this._q[t][n][0].apply(this._q[t][n][1]);this._q[t]=-1},waitFor:n},t.fastXDM.Server.prototype.start=function(e,n){if(e.contentWindow)this.caller=e.contentWindow,this.frame=e,t.fastXDM.on("helper",function(){t.fastXDM.onServerStart(this)},this);else{var o=this;n=n||0,50>n&&setTimeout(function(){o.start.apply(o,[e,n+1])},100)}},t.fastXDM.Server.prototype.destroy=function(){d.splice(d.indexOf(this.key),1)},t.fastXDM.Server.prototype.append=function(t,e){var n=document.createElement("DIV");n.innerHTML='<iframe name="'+this.frameName+'" ></iframe>';var o=n.firstChild,i=this;return setTimeout(function(){o.frameBorder="0",e&&l(o,e),t.insertBefore(o,t.firstChild),i.start(o)},0),o},t.fastXDM.Client.prototype.callMethod=t.fastXDM.Server.prototype.callMethod=function(){for(var e=Array.prototype.slice.call(arguments),o=e.shift(),i=e.length;i--;)if("function"==typeof e[i]){this.funcsCount=(this.funcsCount||0)+1;var s=e[i],u="_func"+this.funcsCount;this.methods[u]=function(){s.apply(this,arguments),delete this.methods[u]},e[i]={_func:this.funcsCount}}else this.options.safe&&(e[i]=r(e[i],!1));n(this,"caller",function(){t.fastXDM.on(this.id,function(){a(function(t){t.send(this,t.json.stringify([o,e]))},this)},this)},this)},t.JSON&&"object"==typeof t.JSON&&t.JSON.parse&&t.JSON.stringify&&'{"a":[1,2,3]}'==t.JSON.stringify({a:[1,2,3]}).replace(/ /g,"")?p.json={parse:t.JSON.parse,stringify:t.JSON.stringify}:t.fastXDM._needJSON=!0,t.postMessage?(p.protocol="p",p.send=function(t,e){var n=t.frame?t.frame.contentWindow:t.caller;n.postMessage(t.key+":"+e,"*")},t.addEventListener?t.addEventListener("message",t.fastXDM.onMessage,!1):t.attachEvent("onmessage",t.fastXDM.onMessage),t.fastXDM._needJSON?(t.fastXDM._onlyJSON=!0,o()):s()):o()}}(window),window.VK||(window.VK={}),VK.MD5||(VK.MD5=function(t){var e=function(t,e){var n=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(n>>16);return o<<16|65535&n},n=function(t,e){return t<<e|t>>>32-e},o=function(t,o,i,r,a,s){return e(n(e(e(o,t),e(r,s)),a),i)},i=function(t,e,n,i,r,a,s){return o(e&n|~e&i,t,e,r,a,s)},r=function(t,e,n,i,r,a,s){return o(e&i|n&~i,t,e,r,a,s)},a=function(t,e,n,i,r,a,s){return o(e^n^i,t,e,r,a,s)},s=function(t,e,n,i,r,a,s){return o(n^(e|~i),t,e,r,a,s)},u=function(t,n){var o,u,l,d,c=1732584193,p=-271733879,f=-1732584194,h=271733878;t[n>>5]|=128<<n%32,t[(n+64>>>9<<4)+14]=n;for(var m=0,g=t.length;g>m;m+=16)o=c,u=p,l=f,d=h,c=i(c,p,f,h,t[m+0],7,-680876936),h=i(h,c,p,f,t[m+1],12,-389564586),f=i(f,h,c,p,t[m+2],17,606105819),p=i(p,f,h,c,t[m+3],22,-1044525330),c=i(c,p,f,h,t[m+4],7,-176418897),h=i(h,c,p,f,t[m+5],12,1200080426),f=i(f,h,c,p,t[m+6],17,-1473231341),p=i(p,f,h,c,t[m+7],22,-45705983),c=i(c,p,f,h,t[m+8],7,1770035416),h=i(h,c,p,f,t[m+9],12,-1958414417),f=i(f,h,c,p,t[m+10],17,-42063),p=i(p,f,h,c,t[m+11],22,-1990404162),c=i(c,p,f,h,t[m+12],7,1804603682),h=i(h,c,p,f,t[m+13],12,-40341101),f=i(f,h,c,p,t[m+14],17,-1502002290),p=i(p,f,h,c,t[m+15],22,1236535329),c=r(c,p,f,h,t[m+1],5,-165796510),h=r(h,c,p,f,t[m+6],9,-1069501632),f=r(f,h,c,p,t[m+11],14,643717713),p=r(p,f,h,c,t[m+0],20,-373897302),c=r(c,p,f,h,t[m+5],5,-701558691),h=r(h,c,p,f,t[m+10],9,38016083),f=r(f,h,c,p,t[m+15],14,-660478335),p=r(p,f,h,c,t[m+4],20,-405537848),c=r(c,p,f,h,t[m+9],5,568446438),h=r(h,c,p,f,t[m+14],9,-1019803690),f=r(f,h,c,p,t[m+3],14,-187363961),p=r(p,f,h,c,t[m+8],20,1163531501),c=r(c,p,f,h,t[m+13],5,-1444681467),h=r(h,c,p,f,t[m+2],9,-51403784),f=r(f,h,c,p,t[m+7],14,1735328473),p=r(p,f,h,c,t[m+12],20,-1926607734),c=a(c,p,f,h,t[m+5],4,-378558),h=a(h,c,p,f,t[m+8],11,-2022574463),f=a(f,h,c,p,t[m+11],16,1839030562),p=a(p,f,h,c,t[m+14],23,-35309556),c=a(c,p,f,h,t[m+1],4,-1530992060),h=a(h,c,p,f,t[m+4],11,1272893353),f=a(f,h,c,p,t[m+7],16,-155497632),p=a(p,f,h,c,t[m+10],23,-1094730640),c=a(c,p,f,h,t[m+13],4,681279174),h=a(h,c,p,f,t[m+0],11,-358537222),f=a(f,h,c,p,t[m+3],16,-722521979),p=a(p,f,h,c,t[m+6],23,76029189),c=a(c,p,f,h,t[m+9],4,-640364487),h=a(h,c,p,f,t[m+12],11,-421815835),f=a(f,h,c,p,t[m+15],16,530742520),p=a(p,f,h,c,t[m+2],23,-995338651),c=s(c,p,f,h,t[m+0],6,-198630844),h=s(h,c,p,f,t[m+7],10,1126891415),f=s(f,h,c,p,t[m+14],15,-1416354905),p=s(p,f,h,c,t[m+5],21,-57434055),c=s(c,p,f,h,t[m+12],6,1700485571),h=s(h,c,p,f,t[m+3],10,-1894986606),f=s(f,h,c,p,t[m+10],15,-1051523),p=s(p,f,h,c,t[m+1],21,-2054922799),c=s(c,p,f,h,t[m+8],6,1873313359),h=s(h,c,p,f,t[m+15],10,-30611744),f=s(f,h,c,p,t[m+6],15,-1560198380),p=s(p,f,h,c,t[m+13],21,1309151649),c=s(c,p,f,h,t[m+4],6,-145523070),h=s(h,c,p,f,t[m+11],10,-1120210379),f=s(f,h,c,p,t[m+2],15,718787259),p=s(p,f,h,c,t[m+9],21,-343485551),c=e(c,o),p=e(p,u),f=e(f,l),h=e(h,d);return[c,p,f,h]},l=function(t){for(var e,n,o="",i=-1,r=t.length;++i<r;)e=t.charCodeAt(i),n=r>i+1?t.charCodeAt(i+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),i++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},d=function(t){var e,n,o=Array(t.length>>2);for(e=0,n=o.length;n>e;e++)o[e]=0;for(e=0,n=8*t.length;n>e;e+=8)o[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return o},c=function(t){for(var e="",n=0,o=32*t.length;o>n;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},p=function(t){return c(u(d(t),8*t.length))},f=function(t){for(var e,n="0123456789abcdef",o="",i=0,r=t.length;r>i;i++)e=t.charCodeAt(i),o+=n.charAt(e>>>4&15)+n.charAt(15&e);return o};return f(p(l(t)))}),VK.extend=function(t,e,n){for(var o in e)(n||"undefined"==typeof t[o])&&(t[o]=e[o]);return t},"https:"!==VK._protocol&&(VK._protocol="https:"===location.protocol?"https:":"http:"),VK.xdConnectionCallbacks?(setTimeout(function(){for(var t;t=VK.xdConnectionCallbacks.pop();)t()},0),VK.Widgets&&!VK.Widgets._constructor&&(VK.Widgets=!1)):(VK.extend(VK,{version:1,_apiId:null,_session:null,_userStatus:"unknown",_domain:{main:"https://oauth.vk.com/",api:"https://api.vk.com/"},_path:{login:"authorize",proxy:"fxdm_oauth_proxy.html"},_rootId:"vk_api_transport",_nameTransportPath:"",xdReady:!1,access:{FRIENDS:2,PHOTOS:4,AUDIO:8,VIDEO:16,MATCHES:32,QUESTIONS:64,WIKI:128}}),VK.init=function(t){var e,n;if(VK._apiId=null,!t.apiId)throw Error("VK.init() called without an apiId");if(VK._apiId=t.apiId,t.onlyWidgets)return!0;t.nameTransportPath&&""!==t.nameTransportPath&&(VK._nameTransportPath=t.nameTransportPath),n=document.getElementById(VK._rootId),n||(n=document.createElement("div"),n.id=VK._rootId,e=document.getElementsByTagName("body")[0],e.insertBefore(n,e.childNodes[0])),n.style.position="absolute",n.style.top="-10000px";var o=VK.Cookie.load();o&&(VK.Auth._loadState="loaded",VK.Auth.setSession(o,o?"connected":"unknown"))},VK.Cookie||(VK.Cookie={_domain:null,load:function(){var t,e=document.cookie.match("\\bvk_app_"+VK._apiId+"=([^;]*)\\b");if(e){if(t=this.decode(e[1]),"oauth"!=t.secret)return!1;t.expire=parseInt(t.expire,10),VK.Cookie._domain="."+window.location.hostname}return t},setRaw:function(t,e,n,o){var i;i="vk_app_"+VK._apiId+"="+t;var r=o?(new Date).getTime()+1e3*o:1e3*e;i+=t&&0===e?"":"; expires="+new Date(r).toGMTString(),i+="; path=/",i+=n?"; domain=."+n:"",document.cookie=i,this._domain=n},set:function(t,e){t?this.setRaw(this.encode(t),t.expire,window.location.hostname,(e||{}).time):this.clear()},clear:function(){this.setRaw("",0,this._domain,0)},encode:function(t){var e,n=[];for(e in t)"user"!=e&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.sort(),n.join("&")},decode:function(t){var e,n,o={},i=t.split("&");for(e=0;e<i.length;e++)n=i[e].split("=",2),n&&n[0]&&(o[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return o}}),VK.Api||(VK.Api={_headId:null,_callbacks:{},ie6_7:function(){return VK.Api.ieTested||(VK.Api.isIE6_7=navigator.userAgent.match(/MSIE [6|7]/i),VK.Api.ieTested=!0),VK.Api.isIE6_7},attachScript:function(t){VK.Api._headId||(VK.Api._headId=document.getElementsByTagName("head")[0]);var e=document.createElement("script");e.type="text/javascript",e.setAttribute("encoding","UTF-8"),e.src=t,VK.Api._headId.appendChild(e)},checkMethod:function(t,e,n,o){var i=t.toLowerCase();if("wall.post"==i||"activity.set"==i){var r="activity.set"==i?e.text:e.message,a=VK._protocol+"//vk.com/al_apps.php?act=wall_post_box&widget=1&method="+i+"&aid="+parseInt(VK._apiId,10)+"&text="+encodeURIComponent(r);"wall.post"==i&&(a+="&owner_id="+parseInt(e.owner_id||0,10)+"&attachments="+(e.attachments||e.attachment||""));var s="_"+Math.random().toString(16).substr(2);a+="&method_access="+s;var u=(VK.UI.popup({url:a,width:460,height:249}),setInterval(function(){VK.UI.active.closed&&(clearInterval(u),e.method_access=s,VK.Api.call(t,e,n,o))},500));return!1}return!0},call:function(t,e,n,o){var i,r,a=e||{};if("object"!=typeof a||"function"!=typeof n)return!1;if(e.method_access||e.method_force||VK.Api.checkMethod(t,e,n,o)){if(o||(o=0),"loaded"!=VK.Auth._loadState){var s=function(o){o&&o.session&&(VK.Observer.unsubscribe("auth.loginStatus",s),VK.Api.call(t,e,n))};return VK.Observer.subscribe("auth.loginStatus",s),void VK.Auth.getLoginStatus()}if(VK.Api.queryLength(a)<1500&&!VK.Api.ie6_7()){for(var u=!1,l=parseInt(1e7*Math.random(),10);VK.Api._callbacks[l];)l=parseInt(1e7*Math.random(),10);a.callback="VK.Api._callbacks["+l+"]"}else var u=!0;VK._session&&VK._session.sid&&(a.access_token=VK._session.sid),i=VK.Cookie.encode(a),r=function(i){if(!i.error||3!=i.error.error_code&&4!=i.error.error_code&&5!=i.error.error_code)n(i);else{if(o>3)return!1;var r=function(i){VK.Observer.unsubscribe("auth.sessionChange",r),delete e.access_token,i.session&&VK.Api.call(t,e,n,o+1)};VK.Observer.subscribe("auth.sessionChange",r),VK.Auth.getLoginStatus()}u||delete VK.Api._callbacks[l]},u?VK.xdReady?VK.XDM.remote.callMethod("apiCall",t,i,r):(VK.Observer.subscribe("xdm.init",function(){VK.XDM.remote.callMethod("apiCall",t,i,r)}),VK.XDM.init()):(VK.Api._callbacks[l]=r,VK.Api.attachScript(VK._domain.api+"method/"+t+"?"+i))}},queryLength:function(t){var e,n=100;for(e in t)n+=e.length+encodeURIComponent(t.i).length+1;return n}},VK.api=function(t,e,n){VK.Api.call(t,e,n)}),VK.Auth||(VK.Auth={popup:null,lsCb:{},setSession:function(t,e,n,o){var i=!VK._session&&t,r=VK._session&&!t,a=VK._session&&t&&VK._session.mid!=t.mid,s=i||r||VK._session&&t&&VK._session.sid!=t.sid,u=e!=VK._userStatus,l={session:t,status:e,settings:n};return VK._session=t,VK._userStatus=e,VK.Cookie.set(t,o),(s||u||a)&&setTimeout(function(){u&&VK.Observer.publish("auth.statusChange",l),(r||a)&&VK.Observer.publish("auth.logout",l),(i||a)&&VK.Observer.publish("auth.login",l),s&&VK.Observer.publish("auth.sessionChange",l)},0),l},login:function(t,e){var n,o;if(!VK._apiId)return!1;n=window.location.protocol+"//"+window.location.hostname,o=VK._domain.main+VK._path.login+"?client_id="+VK._apiId+"&display=popup&redirect_uri=close.html&response_type=token",e&&parseInt(e,10)>0&&(o+="&scope="+e),VK.Observer.unsubscribe("auth.onLogin"),VK.Observer.subscribe("auth.onLogin",t),VK.UI.popup({width:620,height:370,url:o});var i=function(){VK.Auth.getLoginStatus(function(t){VK.Observer.publish("auth.onLogin",t),VK.Observer.unsubscribe("auth.onLogin")},!0)};VK.UI.popupOpened=!0;var r=function(){if(!VK.UI.popupOpened)return!1;try{if(!VK.UI.active.top||VK.UI.active.closed)return VK.UI.popupOpened=!1,i(),!0}catch(t){return VK.UI.popupOpened=!1,i(),!0}setTimeout(r,100)};setTimeout(r,100)},logout:function(t){VK.Auth.revokeGrants(t)},revokeGrants:function(t){var e=function(n){VK.Observer.unsubscribe("auth.statusChange",e),t&&t(n)};VK.Observer.subscribe("auth.statusChange",e),VK._session&&VK._session.sid&&VK.Api.attachScript("https://login.vk.com/?act=openapi&oauth=1&aid="+parseInt(VK._apiId,10)+"&location="+encodeURIComponent(window.location.hostname)+"&do_logout=1&token="+VK._session.sid),VK.Cookie.clear()},getSession:function(){return VK._session},getLoginStatus:function(t,e){if(VK._apiId){if(t){if(!e&&"loaded"==VK.Auth._loadState)return void t({status:VK._userStatus,session:VK._session});VK.Observer.subscribe("auth.loginStatus",t)}if(e||"loading"!=VK.Auth._loadState){VK.Auth._loadState="loading";for(var n=parseInt(1e7*Math.random(),10);VK.Auth.lsCb[n];)n=parseInt(1e7*Math.random(),10);VK.Auth.lsCb[n]=function(t){if(delete VK.Auth.lsCb[n],VK.Auth._loadState="loaded",t&&t.auth){var o={mid:t.user.id,sid:t.access_token,sig:t.sig,secret:t.secret,expire:t.expire};e&&(o.user=t.user);var i="connected"}else{var o=null,i=t.user?"logined":"unknown";VK.Cookie.clear()}VK.Auth.setSession(o,i,!1,t),VK.Observer.publish("auth.loginStatus",{session:o,status:i}),VK.Observer.unsubscribe("auth.loginStatus")},VK.Api.attachScript("https://login.vk.com/?act=openapi&oauth=1&aid="+parseInt(VK._apiId,10)+"&location="+encodeURIComponent(window.location.hostname)+"&rnd="+n)}}}})),VK.UI||(VK.UI={active:null,_buttons:[],popup:function(t){var e="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,n="undefined"!=typeof window.screenY?window.screenY:window.screenTop,o="undefined"!=typeof window.outerWidth?window.outerWidth:document.body.clientWidth,i="undefined"!=typeof window.outerHeight?window.outerHeight:document.body.clientHeight-22,r=t.width,a=t.height,s=parseInt(e+(o-r)/2,10),u=parseInt(n+(i-a)/2.5,10),l="width="+r+",height="+a+",left="+s+",top="+u;this.active=window.open(t.url,"vk_openapi",l)},button:function(t){var e="";"string"==typeof t&&(t=document.getElementById(t)),this._buttons.push(t),index=this._buttons.length-1,e='<table cellspacing="0" cellpadding="0" id="openapi_UI_'+index+'" onmouseover="VK.UI._change(1, '+index+');" onmouseout="VK.UI._change(0, '+index+');" onmousedown="VK.UI._change(2, '+index+');" onmouseup="VK.UI._change(1, '+index+');" style="cursor: pointer; border: 0px; font-family: tahoma, arial, verdana, sans-serif, Lucida Sans; font-size: 10px;"><tr style="vertical-align: middle"><td><div style="border: 1px solid #3b6798;border-radius: 2px 0px 0px 2px;-moz-border-radius: 2px 0px 0px 2px;-webkit-border-radius: 2px 0px 0px 2px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 4px 0px 6px;line-height: 13px;">&#1042;&#1086;&#1081;&#1090;&#1080;</div></div></td><td><div style="background: url('+VK._protocol+'//vk.com/images/btns.png) 0px -42px no-repeat; width: 21px; height: 21px"></div></td><td><div style="border: 1px solid #3b6798;border-radius: 0px 2px 2px 0px;-moz-border-radius: 0px 2px 2px 0px;-webkit-border-radius: 0px 2px 2px 0px;"><div style="border: 1px solid #5c82ab; border-top-color: #7e9cbc; background-color: #6D8DB1; color: #fff; text-shadow: 0px 1px #45688E; height: 15px; padding: 2px 6px 0px 4px;line-height: 13px;">&#1050;&#1086;&#1085;&#1090;&#1072;&#1082;&#1090;&#1077;</div></div></td></tr></table>',t.innerHTML=e,t.style.width=t.childNodes[0].offsetWidth+"px"},_change:function(t,e){for(var n=document.getElementById("openapi_UI_"+e).rows[0],o=[n.cells[0].firstChild.firstChild,n.cells[2].firstChild.firstChild],i=0;2>i;++i){var r=o[i];0===t?(r.style.backgroundColor="#6D8DB1",r.style.borderTopColor="#7E9CBC",r.style.borderLeftColor=r.style.borderRightColor=r.style.borderBottomColor="#5C82AB"):1==t?(r.style.backgroundColor="#7693B6",r.style.borderTopColor="#88A4C4",r.style.borderLeftColor=r.style.borderRightColor=r.style.borderBottomColor="#6088B4"):2==t&&(r.style.backgroundColor="#6688AD",r.style.borderBottomColor="#7495B8",r.style.borderLeftColor=r.style.borderRightColor=r.style.borderTopColor="#51779F")}0===t||2==t?n.cells[2].firstChild.style.backgroundPosition="0px -42px":1==t&&(n.cells[2].firstChild.style.backgroundPosition="0px -63px")}}),VK.XDM||(VK.XDM={remote:null,init:function(){if(this.remote)return!1;var t=VK._domain.api+VK._path.proxy;this.remote=new fastXDM.Server({onInit:function(){VK.xdReady=!0,VK.Observer.publish("xdm.init")}}),this.remote.append(document.getElementById(VK._rootId),{src:t})},xdHandler:function(code){try{eval("VK."+code)}catch(e){}}}),VK.Observer||(VK.Observer={_subscribers:function(){return this._subscribersMap||(this._subscribersMap={}),this._subscribersMap},publish:function(t){var e,n,o=Array.prototype.slice.call(arguments),t=o.shift(),i=this._subscribers()[t];if(i)for(e=0,n=i.length;n>e;e++)null!=i[e]&&i[e].apply(this,o)},subscribe:function(t,e){var n=this._subscribers();return"function"!=typeof e?!1:void(n[t]?n[t].push(e):n[t]=[e])},unsubscribe:function(t,e){var n,o,i=this._subscribers()[t];if(!i)return!1;if("function"==typeof e)for(n=0,o=i.length;o>n;n++)i[n]==e&&(i[n]=null);else delete this._subscribers()[t]}}),VK.Widgets||(VK.Widgets={},VK.Widgets.count=0,VK.Widgets.RPC={},VK.Widgets.loading=function(t,e){t.style.background=e?'url("'+VK._protocol+'//vk.com/images/upload.gif") center center no-repeat transparent':"none"},VK.Widgets.Comments=function(t,e,n){var o=VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=e||{};var i,r,a={limit:e.limit||10,height:e.height||0,mini:void 0===e.mini?"auto":e.mini,norealtime:e.norealtime?1:0},s=function(){return r.callMethod("mouseUp"),!1},u=function(t){r.callMethod("mouseMove",{screenY:t.screenY})};if(e.browse)a.browse=1,a.replies=e.replies||0;else{var l=e.pageUrl||o.url;"/"==l.substr(0,1)&&(l=location.protocol+"//"+location.host+l),VK.extend(a,{page:n||0,status_publish:void 0===e.autoPublish?1:e.autoPublish,attach:void 0===e.attach?"*":e.attach?e.attach:"",url:l,title:e.pageTitle||o.title,description:e.pageDescription||o.description,image:e.pageImage||o.image})}return e.onChange&&(VK.Observer.subscribe("widgets.comments.new_comment",e.onChange),VK.Observer.subscribe("widgets.comments.delete_comment",e.onChange)),VK.Widgets._constructor("widget_comments.php",t,e,a,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com")+"/"+t,[],{proxy:function(){r.callMethod.apply(r,arguments)}});n.show()},startDrag:function(){cursorBack=window.document.body.style.cursor,window.document.body.style.cursor="pointer",VK.Util.addEvent("mousemove",u),VK.Util.addEvent("mouseup",s)},stopDrag:function(){window.document.body.style.cursor=cursorBack,VK.Util.removeEvent("mousemove",u),VK.Util.removeEvent("mouseup",s)}},{startHeight:133,minWidth:300,width:"100%"},function(t,e,n){i=e,r=n})},VK.Widgets.CommentsBrowse=function(t,e){return e=e||{},e.browse=1,VK.Widgets.Comments(t,e)},VK.Widgets.Recommended=function(t,e){VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=e||{};var n={limit:e.limit||5,max:e.max||0,sort:e.sort||"friend_likes",verb:e.verb||0,period:e.period||"week",target:e.target||"parent"};return VK.Widgets._constructor("widget_recommended.php",t,e,n,{},{startHeight:90+30*n.limit,minWidth:150,width:"100%"})},VK.Widgets.Like=function(t,e,n){function o(t){if((y||t)&&d&&l&&d&&("none"==l.style.display||"yes"==l.getAttribute("vkhidden"))){var n=e.getScrollTop?e.getScrollTop():document.body.scrollTop||document.documentElement.scrollTop||0,o=VK.Util.getXY(a,e.fixed),i=v?0:o[1];n>o[1]-120&&"top"!=e.tooltipPos||"vertical"==f||"bottom"==e.tooltipPos?(l.style.top=i+g+2+"px",d.callMethod("show",!1)):(l.style.top=i-125+"px",d.callMethod("show",!0)),VK.Util.ss(l,{left:(v?0:o[0])-("vertical"==f||"mini"==f?36:2)+"px",display:"block",opacity:1,filter:"none"}),l.setAttribute("vkhidden","no"),y=!0}}function i(t){y&&!t||!d||(d.callMethod("hide"),u.callMethod("hide"),setTimeout(function(){l.style.display="none"},400))}var r=VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");e=VK.extend(e||{},{allowTransparency:!0}),("button"==e.type||"vertical"==e.type||"mini"==e.type)&&delete e.width;var a,s,u,l,d,c,p,f="full"==e.type||"button"==e.type||"vertical"==e.type||"mini"==e.type?e.type:"full",h="full"==f?Math.max(200,e.width||350):"button"==f?180:"mini"==f?100:41,m=parseInt(e.height,10)||22,g="vertical"==f?2*m+7:"full"==f?m+1:m,_={page:n||0,url:e.pageUrl||r.url,type:f,verb:1==e.verb?1:0,title:e.pageTitle||r.title,description:e.pageDescription||r.description,image:e.pageImage||r.image,text:(e.text||"").substr(0,140),h:m},v=e.ttHere||!1,y=!1;return VK.Widgets._constructor("widget_like.php",t,e,_,{initTooltip:function(t){d=new fastXDM.Server({onInit:t?function(){o(!0)}:function(){},proxy:function(){u.callMethod.apply(u,arguments)},showBox:function(t,n){var o=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[n.width,n.height],{proxy:function(){d.callMethod.apply(d,arguments)}});o.show()},statsBox:function(){i(!0),p=VK.Util.Box(s.src+"&act=a_stats_box&widget_width=620"),p.show()}},!1,{safe:!0}),l=d.append(v?a:document.body,{src:s.src+"&act=a_share_tooltip",scrolling:"no",allowTransparency:!0,id:s.id+"_tt",style:{position:"absolute",padding:0,display:"block",opacity:.01,filter:"alpha(opacity=1)",border:"0",width:"206px",height:"127px",zIndex:5e3,overflow:"hidden"}}),l.setAttribute("vkhidden","yes"),a.onmouseover=l.onmouseover=function(){y=!0},a.onmouseout=l.onmouseout=function(){clearTimeout(c),y=!1,c=setTimeout(function(){i()},200)}},showTooltip:o,hideTooltip:i,showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){u.callMethod.apply(u,arguments)}});n.show()},proxy:function(){d&&d.callMethod.apply(d,arguments)}},{startHeight:g,minWidth:h},function(t,e,n){u=n,VK.Util.ss(a=t,{height:g+"px",width:h+"px",position:"relative",clear:"both"}),VK.Util.ss(s=e,{height:g+"px",width:h+"px",overflow:"hidden",zIndex:150})})},VK.Widgets.Poll=function(t,e,n){var o=VK.Util.getPageData();if(!n)throw Error("No poll id passed");e=e||{};var i={poll_id:n,url:e.pageUrl||o.url||location.href,title:e.pageTitle||o.title,description:e.pageDescription||o.description};return VK.Widgets._constructor("widget_poll.php",t,e,i,{},{startHeight:133,minWidth:300,width:"100%"})},VK.Widgets.PagePoll=function(t,e,n){var o=VK.Util.getPageData();e=e||{};var i={page:n||0,norealtime:e.norealtime?1:0,poll_id:e.pollId||"",url:e.pageUrl||o.url||location.href,title:e.pageTitle||o.title,description:e.pageDescription||o.description};return VK.Widgets._constructor("al_widget_poll.php",t,e,i,{},{startHeight:133,minWidth:300,width:"100%"})},VK.Widgets.Community=VK.Widgets.Group=function(t,e,n){function o(){return r.callMethod("mouseUp"),!1}function i(t){return r.callMethod("mouseMove",{screenY:t.screenY}),!1}n=parseInt(n,10);var r;if(!n)throw Error("No group_id passed");e.mode=parseInt(e.mode,10).toString();var a={gid:n,mode:e.mode?e.mode:"0"};e.width||(e.width=200),e.wall&&(a.wall=e.wall),a.color1=e.color1||"",a.color2=e.color2||"",a.color3=e.color3||"",e.no_head&&(a.no_head=1),e.height||(e.height=290),e.wide&&(a.wide=1,e.width<300&&(e.width=300));var s;return VK.Widgets._constructor("widget_community.php",t,e,a,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});n.show()},startDrag:function(){s=window.document.body.style.cursor,window.document.body.style.cursor="pointer",VK.Util.addEvent("mousemove",i),VK.Util.addEvent("mouseup",o)},stopDrag:function(){window.document.body.style.cursor=s,VK.Util.removeEvent("mousemove",i),VK.Util.removeEvent("mouseup",o)},auth:function(){VK.Auth.login(null,1)}},{minWidth:120,width:"200",height:"290",startHeight:200},function(t,e,n){r=n})},VK.Widgets.Auth=function(t,e){VK.Util.getPageData();if(!VK._apiId)throw Error("VK not initialized. Please use VK.init");return e.width||(e.width=200),type=e.type?1:0,VK.Widgets._constructor("widget_auth.php",t,e,{},{makeAuth:function(t){if(t.session&&(VK.Auth._loadState="loaded",VK.Auth.setSession(t.session,"connected"),VK.Observer.publish("auth.loginStatus",{session:t.session,status:"connected"}),VK.Observer.unsubscribe("auth.loginStatus")),e.onAuth)e.onAuth(t);else{if(e.authUrl)var n=e.authUrl;else var n=window.location.href;n+=-1==n.indexOf("?")?"?":"&";var o=[];for(var i in t)"session"!=i&&o.push(i+"="+decodeURIComponent(t[i]).replace(/&/g,"%26").replace(/\?/,"%3F"));window.location.href=n+o.join("&")}}},{startHeight:80})},VK.Widgets.Subscribe=function(t,e,n){n=parseInt(n,10);var o;if(!n)throw Error("No owner_id passed");var i={oid:n};return e.mode&&(i.mode=e.mode),e.soft&&(i.soft=e.soft),VK.Widgets._constructor("widget_subscribe.php",t,e,i,{showBox:function(t){var n=VK.Util.Box((e.base_domain||VK._protocol+"//vk.com/")+t,[],{proxy:function(){rpc.callMethod.apply(rpc,arguments)}});n.show()},auth:function(){VK.Auth.login(null,1)}},{minWidth:220,startHeight:22,height:e.height||22},function(t,e,n){o=n})},VK.Widgets.Ads=function(t,e,n){function o(t){VK.Widgets.loading(v,!0),r(t)}function i(t,n){VK.Widgets.loading(v,!1),a(n),e.onAdsReady&&e.onAdsReady.apply(e.onAdsReady,Array.prototype.slice.call(arguments)),s(t)}function r(t){if("vk__adsLight"in window)window.vk__adsLight&&vk__adsLight.userHandlers&&vk__adsLight.userHandlers.onInit&&vk__adsLight.userHandlers.onInit(!1);else{window.vk__adsLight=!1,t=parseInt(t);var n=VK.Api&&VK.Api.attachScript||VK.addScript,o=e.base_domain||VK._protocol+"//vk.com";n(o+"/js/al/aes_light.js?"+t)}}function a(t){if(t)for(var e in t){var n=t[e];"ads_ad_unit_width"===e||"ads_ad_unit_height"===e?e in y||(b[e]=parseInt(n)||"auto"===n&&y[e+"_auto"]||w[e]):e in b||(b[e]=n)}}function s(t){var e=u(b.ads_handler,t);if(0>=t&&e!==!0){try{console.log("VK: ad_unit_id = "+y.ads_ad_unit_id,", errorCode = ",t)}catch(n){}l(b.ads_handler_empty_html,b.ads_ad_unit_width,b.ads_ad_unit_height)}}function u(t){function e(t){return"[object Function]"===Object.prototype.toString.call(t)}function n(t){return"[object String]"===Object.prototype.toString.call(t)}var o=!1;try{if(!t)return!1;var i=!1;if(e(t))i=t;else if(n(t)){var r=t.split(".");i=window;for(var a=0,s=r.length;s>a&&(i=i[r[a]],i);a++);if(!i){"function"===t.substr(0,8)&&(t="return "+t+";");var u=new Function(t)();e(u)?i=u:o=u}}if(i){var l=Array.prototype.slice.call(arguments,1);o=i.apply(i,l)}}catch(d){try{console.error(d)}catch(c){}}return o}function l(t,e,n){function o(){if(!n)try{var t=r.contentWindow.document.body.firstChild.getBoundingClientRect(),e=Math.ceil(t.bottom-t.top);e&&(r.style.height=e,v.style.height=e)}catch(o){}}if(t&&v){e=e?e+"px":"",n=n?n+"px":"";var i='<html><head></head><body style="padding: 0; margin: 0;"><div>'+t+"</div></body></html>",r=document.createElement("iframe");r.onload=o,r.id=(f?f.id:"vkwidget-"+Math.round(1e6*Math.random()))+"_ads_html_handler",r.src="about:blank",r.width="100%",r.height="100%",r.scrolling="no",r.frameBorder="0",r.allowTransparency=!0,r.style.overflow="hidden",r.style.width=e,r.style.height=n,v.style.width=e,v.style.height=n,v.appendChild(r),r.contentWindow.vk_ads_html_handler=i,r.src='javascript:window["vk_ads_html_handler"]'}}function d(t,e,n){for(var o=n||0,i=(t||[]).length;i>o;o++)if(t[o]==e)return o;return-1}function c(t,e){return-1!=d(e,t)}function p(t,e,n){v=t,f=e,h=n}e=e||{},n=n||{};var f,h,m={},g={},_={},v=document.getElementById(t),y={},b={},w={};for(var T in n){var k=c(T,["hash"])?T:"ads_"+T;y[k]=n[T]}if(v&&v.getBoundingClientRect){v.style.width="100%",v.style.height="100%";var O=v.getBoundingClientRect();v.style.width="",v.style.height="",y.ads_ad_unit_width_auto=Math.floor(O.right-O.left),y.ads_ad_unit_height_auto=Math.floor(O.bottom-O.top)}return w.ads_ad_unit_width=100,w.ads_ad_unit_height=100,b.ads_ad_unit_width=parseInt(y.ads_ad_unit_width)||"auto"===y.ads_ad_unit_width&&y.ads_ad_unit_width_auto||w.ads_ad_unit_width,b.ads_ad_unit_height=parseInt(y.ads_ad_unit_height)||"auto"===y.ads_ad_unit_height&&y.ads_ad_unit_height_auto||w.ads_ad_unit_height,y.ads_handler&&(b.ads_handler=y.ads_handler),y.ads_handler_empty_html&&(b.ads_handler_empty_html=y.ads_handler_empty_html),delete y.ads_handler,delete y.ads_handler_empty_html,m.act="ads_web",m.url=location.href,VK.extend(m,y),e.noDefaultParams=!0,e.width=b.ads_ad_unit_width,e.allowTransparency=!0,g.startHeight=b.ads_ad_unit_height,g.minWidth=b.ads_ad_unit_width,_.adsOnInitLoader=o,_.adsOnInit=i,VK.Widgets._constructor("ads_rotate.php",t,e,m,_,g,p)},VK.Widgets._constructor=function(t,e,n,o,i,r,a,s,u){var l=document.getElementById(e);if(s=s||++VK.Widgets.count,!l){if(u=u||0,u>10)throw Error("VK.Widgets: object #"+e+" not found.");return setTimeout(function(){VK.Widgets._constructor(t,e,n,o,i,r,a,s,u+1)},500),s}var d,c,p,f,h,m,g,_;n=n||{},r=r||{},i=i||{},d=n.base_domain||VK._protocol+"//vk.com",c="auto"==n.width?l.clientWidth||"100%":parseInt(n.width,10),n.height?(o.height=n.height,l.style.height=n.height+"px"):l.style.height=(r.startHeight||200)+"px",c=c?Math.max(r.minWidth||200,Math.min(1e4,c))+"px":"100%",o.url||(o.url=n.pageUrl||location.href.replace(/#.*$/,"")),p=d+"/"+t,f="",n.noDefaultParams||(f+="&app="+(VK._apiId||"0")+"&width="+c),f+="&_ver="+VK.version,VK._iframeAppWidget&&(o.iframe_app=1);for(_ in o){if("title"==_&&o[_].length>80&&(o[_]=o[_].substr(0,80)+"..."),"description"==_&&o[_].length>160&&(o[_]=o[_].substr(0,160)+"..."),"number"==typeof o[_])h=o[_];else try{h=encodeURIComponent(o[_])}catch(v){h=""}f+="&"+_+"="+h}return f+="&"+(+new Date).toString(16),p+="?"+f.substr(1),l.style.width=c,VK.Widgets.loading(l,!0),i.publish=function(){var t=Array.prototype.slice.call(arguments);t.push(s),VK.Observer.publish.apply(VK.Observer,t)},i.onInit=function(){VK.Widgets.loading(l,!1),i.onReady&&i.onReady(),n.onReady&&n.onReady()},i.resize=function(t){l.style.height=t+"px";var e=document.getElementById("vkwidget"+s);e&&(e.style.height=t+"px")},i.resizeWidget=function(t,e){t=parseInt(t),e=parseInt(e);var o=document.getElementById("vkwidget"+s);isFinite(t)&&(l.style.width=t+"px",o&&(o.style.width=t+"px")),isFinite(e)&&(l.style.height=e+"px",o&&(o.style.height=e+"px")),n.onResizeWidget&&n.onResizeWidget()},i.updateVersion=function(t){t>1&&VK.Api.attachScript("//vk.com/js/api/openapi_update.js?"+parseInt(t))},m=VK.Widgets.RPC[s]=new fastXDM.Server(i,function(t){return t?(t=t.toLowerCase(),-1!=t.indexOf(".vk.com")||-1!=t.indexOf("/vk.com")):!0},{safe:!0}),g=VK.Widgets.RPC[s].append(l,{src:p,width:-1!=c.indexOf("%")?c:parseInt(c)||c,height:r.startHeight||"100%",scrolling:"no",id:"vkwidget"+s,allowTransparency:n.allowTransparency||!1,style:{overflow:"hidden"}}),a&&setTimeout(function(){a(l,g||l.firstChild,m)},10),s}),VK.Util||(VK.Util={getPageData:function(){if(!VK._pData){var t,e=document.getElementsByTagName("meta"),n={},o=["description","title","url","image","app_id"];for(var i in e)if(e[i].getAttribute&&e[i].getAttribute&&((t=e[i].getAttribute("name"))||(t=e[i].getAttribute("property"))))for(var r in o)(t==o[r]||t=="og:"+o[r]||t=="vk:"+o[r])&&(n[o[r]]=e[i].content);n.app_id&&!VK._apiId&&(VK._apiId=n.app_id),n.title=n.title||document.title||"",n.description=n.description||"",n.image=n.image||"",!n.url&&VK._iframeAppWidget&&VK._apiId&&(n.url="/app"+VK._apiId,VK._browserHash&&(n.url+=VK._browserHash));var a=location.href.replace(/#.*$/,"");n.url&&n.url.indexOf(a)||(n.url=a),VK._pData=n}return VK._pData},getStyle:function(t,e){var n,o=document.defaultView||window;if(o.getComputedStyle){e=e.replace(/([A-Z])/g,"-$1").toLowerCase();var i=o.getComputedStyle(t,null);i&&(n=i.getPropertyValue(e))}else if(t.currentStyle){var r=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()});n=t.currentStyle[e]||t.currentStyle[r]}return n},getXY:function(t,e){if(t&&void 0!==t){var n=0,o=0;if(void 0!==t.getBoundingClientRect){var i=t.getBoundingClientRect();
n=i.left,o=i.top,e=!0}else if(t.offsetParent)do n+=t.offsetLeft,o+=t.offsetTop,e&&(n-=t.scrollLeft,o-=t.scrollTop);while(t=t.offsetParent);return e&&(o+=window.pageYOffset||window.scrollNode&&scrollNode.scrollTop||document.documentElement.scrollTop,n+=window.pageXOffset||window.scrollNode&&scrollNode.scrollLeft||document.documentElement.scrollLeft),[n,o]}},Box:function(t,e,n){n=n||{};var o=document.body.style.overflow,i=document.createElement("DIV"),r=new fastXDM.Server(VK.extend(n,{onInit:function(){a.style.background="transparent",a.style.visibility="visible",document.body.style.overflow="hidden",document.body.removeChild(i)},hide:function(){a.style.display="none"},tempHide:function(){a.style.left="-10000px",a.style.top="-10000px",a.style.width="10px",a.style.height="10px",document.body.style.overflow=o},destroy:function(){try{a.src="about: blank;"}catch(t){}a.parentNode.removeChild(a),document.body.style.overflow=o},resize:function(){}},!0),!1,{safe:!0}),a=r.append(document.body,{src:t.replace(/&amp;/g,"&"),scrolling:"no",allowTransparency:!0,style:{position:"fixed",left:0,top:0,zIndex:1002,background:VK._protocol+"//vk.com/images/upload.gif center center no-repeat transparent",padding:"0",border:"0",width:"100%",height:"100%",overflow:"hidden",visibility:"hidden"}});return i.innerHTML='<div style="position: fixed;left: 50%;top: 50%;margin: 0px auto 0px -60px;z-index: 1002;width: 100px;"><div style="background: url(//vk.com/images/upload_inv_mono'+(window.devicePixelRatio>=2?"_2x":"")+'.gif) no-repeat 50% 50%;background-size: 64px 16px;height: 50px;position: absolute;width: 100%;z-index: 100;"></div><div style="background-color: #000;opacity: 0.7;filter: alpha(opacity=70);height: 50px;-webkit-border-radius: 5px;-khtml-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-webkit-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);-moz-box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.35);"></div></div>',document.body.insertBefore(i,document.body.firstChild),{show:function(){a.style.display="block",document.body.style.overflow="hidden"},hide:function(){a.style.display="none",document.body.style.overflow=o},iframe:a,rpc:r}},addEvent:function(t,e){window.document.addEventListener?window.document.addEventListener(t,e,!1):window.document.attachEvent&&window.document.attachEvent("on"+t,e)},removeEvent:function(t,e){window.document.removeEventListener?window.document.removeEventListener(t,e,!1):window.document.detachEvent&&window.document.detachEvent("on"+t,e)},ss:function(t,e){VK.extend(t.style,e,!0)}}),window.vkAsyncInit&&setTimeout(vkAsyncInit,0),window.vkAsyncInitCallbacks&&vkAsyncInitCallbacks.length&&setTimeout(function(){for(var t;t=vkAsyncInitCallbacks.pop();)try{t()}catch(e){try{console.error(e)}catch(n){}}},0);try{window.stManager&&stManager.done("api/openapi.js")}catch(e){}angular.module("App").controller("Cm_vkCaptcha",["$scope","imageUrl",function(t,e){t.imageUrl=e}]),angular.module("App").service("PS_echonest",["$http","__echonest",function(t,e){function n(n,o){return t({url:e.url+n,method:"GET",params:angular.extend({api_key:e.key},o)})}var o={};return o.getStaticPlaylist=function(t){return n("playlist/static",angular.extend({type:"artist-radio",bucket:"id:musicbrainz",results:50},t))},o.getGenresList=function(t){return n("genre/list",angular.extend({results:50},t))},o}]),angular.module("App").service("PS_lastfm",["$q","$http","__lastfm",function(t,e,n){function o(t,o){return e.jsonp(n.url,{params:angular.extend(o,{format:"json",callback:"JSON_CALLBACK",method:t,api_key:n.keys.api})})}var i={};return i.init=function(){},i.artist={getInfo:function(t){return o("artist.getInfo",{artist:t,autocorrect:!0})},getTopTags:function(t){return o("artist.getTopTags",{artist:t,autocorrect:!0})},getTopAlbums:function(e){var n=t.defer();return o("artist.getTopAlbums",angular.extend(e,{limit:16,page:0})).then(function(t){var e=[],o=t.data;if(o.topalbums["@attr"]){var i=(o.topalbums["@attr"].totalPages,o.topalbums["@attr"].total);if(1==i&&e.push(o.topalbums.album),i>1){var r=o.topalbums.album;for(a=0;a<r.length;a++)e.push(r[a])}}for(var a=0,s=e.length;s>a;a++){var r=e[a],u=r.image.length;r.albumImage=r.image[u-1]["#text"]}n.resolve(e)}),n.promise}},i.tag={getTopTracks:function(t){return o("tag.getTopTracks",{tag:t,limit:12})}},i}]),angular.module("App").service("PS_self",["$http",function(t){var e={};return e.getHotArtists=function(){return t({url:"/tmp/hotArtists.json",method:"GET"})},e}]),angular.module("App").service("PS_vk",["$modal","$rootScope","__vkAppId",function(t,e,n){function o(e,n,i){n=$.extend({v:5.23},n),VK.Api.call(e,n,function(r){if(r.response&&"function"==typeof i&&i(r),r.error&&14===r.error.error_code){var a=r.error.captcha_sid;t.open({templateUrl:"templates/modals/vkCaptcha.html",controller:"Cm_vkCaptcha as ctr",size:"sm",resolve:{imageUrl:function(){return r.error.captcha_img}}}).result.then(function(t){o(e,angular.extend(n,{captcha_key:t,captcha_sid:a}),i)})}})}function i(t){t.session?VK.Api.call("users.get",{fields:"photo_50"},function(t){var n=t.response[0].uid,o=t.response[0].first_name+" "+t.response[0].last_name,i=t.response[0].photo_50;s={id:n,name:o,photo:i},e.$broadcast("userLogin",s)}):e.$broadcast("badAuthorization")}function r(t,e){return'API.audio.search({"q":"'+t+" "+e+'","count": 10})'}var a={},s={};return a.call=function(t,e,n){o(t,e,n)},a.getUserInfo=function(){},a.init=function(){VK.init({apiId:n})},a.authorize=function(){VK.Auth.login(function(){VK.Auth.getLoginStatus(i)},VK.access.AUDIO+262144)},a.intro=function(){VK.Auth.getLoginStatus(function(t){i(t)})},a.get=function(t){t=$.extend({count:10},t),VK.Api.call("audio.get",{count:50,offset:that.offset,v:5},function(t){if(t.response){var e=t.response;e.items.length>0&&console.log(e.items)}})},a.findTrackArray=function(t,e,n){function o(){for(var s="",d=l*i,c=d;d+i>c;c++){var p=t[c];if(!p)break;""!=s&&(s+=","),s+=r(p.artist,p.title)}s="return ["+s+"];",a.call("execute",{code:s},function(t){l++,e(t,d),console.log(t),u>l?setTimeout(o,1e3):n()})}var i=5,s=t.length,u=Math.ceil(s/i),l=0;o()},a.search=function(t,e){t=$.extend({auto_complete:1,lyrics:0,performer_only:0,sort:2,search_own:1,offset:0,count:50,v:5.23},t),VK.Api.call("audio.search",t,function(t){t.response&&"function"==typeof e&&e(t)})},a}]),angular.module("App").controller("C_discover",["$stateParams","PS_echonest","PS_self",function(t,e,n){var o={};return o.searchMode=t.q?!0:!1,o.query=t.q,n.getHotArtists().then(function(t){o.artists=t.data.artists}),o}]),angular.module("App").controller("C_artists",["PS_echonest","PS_self",function(t,e){var n={};return e.getHotArtists().then(function(t){n.artists=t.data.artists}),n}]),angular.module("App").controller("C_artists.page",["$q","$stateParams","PS_lastfm","PS_self",function(t,e,n){var o={},i=e.artist;return t.all({info:n.artist.getInfo(i),albums:n.artist.getTopAlbums({artist:i}),tags:n.artist.getTopTags(i)}).then(function(t){console.log(t);var e=t.info.data.artist;o.artistInfo={name:e.name,image:e.image[e.image.length-1]["#text"],tags:t.tags.data.toptags.tag.splice(0,7)},o.albums=t.albums}),o}]),angular.module("App").controller("C_flow",["$stateParams","$scope","PS_echonest","PS_vk","PS_lastfm","S_utils","S_processing","S_reduce",function(t,e,n,o,i,r,a,s){function u(t){console.log(t);var n=l(t);o.findTrackArray(n,function(t,o){console.log("part!");var i=[];$.each(t.response,function(t,e){var r=e.items[0];if(!r){var a=n[o+t];r={error:!0,artist:a.artist,title:a.title,duration:a.duration}}i.push(r)}),i=r.filterAudios(i,!0),e.$apply(function(){d.songs=d.songs.concat(i)})},function(){a.ready()})}function l(t){for(var e=[],n=0,o=t.length;o>n;n++){var i=t[n];e.push({artist:i.artist_name||i.artist,title:i.title})}return e}var d={};if(console.log(t),d.type=t.tag?"тегу":"исполнителю",d.query=t.tag?t.tag:t.artist,d.songs=[],t.artist&&!t.tag){var c=t.artist;n.getStaticPlaylist({artist:c,results:25}).then(function(t){u(t.data.response.songs)})}if(t.tag&&!t.artist){var p=t.tag;n.getStaticPlaylist({results:12,type:"genre-radio",genre:p}).then(function(t){u(t.data.response.songs)},function(){i.tag.getTopTracks(p).then(function(t){u(s.normalizeTopTracks(t.data.toptracks.track))})})}return d}]),angular.module("App").controller("C_playlists",["$stateParams","$scope","PS_echonest","S_utils",function(t,e,n,o){var i={};return n.getGenresList({results:1e3}).then(function(t){i.genreList=o.shuffleArray(t.data.response.genres)}),i}]),angular.module("App").controller("C_share",["$stateParams","$scope","PS_echonest","S_utils",function(t){var e={};return console.log(t),e}]);